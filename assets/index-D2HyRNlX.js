(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function nx(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _p={exports:{}},Ql={},yp={exports:{}},_e={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fs=Symbol.for("react.element"),rx=Symbol.for("react.portal"),ix=Symbol.for("react.fragment"),ox=Symbol.for("react.strict_mode"),sx=Symbol.for("react.profiler"),lx=Symbol.for("react.provider"),ax=Symbol.for("react.context"),ux=Symbol.for("react.forward_ref"),fx=Symbol.for("react.suspense"),cx=Symbol.for("react.memo"),dx=Symbol.for("react.lazy"),Qc=Symbol.iterator;function hx(e){return e===null||typeof e!="object"?null:(e=Qc&&e[Qc]||e["@@iterator"],typeof e=="function"?e:null)}var Tp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ep=Object.assign,Sp={};function Xi(e,t,n){this.props=e,this.context=t,this.refs=Sp,this.updater=n||Tp}Xi.prototype.isReactComponent={};Xi.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Xi.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function wp(){}wp.prototype=Xi.prototype;function xf(e,t,n){this.props=e,this.context=t,this.refs=Sp,this.updater=n||Tp}var _f=xf.prototype=new wp;_f.constructor=xf;Ep(_f,Xi.prototype);_f.isPureReactComponent=!0;var Zc=Array.isArray,Cp=Object.prototype.hasOwnProperty,yf={current:null},Ap={key:!0,ref:!0,__self:!0,__source:!0};function Ip(e,t,n){var r,i={},o=null,s=null;if(t!=null)for(r in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(o=""+t.key),t)Cp.call(t,r)&&!Ap.hasOwnProperty(r)&&(i[r]=t[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var u=Array(l),f=0;f<l;f++)u[f]=arguments[f+2];i.children=u}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:fs,type:e,key:o,ref:s,props:i,_owner:yf.current}}function px(e,t){return{$$typeof:fs,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Tf(e){return typeof e=="object"&&e!==null&&e.$$typeof===fs}function mx(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var jc=/\/+/g;function Pa(e,t){return typeof e=="object"&&e!==null&&e.key!=null?mx(""+e.key):t.toString(36)}function Ks(e,t,n,r,i){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case fs:case rx:s=!0}}if(s)return s=e,i=i(s),e=r===""?"."+Pa(s,0):r,Zc(i)?(n="",e!=null&&(n=e.replace(jc,"$&/")+"/"),Ks(i,t,n,"",function(f){return f})):i!=null&&(Tf(i)&&(i=px(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(jc,"$&/")+"/")+e)),t.push(i)),1;if(s=0,r=r===""?".":r+":",Zc(e))for(var l=0;l<e.length;l++){o=e[l];var u=r+Pa(o,l);s+=Ks(o,t,n,u,i)}else if(u=hx(e),typeof u=="function")for(e=u.call(e),l=0;!(o=e.next()).done;)o=o.value,u=r+Pa(o,l++),s+=Ks(o,t,n,u,i);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function Ss(e,t,n){if(e==null)return e;var r=[],i=0;return Ks(e,r,"","",function(o){return t.call(n,o,i++)}),r}function gx(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ut={current:null},Xs={transition:null},vx={ReactCurrentDispatcher:Ut,ReactCurrentBatchConfig:Xs,ReactCurrentOwner:yf};function Rp(){throw Error("act(...) is not supported in production builds of React.")}_e.Children={map:Ss,forEach:function(e,t,n){Ss(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Ss(e,function(){t++}),t},toArray:function(e){return Ss(e,function(t){return t})||[]},only:function(e){if(!Tf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};_e.Component=Xi;_e.Fragment=ix;_e.Profiler=sx;_e.PureComponent=xf;_e.StrictMode=ox;_e.Suspense=fx;_e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vx;_e.act=Rp;_e.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Ep({},e.props),i=e.key,o=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,s=yf.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)Cp.call(t,u)&&!Ap.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&l!==void 0?l[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var f=0;f<u;f++)l[f]=arguments[f+2];r.children=l}return{$$typeof:fs,type:e.type,key:i,ref:o,props:r,_owner:s}};_e.createContext=function(e){return e={$$typeof:ax,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:lx,_context:e},e.Consumer=e};_e.createElement=Ip;_e.createFactory=function(e){var t=Ip.bind(null,e);return t.type=e,t};_e.createRef=function(){return{current:null}};_e.forwardRef=function(e){return{$$typeof:ux,render:e}};_e.isValidElement=Tf;_e.lazy=function(e){return{$$typeof:dx,_payload:{_status:-1,_result:e},_init:gx}};_e.memo=function(e,t){return{$$typeof:cx,type:e,compare:t===void 0?null:t}};_e.startTransition=function(e){var t=Xs.transition;Xs.transition={};try{e()}finally{Xs.transition=t}};_e.unstable_act=Rp;_e.useCallback=function(e,t){return Ut.current.useCallback(e,t)};_e.useContext=function(e){return Ut.current.useContext(e)};_e.useDebugValue=function(){};_e.useDeferredValue=function(e){return Ut.current.useDeferredValue(e)};_e.useEffect=function(e,t){return Ut.current.useEffect(e,t)};_e.useId=function(){return Ut.current.useId()};_e.useImperativeHandle=function(e,t,n){return Ut.current.useImperativeHandle(e,t,n)};_e.useInsertionEffect=function(e,t){return Ut.current.useInsertionEffect(e,t)};_e.useLayoutEffect=function(e,t){return Ut.current.useLayoutEffect(e,t)};_e.useMemo=function(e,t){return Ut.current.useMemo(e,t)};_e.useReducer=function(e,t,n){return Ut.current.useReducer(e,t,n)};_e.useRef=function(e){return Ut.current.useRef(e)};_e.useState=function(e){return Ut.current.useState(e)};_e.useSyncExternalStore=function(e,t,n){return Ut.current.useSyncExternalStore(e,t,n)};_e.useTransition=function(){return Ut.current.useTransition()};_e.version="18.3.1";yp.exports=_e;var mt=yp.exports;const xx=nx(mt);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _x=mt,yx=Symbol.for("react.element"),Tx=Symbol.for("react.fragment"),Ex=Object.prototype.hasOwnProperty,Sx=_x.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,wx={key:!0,ref:!0,__self:!0,__source:!0};function Np(e,t,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(s=t.ref);for(r in t)Ex.call(t,r)&&!wx.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:yx,type:e,key:o,ref:s,props:i,_owner:Sx.current}}Ql.Fragment=Tx;Ql.jsx=Np;Ql.jsxs=Np;_p.exports=Ql;var B=_p.exports,cu={},Pp={exports:{}},nn={},Fp={exports:{}},kp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ie,he){var me=ie.length;ie.push(he);e:for(;0<me;){var ye=me-1>>>1,P=ie[ye];if(0<i(P,he))ie[ye]=he,ie[me]=P,me=ye;else break e}}function n(ie){return ie.length===0?null:ie[0]}function r(ie){if(ie.length===0)return null;var he=ie[0],me=ie.pop();if(me!==he){ie[0]=me;e:for(var ye=0,P=ie.length,W=P>>>1;ye<W;){var O=2*(ye+1)-1,L=ie[O],X=O+1,fe=ie[X];if(0>i(L,me))X<P&&0>i(fe,L)?(ie[ye]=fe,ie[X]=me,ye=X):(ie[ye]=L,ie[O]=me,ye=O);else if(X<P&&0>i(fe,me))ie[ye]=fe,ie[X]=me,ye=X;else break e}}return he}function i(ie,he){var me=ie.sortIndex-he.sortIndex;return me!==0?me:ie.id-he.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();e.unstable_now=function(){return s.now()-l}}var u=[],f=[],d=1,h=null,p=3,m=!1,v=!1,g=!1,T=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(ie){for(var he=n(f);he!==null;){if(he.callback===null)r(f);else if(he.startTime<=ie)r(f),he.sortIndex=he.expirationTime,t(u,he);else break;he=n(f)}}function C(ie){if(g=!1,y(ie),!v)if(n(u)!==null)v=!0,Ae(k);else{var he=n(f);he!==null&&Ne(C,he.startTime-ie)}}function k(ie,he){v=!1,g&&(g=!1,_(D),D=-1),m=!0;var me=p;try{for(y(he),h=n(u);h!==null&&(!(h.expirationTime>he)||ie&&!q());){var ye=h.callback;if(typeof ye=="function"){h.callback=null,p=h.priorityLevel;var P=ye(h.expirationTime<=he);he=e.unstable_now(),typeof P=="function"?h.callback=P:h===n(u)&&r(u),y(he)}else r(u);h=n(u)}if(h!==null)var W=!0;else{var O=n(f);O!==null&&Ne(C,O.startTime-he),W=!1}return W}finally{h=null,p=me,m=!1}}var M=!1,R=null,D=-1,F=5,U=-1;function q(){return!(e.unstable_now()-U<F)}function K(){if(R!==null){var ie=e.unstable_now();U=ie;var he=!0;try{he=R(!0,ie)}finally{he?ee():(M=!1,R=null)}}else M=!1}var ee;if(typeof x=="function")ee=function(){x(K)};else if(typeof MessageChannel<"u"){var Te=new MessageChannel,ge=Te.port2;Te.port1.onmessage=K,ee=function(){ge.postMessage(null)}}else ee=function(){T(K,0)};function Ae(ie){R=ie,M||(M=!0,ee())}function Ne(ie,he){D=T(function(){ie(e.unstable_now())},he)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ie){ie.callback=null},e.unstable_continueExecution=function(){v||m||(v=!0,Ae(k))},e.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<ie?Math.floor(1e3/ie):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(ie){switch(p){case 1:case 2:case 3:var he=3;break;default:he=p}var me=p;p=he;try{return ie()}finally{p=me}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ie,he){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var me=p;p=ie;try{return he()}finally{p=me}},e.unstable_scheduleCallback=function(ie,he,me){var ye=e.unstable_now();switch(typeof me=="object"&&me!==null?(me=me.delay,me=typeof me=="number"&&0<me?ye+me:ye):me=ye,ie){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=me+P,ie={id:d++,callback:he,priorityLevel:ie,startTime:me,expirationTime:P,sortIndex:-1},me>ye?(ie.sortIndex=me,t(f,ie),n(u)===null&&ie===n(f)&&(g?(_(D),D=-1):g=!0,Ne(C,me-ye))):(ie.sortIndex=P,t(u,ie),v||m||(v=!0,Ae(k))),ie},e.unstable_shouldYield=q,e.unstable_wrapCallback=function(ie){var he=p;return function(){var me=p;p=he;try{return ie.apply(this,arguments)}finally{p=me}}}})(kp);Fp.exports=kp;var Cx=Fp.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ax=mt,en=Cx;function Z(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Mp=new Set,Go={};function ei(e,t){Hi(e,t),Hi(e+"Capture",t)}function Hi(e,t){for(Go[e]=t,e=0;e<t.length;e++)Mp.add(t[e])}var Xn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),du=Object.prototype.hasOwnProperty,Ix=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,e0={},t0={};function Rx(e){return du.call(t0,e)?!0:du.call(e0,e)?!1:Ix.test(e)?t0[e]=!0:(e0[e]=!0,!1)}function Nx(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Px(e,t,n,r){if(t===null||typeof t>"u"||Nx(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Bt(e,t,n,r,i,o,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var yt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){yt[e]=new Bt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];yt[t]=new Bt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){yt[e]=new Bt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){yt[e]=new Bt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){yt[e]=new Bt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){yt[e]=new Bt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){yt[e]=new Bt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){yt[e]=new Bt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){yt[e]=new Bt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Ef=/[\-:]([a-z])/g;function Sf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Ef,Sf);yt[t]=new Bt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Ef,Sf);yt[t]=new Bt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Ef,Sf);yt[t]=new Bt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){yt[e]=new Bt(e,1,!1,e.toLowerCase(),null,!1,!1)});yt.xlinkHref=new Bt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){yt[e]=new Bt(e,1,!1,e.toLowerCase(),null,!0,!0)});function wf(e,t,n,r){var i=yt.hasOwnProperty(t)?yt[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Px(t,n,i,r)&&(n=null),r||i===null?Rx(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var nr=Ax.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ws=Symbol.for("react.element"),pi=Symbol.for("react.portal"),mi=Symbol.for("react.fragment"),Cf=Symbol.for("react.strict_mode"),hu=Symbol.for("react.profiler"),Dp=Symbol.for("react.provider"),Lp=Symbol.for("react.context"),Af=Symbol.for("react.forward_ref"),pu=Symbol.for("react.suspense"),mu=Symbol.for("react.suspense_list"),If=Symbol.for("react.memo"),ar=Symbol.for("react.lazy"),Op=Symbol.for("react.offscreen"),n0=Symbol.iterator;function ao(e){return e===null||typeof e!="object"?null:(e=n0&&e[n0]||e["@@iterator"],typeof e=="function"?e:null)}var Ye=Object.assign,Fa;function _o(e){if(Fa===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Fa=t&&t[1]||""}return`
`+Fa+e}var ka=!1;function Ma(e,t){if(!e||ka)return"";ka=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(f){var r=f}Reflect.construct(e,[],t)}else{try{t.call()}catch(f){r=f}e.call(t.prototype)}else{try{throw Error()}catch(f){r=f}e()}}catch(f){if(f&&r&&typeof f.stack=="string"){for(var i=f.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,l=o.length-1;1<=s&&0<=l&&i[s]!==o[l];)l--;for(;1<=s&&0<=l;s--,l--)if(i[s]!==o[l]){if(s!==1||l!==1)do if(s--,l--,0>l||i[s]!==o[l]){var u=`
`+i[s].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=s&&0<=l);break}}}finally{ka=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?_o(e):""}function Fx(e){switch(e.tag){case 5:return _o(e.type);case 16:return _o("Lazy");case 13:return _o("Suspense");case 19:return _o("SuspenseList");case 0:case 2:case 15:return e=Ma(e.type,!1),e;case 11:return e=Ma(e.type.render,!1),e;case 1:return e=Ma(e.type,!0),e;default:return""}}function gu(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case mi:return"Fragment";case pi:return"Portal";case hu:return"Profiler";case Cf:return"StrictMode";case pu:return"Suspense";case mu:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Lp:return(e.displayName||"Context")+".Consumer";case Dp:return(e._context.displayName||"Context")+".Provider";case Af:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case If:return t=e.displayName||null,t!==null?t:gu(e.type)||"Memo";case ar:t=e._payload,e=e._init;try{return gu(e(t))}catch{}}return null}function kx(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return gu(t);case 8:return t===Cf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function wr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Up(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Mx(e){var t=Up(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Cs(e){e._valueTracker||(e._valueTracker=Mx(e))}function Bp(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Up(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function al(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function vu(e,t){var n=t.checked;return Ye({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function r0(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=wr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Vp(e,t){t=t.checked,t!=null&&wf(e,"checked",t,!1)}function xu(e,t){Vp(e,t);var n=wr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?_u(e,t.type,n):t.hasOwnProperty("defaultValue")&&_u(e,t.type,wr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function i0(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function _u(e,t,n){(t!=="number"||al(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var yo=Array.isArray;function Ri(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+wr(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function yu(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Z(91));return Ye({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function o0(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Z(92));if(yo(n)){if(1<n.length)throw Error(Z(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:wr(n)}}function Gp(e,t){var n=wr(t.value),r=wr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function s0(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Hp(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Tu(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Hp(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var As,Wp=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(As=As||document.createElement("div"),As.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=As.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ho(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var wo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Dx=["Webkit","ms","Moz","O"];Object.keys(wo).forEach(function(e){Dx.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),wo[t]=wo[e]})});function zp(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||wo.hasOwnProperty(e)&&wo[e]?(""+t).trim():t+"px"}function qp(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=zp(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var Lx=Ye({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Eu(e,t){if(t){if(Lx[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Z(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Z(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Z(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Z(62))}}function Su(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wu=null;function Rf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Cu=null,Ni=null,Pi=null;function l0(e){if(e=hs(e)){if(typeof Cu!="function")throw Error(Z(280));var t=e.stateNode;t&&(t=na(t),Cu(e.stateNode,e.type,t))}}function $p(e){Ni?Pi?Pi.push(e):Pi=[e]:Ni=e}function Jp(){if(Ni){var e=Ni,t=Pi;if(Pi=Ni=null,l0(e),t)for(e=0;e<t.length;e++)l0(t[e])}}function Yp(e,t){return e(t)}function Kp(){}var Da=!1;function Xp(e,t,n){if(Da)return e(t,n);Da=!0;try{return Yp(e,t,n)}finally{Da=!1,(Ni!==null||Pi!==null)&&(Kp(),Jp())}}function Wo(e,t){var n=e.stateNode;if(n===null)return null;var r=na(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Z(231,t,typeof n));return n}var Au=!1;if(Xn)try{var uo={};Object.defineProperty(uo,"passive",{get:function(){Au=!0}}),window.addEventListener("test",uo,uo),window.removeEventListener("test",uo,uo)}catch{Au=!1}function Ox(e,t,n,r,i,o,s,l,u){var f=Array.prototype.slice.call(arguments,3);try{t.apply(n,f)}catch(d){this.onError(d)}}var Co=!1,ul=null,fl=!1,Iu=null,Ux={onError:function(e){Co=!0,ul=e}};function Bx(e,t,n,r,i,o,s,l,u){Co=!1,ul=null,Ox.apply(Ux,arguments)}function Vx(e,t,n,r,i,o,s,l,u){if(Bx.apply(this,arguments),Co){if(Co){var f=ul;Co=!1,ul=null}else throw Error(Z(198));fl||(fl=!0,Iu=f)}}function ti(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function bp(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function a0(e){if(ti(e)!==e)throw Error(Z(188))}function Gx(e){var t=e.alternate;if(!t){if(t=ti(e),t===null)throw Error(Z(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return a0(i),e;if(o===r)return a0(i),t;o=o.sibling}throw Error(Z(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,l=i.child;l;){if(l===n){s=!0,n=i,r=o;break}if(l===r){s=!0,r=i,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,r=i;break}if(l===r){s=!0,r=o,n=i;break}l=l.sibling}if(!s)throw Error(Z(189))}}if(n.alternate!==r)throw Error(Z(190))}if(n.tag!==3)throw Error(Z(188));return n.stateNode.current===n?e:t}function Qp(e){return e=Gx(e),e!==null?Zp(e):null}function Zp(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Zp(e);if(t!==null)return t;e=e.sibling}return null}var jp=en.unstable_scheduleCallback,u0=en.unstable_cancelCallback,Hx=en.unstable_shouldYield,Wx=en.unstable_requestPaint,Ze=en.unstable_now,zx=en.unstable_getCurrentPriorityLevel,Nf=en.unstable_ImmediatePriority,em=en.unstable_UserBlockingPriority,cl=en.unstable_NormalPriority,qx=en.unstable_LowPriority,tm=en.unstable_IdlePriority,Zl=null,Ln=null;function $x(e){if(Ln&&typeof Ln.onCommitFiberRoot=="function")try{Ln.onCommitFiberRoot(Zl,e,void 0,(e.current.flags&128)===128)}catch{}}var wn=Math.clz32?Math.clz32:Kx,Jx=Math.log,Yx=Math.LN2;function Kx(e){return e>>>=0,e===0?32:31-(Jx(e)/Yx|0)|0}var Is=64,Rs=4194304;function To(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dl(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,o=e.pingedLanes,s=n&268435455;if(s!==0){var l=s&~i;l!==0?r=To(l):(o&=s,o!==0&&(r=To(o)))}else s=n&~i,s!==0?r=To(s):o!==0&&(r=To(o));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,o=t&-t,i>=o||i===16&&(o&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-wn(t),i=1<<n,r|=e[n],t&=~i;return r}function Xx(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bx(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var s=31-wn(o),l=1<<s,u=i[s];u===-1?(!(l&n)||l&r)&&(i[s]=Xx(l,t)):u<=t&&(e.expiredLanes|=l),o&=~l}}function Ru(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function nm(){var e=Is;return Is<<=1,!(Is&4194240)&&(Is=64),e}function La(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function cs(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-wn(t),e[t]=n}function Qx(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-wn(n),o=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~o}}function Pf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-wn(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var Me=0;function rm(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var im,Ff,om,sm,lm,Nu=!1,Ns=[],gr=null,vr=null,xr=null,zo=new Map,qo=new Map,fr=[],Zx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function f0(e,t){switch(e){case"focusin":case"focusout":gr=null;break;case"dragenter":case"dragleave":vr=null;break;case"mouseover":case"mouseout":xr=null;break;case"pointerover":case"pointerout":zo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":qo.delete(t.pointerId)}}function fo(e,t,n,r,i,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},t!==null&&(t=hs(t),t!==null&&Ff(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function jx(e,t,n,r,i){switch(t){case"focusin":return gr=fo(gr,e,t,n,r,i),!0;case"dragenter":return vr=fo(vr,e,t,n,r,i),!0;case"mouseover":return xr=fo(xr,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return zo.set(o,fo(zo.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,qo.set(o,fo(qo.get(o)||null,e,t,n,r,i)),!0}return!1}function am(e){var t=Gr(e.target);if(t!==null){var n=ti(t);if(n!==null){if(t=n.tag,t===13){if(t=bp(n),t!==null){e.blockedOn=t,lm(e.priority,function(){om(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function bs(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Pu(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);wu=r,n.target.dispatchEvent(r),wu=null}else return t=hs(n),t!==null&&Ff(t),e.blockedOn=n,!1;t.shift()}return!0}function c0(e,t,n){bs(e)&&n.delete(t)}function e_(){Nu=!1,gr!==null&&bs(gr)&&(gr=null),vr!==null&&bs(vr)&&(vr=null),xr!==null&&bs(xr)&&(xr=null),zo.forEach(c0),qo.forEach(c0)}function co(e,t){e.blockedOn===t&&(e.blockedOn=null,Nu||(Nu=!0,en.unstable_scheduleCallback(en.unstable_NormalPriority,e_)))}function $o(e){function t(i){return co(i,e)}if(0<Ns.length){co(Ns[0],e);for(var n=1;n<Ns.length;n++){var r=Ns[n];r.blockedOn===e&&(r.blockedOn=null)}}for(gr!==null&&co(gr,e),vr!==null&&co(vr,e),xr!==null&&co(xr,e),zo.forEach(t),qo.forEach(t),n=0;n<fr.length;n++)r=fr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<fr.length&&(n=fr[0],n.blockedOn===null);)am(n),n.blockedOn===null&&fr.shift()}var Fi=nr.ReactCurrentBatchConfig,hl=!0;function t_(e,t,n,r){var i=Me,o=Fi.transition;Fi.transition=null;try{Me=1,kf(e,t,n,r)}finally{Me=i,Fi.transition=o}}function n_(e,t,n,r){var i=Me,o=Fi.transition;Fi.transition=null;try{Me=4,kf(e,t,n,r)}finally{Me=i,Fi.transition=o}}function kf(e,t,n,r){if(hl){var i=Pu(e,t,n,r);if(i===null)$a(e,t,r,pl,n),f0(e,r);else if(jx(i,e,t,n,r))r.stopPropagation();else if(f0(e,r),t&4&&-1<Zx.indexOf(e)){for(;i!==null;){var o=hs(i);if(o!==null&&im(o),o=Pu(e,t,n,r),o===null&&$a(e,t,r,pl,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else $a(e,t,r,null,n)}}var pl=null;function Pu(e,t,n,r){if(pl=null,e=Rf(r),e=Gr(e),e!==null)if(t=ti(e),t===null)e=null;else if(n=t.tag,n===13){if(e=bp(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return pl=e,null}function um(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zx()){case Nf:return 1;case em:return 4;case cl:case qx:return 16;case tm:return 536870912;default:return 16}default:return 16}}var dr=null,Mf=null,Qs=null;function fm(){if(Qs)return Qs;var e,t=Mf,n=t.length,r,i="value"in dr?dr.value:dr.textContent,o=i.length;for(e=0;e<n&&t[e]===i[e];e++);var s=n-e;for(r=1;r<=s&&t[n-r]===i[o-r];r++);return Qs=i.slice(e,1<r?1-r:void 0)}function Zs(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ps(){return!0}function d0(){return!1}function rn(e){function t(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Ps:d0,this.isPropagationStopped=d0,this}return Ye(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ps)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ps)},persist:function(){},isPersistent:Ps}),t}var bi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Df=rn(bi),ds=Ye({},bi,{view:0,detail:0}),r_=rn(ds),Oa,Ua,ho,jl=Ye({},ds,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Lf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ho&&(ho&&e.type==="mousemove"?(Oa=e.screenX-ho.screenX,Ua=e.screenY-ho.screenY):Ua=Oa=0,ho=e),Oa)},movementY:function(e){return"movementY"in e?e.movementY:Ua}}),h0=rn(jl),i_=Ye({},jl,{dataTransfer:0}),o_=rn(i_),s_=Ye({},ds,{relatedTarget:0}),Ba=rn(s_),l_=Ye({},bi,{animationName:0,elapsedTime:0,pseudoElement:0}),a_=rn(l_),u_=Ye({},bi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),f_=rn(u_),c_=Ye({},bi,{data:0}),p0=rn(c_),d_={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},h_={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},p_={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function m_(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=p_[e])?!!t[e]:!1}function Lf(){return m_}var g_=Ye({},ds,{key:function(e){if(e.key){var t=d_[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Zs(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?h_[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Lf,charCode:function(e){return e.type==="keypress"?Zs(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Zs(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),v_=rn(g_),x_=Ye({},jl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),m0=rn(x_),__=Ye({},ds,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Lf}),y_=rn(__),T_=Ye({},bi,{propertyName:0,elapsedTime:0,pseudoElement:0}),E_=rn(T_),S_=Ye({},jl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),w_=rn(S_),C_=[9,13,27,32],Of=Xn&&"CompositionEvent"in window,Ao=null;Xn&&"documentMode"in document&&(Ao=document.documentMode);var A_=Xn&&"TextEvent"in window&&!Ao,cm=Xn&&(!Of||Ao&&8<Ao&&11>=Ao),g0=" ",v0=!1;function dm(e,t){switch(e){case"keyup":return C_.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hm(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var gi=!1;function I_(e,t){switch(e){case"compositionend":return hm(t);case"keypress":return t.which!==32?null:(v0=!0,g0);case"textInput":return e=t.data,e===g0&&v0?null:e;default:return null}}function R_(e,t){if(gi)return e==="compositionend"||!Of&&dm(e,t)?(e=fm(),Qs=Mf=dr=null,gi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return cm&&t.locale!=="ko"?null:t.data;default:return null}}var N_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function x0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!N_[e.type]:t==="textarea"}function pm(e,t,n,r){$p(r),t=ml(t,"onChange"),0<t.length&&(n=new Df("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Io=null,Jo=null;function P_(e){Cm(e,0)}function ea(e){var t=_i(e);if(Bp(t))return e}function F_(e,t){if(e==="change")return t}var mm=!1;if(Xn){var Va;if(Xn){var Ga="oninput"in document;if(!Ga){var _0=document.createElement("div");_0.setAttribute("oninput","return;"),Ga=typeof _0.oninput=="function"}Va=Ga}else Va=!1;mm=Va&&(!document.documentMode||9<document.documentMode)}function y0(){Io&&(Io.detachEvent("onpropertychange",gm),Jo=Io=null)}function gm(e){if(e.propertyName==="value"&&ea(Jo)){var t=[];pm(t,Jo,e,Rf(e)),Xp(P_,t)}}function k_(e,t,n){e==="focusin"?(y0(),Io=t,Jo=n,Io.attachEvent("onpropertychange",gm)):e==="focusout"&&y0()}function M_(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ea(Jo)}function D_(e,t){if(e==="click")return ea(t)}function L_(e,t){if(e==="input"||e==="change")return ea(t)}function O_(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var In=typeof Object.is=="function"?Object.is:O_;function Yo(e,t){if(In(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!du.call(t,i)||!In(e[i],t[i]))return!1}return!0}function T0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function E0(e,t){var n=T0(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=T0(n)}}function vm(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?vm(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function xm(){for(var e=window,t=al();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=al(e.document)}return t}function Uf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function U_(e){var t=xm(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&vm(n.ownerDocument.documentElement,n)){if(r!==null&&Uf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!e.extend&&o>r&&(i=r,r=o,o=i),i=E0(n,o);var s=E0(n,r);i&&s&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var B_=Xn&&"documentMode"in document&&11>=document.documentMode,vi=null,Fu=null,Ro=null,ku=!1;function S0(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ku||vi==null||vi!==al(r)||(r=vi,"selectionStart"in r&&Uf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ro&&Yo(Ro,r)||(Ro=r,r=ml(Fu,"onSelect"),0<r.length&&(t=new Df("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=vi)))}function Fs(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var xi={animationend:Fs("Animation","AnimationEnd"),animationiteration:Fs("Animation","AnimationIteration"),animationstart:Fs("Animation","AnimationStart"),transitionend:Fs("Transition","TransitionEnd")},Ha={},_m={};Xn&&(_m=document.createElement("div").style,"AnimationEvent"in window||(delete xi.animationend.animation,delete xi.animationiteration.animation,delete xi.animationstart.animation),"TransitionEvent"in window||delete xi.transitionend.transition);function ta(e){if(Ha[e])return Ha[e];if(!xi[e])return e;var t=xi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in _m)return Ha[e]=t[n];return e}var ym=ta("animationend"),Tm=ta("animationiteration"),Em=ta("animationstart"),Sm=ta("transitionend"),wm=new Map,w0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nr(e,t){wm.set(e,t),ei(t,[e])}for(var Wa=0;Wa<w0.length;Wa++){var za=w0[Wa],V_=za.toLowerCase(),G_=za[0].toUpperCase()+za.slice(1);Nr(V_,"on"+G_)}Nr(ym,"onAnimationEnd");Nr(Tm,"onAnimationIteration");Nr(Em,"onAnimationStart");Nr("dblclick","onDoubleClick");Nr("focusin","onFocus");Nr("focusout","onBlur");Nr(Sm,"onTransitionEnd");Hi("onMouseEnter",["mouseout","mouseover"]);Hi("onMouseLeave",["mouseout","mouseover"]);Hi("onPointerEnter",["pointerout","pointerover"]);Hi("onPointerLeave",["pointerout","pointerover"]);ei("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ei("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ei("onBeforeInput",["compositionend","keypress","textInput","paste"]);ei("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ei("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ei("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Eo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),H_=new Set("cancel close invalid load scroll toggle".split(" ").concat(Eo));function C0(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Vx(r,t,void 0,e),e.currentTarget=null}function Cm(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var s=r.length-1;0<=s;s--){var l=r[s],u=l.instance,f=l.currentTarget;if(l=l.listener,u!==o&&i.isPropagationStopped())break e;C0(i,l,f),o=u}else for(s=0;s<r.length;s++){if(l=r[s],u=l.instance,f=l.currentTarget,l=l.listener,u!==o&&i.isPropagationStopped())break e;C0(i,l,f),o=u}}}if(fl)throw e=Iu,fl=!1,Iu=null,e}function Be(e,t){var n=t[Uu];n===void 0&&(n=t[Uu]=new Set);var r=e+"__bubble";n.has(r)||(Am(t,e,2,!1),n.add(r))}function qa(e,t,n){var r=0;t&&(r|=4),Am(n,e,r,t)}var ks="_reactListening"+Math.random().toString(36).slice(2);function Ko(e){if(!e[ks]){e[ks]=!0,Mp.forEach(function(n){n!=="selectionchange"&&(H_.has(n)||qa(n,!1,e),qa(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ks]||(t[ks]=!0,qa("selectionchange",!1,t))}}function Am(e,t,n,r){switch(um(t)){case 1:var i=t_;break;case 4:i=n_;break;default:i=kf}n=i.bind(null,t,n,e),i=void 0,!Au||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function $a(e,t,n,r,i){var o=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var u=s.tag;if((u===3||u===4)&&(u=s.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;s=s.return}for(;l!==null;){if(s=Gr(l),s===null)return;if(u=s.tag,u===5||u===6){r=o=s;continue e}l=l.parentNode}}r=r.return}Xp(function(){var f=o,d=Rf(n),h=[];e:{var p=wm.get(e);if(p!==void 0){var m=Df,v=e;switch(e){case"keypress":if(Zs(n)===0)break e;case"keydown":case"keyup":m=v_;break;case"focusin":v="focus",m=Ba;break;case"focusout":v="blur",m=Ba;break;case"beforeblur":case"afterblur":m=Ba;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=h0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=o_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=y_;break;case ym:case Tm:case Em:m=a_;break;case Sm:m=E_;break;case"scroll":m=r_;break;case"wheel":m=w_;break;case"copy":case"cut":case"paste":m=f_;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=m0}var g=(t&4)!==0,T=!g&&e==="scroll",_=g?p!==null?p+"Capture":null:p;g=[];for(var x=f,y;x!==null;){y=x;var C=y.stateNode;if(y.tag===5&&C!==null&&(y=C,_!==null&&(C=Wo(x,_),C!=null&&g.push(Xo(x,C,y)))),T)break;x=x.return}0<g.length&&(p=new m(p,v,null,n,d),h.push({event:p,listeners:g}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",p&&n!==wu&&(v=n.relatedTarget||n.fromElement)&&(Gr(v)||v[bn]))break e;if((m||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,m?(v=n.relatedTarget||n.toElement,m=f,v=v?Gr(v):null,v!==null&&(T=ti(v),v!==T||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=f),m!==v)){if(g=h0,C="onMouseLeave",_="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(g=m0,C="onPointerLeave",_="onPointerEnter",x="pointer"),T=m==null?p:_i(m),y=v==null?p:_i(v),p=new g(C,x+"leave",m,n,d),p.target=T,p.relatedTarget=y,C=null,Gr(d)===f&&(g=new g(_,x+"enter",v,n,d),g.target=y,g.relatedTarget=T,C=g),T=C,m&&v)t:{for(g=m,_=v,x=0,y=g;y;y=ui(y))x++;for(y=0,C=_;C;C=ui(C))y++;for(;0<x-y;)g=ui(g),x--;for(;0<y-x;)_=ui(_),y--;for(;x--;){if(g===_||_!==null&&g===_.alternate)break t;g=ui(g),_=ui(_)}g=null}else g=null;m!==null&&A0(h,p,m,g,!1),v!==null&&T!==null&&A0(h,T,v,g,!0)}}e:{if(p=f?_i(f):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var k=F_;else if(x0(p))if(mm)k=L_;else{k=M_;var M=k_}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(k=D_);if(k&&(k=k(e,f))){pm(h,k,n,d);break e}M&&M(e,p,f),e==="focusout"&&(M=p._wrapperState)&&M.controlled&&p.type==="number"&&_u(p,"number",p.value)}switch(M=f?_i(f):window,e){case"focusin":(x0(M)||M.contentEditable==="true")&&(vi=M,Fu=f,Ro=null);break;case"focusout":Ro=Fu=vi=null;break;case"mousedown":ku=!0;break;case"contextmenu":case"mouseup":case"dragend":ku=!1,S0(h,n,d);break;case"selectionchange":if(B_)break;case"keydown":case"keyup":S0(h,n,d)}var R;if(Of)e:{switch(e){case"compositionstart":var D="onCompositionStart";break e;case"compositionend":D="onCompositionEnd";break e;case"compositionupdate":D="onCompositionUpdate";break e}D=void 0}else gi?dm(e,n)&&(D="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(D="onCompositionStart");D&&(cm&&n.locale!=="ko"&&(gi||D!=="onCompositionStart"?D==="onCompositionEnd"&&gi&&(R=fm()):(dr=d,Mf="value"in dr?dr.value:dr.textContent,gi=!0)),M=ml(f,D),0<M.length&&(D=new p0(D,e,null,n,d),h.push({event:D,listeners:M}),R?D.data=R:(R=hm(n),R!==null&&(D.data=R)))),(R=A_?I_(e,n):R_(e,n))&&(f=ml(f,"onBeforeInput"),0<f.length&&(d=new p0("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:f}),d.data=R))}Cm(h,t)})}function Xo(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ml(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Wo(e,n),o!=null&&r.unshift(Xo(e,o,i)),o=Wo(e,t),o!=null&&r.push(Xo(e,o,i))),e=e.return}return r}function ui(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function A0(e,t,n,r,i){for(var o=t._reactName,s=[];n!==null&&n!==r;){var l=n,u=l.alternate,f=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&f!==null&&(l=f,i?(u=Wo(n,o),u!=null&&s.unshift(Xo(n,u,l))):i||(u=Wo(n,o),u!=null&&s.push(Xo(n,u,l)))),n=n.return}s.length!==0&&e.push({event:t,listeners:s})}var W_=/\r\n?/g,z_=/\u0000|\uFFFD/g;function I0(e){return(typeof e=="string"?e:""+e).replace(W_,`
`).replace(z_,"")}function Ms(e,t,n){if(t=I0(t),I0(e)!==t&&n)throw Error(Z(425))}function gl(){}var Mu=null,Du=null;function Lu(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ou=typeof setTimeout=="function"?setTimeout:void 0,q_=typeof clearTimeout=="function"?clearTimeout:void 0,R0=typeof Promise=="function"?Promise:void 0,$_=typeof queueMicrotask=="function"?queueMicrotask:typeof R0<"u"?function(e){return R0.resolve(null).then(e).catch(J_)}:Ou;function J_(e){setTimeout(function(){throw e})}function Ja(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),$o(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);$o(t)}function _r(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function N0(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Qi=Math.random().toString(36).slice(2),Dn="__reactFiber$"+Qi,bo="__reactProps$"+Qi,bn="__reactContainer$"+Qi,Uu="__reactEvents$"+Qi,Y_="__reactListeners$"+Qi,K_="__reactHandles$"+Qi;function Gr(e){var t=e[Dn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[bn]||n[Dn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=N0(e);e!==null;){if(n=e[Dn])return n;e=N0(e)}return t}e=n,n=e.parentNode}return null}function hs(e){return e=e[Dn]||e[bn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function _i(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Z(33))}function na(e){return e[bo]||null}var Bu=[],yi=-1;function Pr(e){return{current:e}}function Ge(e){0>yi||(e.current=Bu[yi],Bu[yi]=null,yi--)}function Ue(e,t){yi++,Bu[yi]=e.current,e.current=t}var Cr={},Nt=Pr(Cr),Ht=Pr(!1),Jr=Cr;function Wi(e,t){var n=e.type.contextTypes;if(!n)return Cr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Wt(e){return e=e.childContextTypes,e!=null}function vl(){Ge(Ht),Ge(Nt)}function P0(e,t,n){if(Nt.current!==Cr)throw Error(Z(168));Ue(Nt,t),Ue(Ht,n)}function Im(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(Z(108,kx(e)||"Unknown",i));return Ye({},n,r)}function xl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Cr,Jr=Nt.current,Ue(Nt,e),Ue(Ht,Ht.current),!0}function F0(e,t,n){var r=e.stateNode;if(!r)throw Error(Z(169));n?(e=Im(e,t,Jr),r.__reactInternalMemoizedMergedChildContext=e,Ge(Ht),Ge(Nt),Ue(Nt,e)):Ge(Ht),Ue(Ht,n)}var Wn=null,ra=!1,Ya=!1;function Rm(e){Wn===null?Wn=[e]:Wn.push(e)}function X_(e){ra=!0,Rm(e)}function Fr(){if(!Ya&&Wn!==null){Ya=!0;var e=0,t=Me;try{var n=Wn;for(Me=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Wn=null,ra=!1}catch(i){throw Wn!==null&&(Wn=Wn.slice(e+1)),jp(Nf,Fr),i}finally{Me=t,Ya=!1}}return null}var Ti=[],Ei=0,_l=null,yl=0,an=[],un=0,Yr=null,zn=1,qn="";function Ur(e,t){Ti[Ei++]=yl,Ti[Ei++]=_l,_l=e,yl=t}function Nm(e,t,n){an[un++]=zn,an[un++]=qn,an[un++]=Yr,Yr=e;var r=zn;e=qn;var i=32-wn(r)-1;r&=~(1<<i),n+=1;var o=32-wn(t)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,zn=1<<32-wn(t)+i|n<<i|r,qn=o+e}else zn=1<<o|n<<i|r,qn=e}function Bf(e){e.return!==null&&(Ur(e,1),Nm(e,1,0))}function Vf(e){for(;e===_l;)_l=Ti[--Ei],Ti[Ei]=null,yl=Ti[--Ei],Ti[Ei]=null;for(;e===Yr;)Yr=an[--un],an[un]=null,qn=an[--un],an[un]=null,zn=an[--un],an[un]=null}var jt=null,Zt=null,We=!1,Tn=null;function Pm(e,t){var n=fn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function k0(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,jt=e,Zt=_r(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,jt=e,Zt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Yr!==null?{id:zn,overflow:qn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=fn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,jt=e,Zt=null,!0):!1;default:return!1}}function Vu(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Gu(e){if(We){var t=Zt;if(t){var n=t;if(!k0(e,t)){if(Vu(e))throw Error(Z(418));t=_r(n.nextSibling);var r=jt;t&&k0(e,t)?Pm(r,n):(e.flags=e.flags&-4097|2,We=!1,jt=e)}}else{if(Vu(e))throw Error(Z(418));e.flags=e.flags&-4097|2,We=!1,jt=e}}}function M0(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;jt=e}function Ds(e){if(e!==jt)return!1;if(!We)return M0(e),We=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Lu(e.type,e.memoizedProps)),t&&(t=Zt)){if(Vu(e))throw Fm(),Error(Z(418));for(;t;)Pm(e,t),t=_r(t.nextSibling)}if(M0(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Z(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Zt=_r(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Zt=null}}else Zt=jt?_r(e.stateNode.nextSibling):null;return!0}function Fm(){for(var e=Zt;e;)e=_r(e.nextSibling)}function zi(){Zt=jt=null,We=!1}function Gf(e){Tn===null?Tn=[e]:Tn.push(e)}var b_=nr.ReactCurrentBatchConfig;function po(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Z(309));var r=n.stateNode}if(!r)throw Error(Z(147,e));var i=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(s){var l=i.refs;s===null?delete l[o]:l[o]=s},t._stringRef=o,t)}if(typeof e!="string")throw Error(Z(284));if(!n._owner)throw Error(Z(290,e))}return e}function Ls(e,t){throw e=Object.prototype.toString.call(t),Error(Z(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function D0(e){var t=e._init;return t(e._payload)}function km(e){function t(_,x){if(e){var y=_.deletions;y===null?(_.deletions=[x],_.flags|=16):y.push(x)}}function n(_,x){if(!e)return null;for(;x!==null;)t(_,x),x=x.sibling;return null}function r(_,x){for(_=new Map;x!==null;)x.key!==null?_.set(x.key,x):_.set(x.index,x),x=x.sibling;return _}function i(_,x){return _=Sr(_,x),_.index=0,_.sibling=null,_}function o(_,x,y){return _.index=y,e?(y=_.alternate,y!==null?(y=y.index,y<x?(_.flags|=2,x):y):(_.flags|=2,x)):(_.flags|=1048576,x)}function s(_){return e&&_.alternate===null&&(_.flags|=2),_}function l(_,x,y,C){return x===null||x.tag!==6?(x=eu(y,_.mode,C),x.return=_,x):(x=i(x,y),x.return=_,x)}function u(_,x,y,C){var k=y.type;return k===mi?d(_,x,y.props.children,C,y.key):x!==null&&(x.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===ar&&D0(k)===x.type)?(C=i(x,y.props),C.ref=po(_,x,y),C.return=_,C):(C=ol(y.type,y.key,y.props,null,_.mode,C),C.ref=po(_,x,y),C.return=_,C)}function f(_,x,y,C){return x===null||x.tag!==4||x.stateNode.containerInfo!==y.containerInfo||x.stateNode.implementation!==y.implementation?(x=tu(y,_.mode,C),x.return=_,x):(x=i(x,y.children||[]),x.return=_,x)}function d(_,x,y,C,k){return x===null||x.tag!==7?(x=qr(y,_.mode,C,k),x.return=_,x):(x=i(x,y),x.return=_,x)}function h(_,x,y){if(typeof x=="string"&&x!==""||typeof x=="number")return x=eu(""+x,_.mode,y),x.return=_,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case ws:return y=ol(x.type,x.key,x.props,null,_.mode,y),y.ref=po(_,null,x),y.return=_,y;case pi:return x=tu(x,_.mode,y),x.return=_,x;case ar:var C=x._init;return h(_,C(x._payload),y)}if(yo(x)||ao(x))return x=qr(x,_.mode,y,null),x.return=_,x;Ls(_,x)}return null}function p(_,x,y,C){var k=x!==null?x.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return k!==null?null:l(_,x,""+y,C);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ws:return y.key===k?u(_,x,y,C):null;case pi:return y.key===k?f(_,x,y,C):null;case ar:return k=y._init,p(_,x,k(y._payload),C)}if(yo(y)||ao(y))return k!==null?null:d(_,x,y,C,null);Ls(_,y)}return null}function m(_,x,y,C,k){if(typeof C=="string"&&C!==""||typeof C=="number")return _=_.get(y)||null,l(x,_,""+C,k);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case ws:return _=_.get(C.key===null?y:C.key)||null,u(x,_,C,k);case pi:return _=_.get(C.key===null?y:C.key)||null,f(x,_,C,k);case ar:var M=C._init;return m(_,x,y,M(C._payload),k)}if(yo(C)||ao(C))return _=_.get(y)||null,d(x,_,C,k,null);Ls(x,C)}return null}function v(_,x,y,C){for(var k=null,M=null,R=x,D=x=0,F=null;R!==null&&D<y.length;D++){R.index>D?(F=R,R=null):F=R.sibling;var U=p(_,R,y[D],C);if(U===null){R===null&&(R=F);break}e&&R&&U.alternate===null&&t(_,R),x=o(U,x,D),M===null?k=U:M.sibling=U,M=U,R=F}if(D===y.length)return n(_,R),We&&Ur(_,D),k;if(R===null){for(;D<y.length;D++)R=h(_,y[D],C),R!==null&&(x=o(R,x,D),M===null?k=R:M.sibling=R,M=R);return We&&Ur(_,D),k}for(R=r(_,R);D<y.length;D++)F=m(R,_,D,y[D],C),F!==null&&(e&&F.alternate!==null&&R.delete(F.key===null?D:F.key),x=o(F,x,D),M===null?k=F:M.sibling=F,M=F);return e&&R.forEach(function(q){return t(_,q)}),We&&Ur(_,D),k}function g(_,x,y,C){var k=ao(y);if(typeof k!="function")throw Error(Z(150));if(y=k.call(y),y==null)throw Error(Z(151));for(var M=k=null,R=x,D=x=0,F=null,U=y.next();R!==null&&!U.done;D++,U=y.next()){R.index>D?(F=R,R=null):F=R.sibling;var q=p(_,R,U.value,C);if(q===null){R===null&&(R=F);break}e&&R&&q.alternate===null&&t(_,R),x=o(q,x,D),M===null?k=q:M.sibling=q,M=q,R=F}if(U.done)return n(_,R),We&&Ur(_,D),k;if(R===null){for(;!U.done;D++,U=y.next())U=h(_,U.value,C),U!==null&&(x=o(U,x,D),M===null?k=U:M.sibling=U,M=U);return We&&Ur(_,D),k}for(R=r(_,R);!U.done;D++,U=y.next())U=m(R,_,D,U.value,C),U!==null&&(e&&U.alternate!==null&&R.delete(U.key===null?D:U.key),x=o(U,x,D),M===null?k=U:M.sibling=U,M=U);return e&&R.forEach(function(K){return t(_,K)}),We&&Ur(_,D),k}function T(_,x,y,C){if(typeof y=="object"&&y!==null&&y.type===mi&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case ws:e:{for(var k=y.key,M=x;M!==null;){if(M.key===k){if(k=y.type,k===mi){if(M.tag===7){n(_,M.sibling),x=i(M,y.props.children),x.return=_,_=x;break e}}else if(M.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===ar&&D0(k)===M.type){n(_,M.sibling),x=i(M,y.props),x.ref=po(_,M,y),x.return=_,_=x;break e}n(_,M);break}else t(_,M);M=M.sibling}y.type===mi?(x=qr(y.props.children,_.mode,C,y.key),x.return=_,_=x):(C=ol(y.type,y.key,y.props,null,_.mode,C),C.ref=po(_,x,y),C.return=_,_=C)}return s(_);case pi:e:{for(M=y.key;x!==null;){if(x.key===M)if(x.tag===4&&x.stateNode.containerInfo===y.containerInfo&&x.stateNode.implementation===y.implementation){n(_,x.sibling),x=i(x,y.children||[]),x.return=_,_=x;break e}else{n(_,x);break}else t(_,x);x=x.sibling}x=tu(y,_.mode,C),x.return=_,_=x}return s(_);case ar:return M=y._init,T(_,x,M(y._payload),C)}if(yo(y))return v(_,x,y,C);if(ao(y))return g(_,x,y,C);Ls(_,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,x!==null&&x.tag===6?(n(_,x.sibling),x=i(x,y),x.return=_,_=x):(n(_,x),x=eu(y,_.mode,C),x.return=_,_=x),s(_)):n(_,x)}return T}var qi=km(!0),Mm=km(!1),Tl=Pr(null),El=null,Si=null,Hf=null;function Wf(){Hf=Si=El=null}function zf(e){var t=Tl.current;Ge(Tl),e._currentValue=t}function Hu(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ki(e,t){El=e,Hf=Si=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Gt=!0),e.firstContext=null)}function hn(e){var t=e._currentValue;if(Hf!==e)if(e={context:e,memoizedValue:t,next:null},Si===null){if(El===null)throw Error(Z(308));Si=e,El.dependencies={lanes:0,firstContext:e}}else Si=Si.next=e;return t}var Hr=null;function qf(e){Hr===null?Hr=[e]:Hr.push(e)}function Dm(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,qf(t)):(n.next=i.next,i.next=n),t.interleaved=n,Qn(e,r)}function Qn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var ur=!1;function $f(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Lm(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function $n(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function yr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Se&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Qn(e,n)}return i=r.interleaved,i===null?(t.next=t,qf(r)):(t.next=i.next,i.next=t),r.interleaved=t,Qn(e,n)}function js(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Pf(e,n)}}function L0(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=t:o=o.next=t}else i=o=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Sl(e,t,n,r){var i=e.updateQueue;ur=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var u=l,f=u.next;u.next=null,s===null?o=f:s.next=f,s=u;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==s&&(l===null?d.firstBaseUpdate=f:l.next=f,d.lastBaseUpdate=u))}if(o!==null){var h=i.baseState;s=0,d=f=u=null,l=o;do{var p=l.lane,m=l.eventTime;if((r&p)===p){d!==null&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=e,g=l;switch(p=t,m=n,g.tag){case 1:if(v=g.payload,typeof v=="function"){h=v.call(m,h,p);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=g.payload,p=typeof v=="function"?v.call(m,h,p):v,p==null)break e;h=Ye({},h,p);break e;case 2:ur=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=i.effects,p===null?i.effects=[l]:p.push(l))}else m={eventTime:m,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(f=d=m,u=h):d=d.next=m,s|=p;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;p=l,l=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(d===null&&(u=h),i.baseState=u,i.firstBaseUpdate=f,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do s|=i.lane,i=i.next;while(i!==t)}else o===null&&(i.shared.lanes=0);Xr|=s,e.lanes=s,e.memoizedState=h}}function O0(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Z(191,i));i.call(r)}}}var ps={},On=Pr(ps),Qo=Pr(ps),Zo=Pr(ps);function Wr(e){if(e===ps)throw Error(Z(174));return e}function Jf(e,t){switch(Ue(Zo,t),Ue(Qo,e),Ue(On,ps),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Tu(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Tu(t,e)}Ge(On),Ue(On,t)}function $i(){Ge(On),Ge(Qo),Ge(Zo)}function Om(e){Wr(Zo.current);var t=Wr(On.current),n=Tu(t,e.type);t!==n&&(Ue(Qo,e),Ue(On,n))}function Yf(e){Qo.current===e&&(Ge(On),Ge(Qo))}var $e=Pr(0);function wl(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ka=[];function Kf(){for(var e=0;e<Ka.length;e++)Ka[e]._workInProgressVersionPrimary=null;Ka.length=0}var el=nr.ReactCurrentDispatcher,Xa=nr.ReactCurrentBatchConfig,Kr=0,Je=null,ot=null,lt=null,Cl=!1,No=!1,jo=0,Q_=0;function St(){throw Error(Z(321))}function Xf(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!In(e[n],t[n]))return!1;return!0}function bf(e,t,n,r,i,o){if(Kr=o,Je=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,el.current=e===null||e.memoizedState===null?ty:ny,e=n(r,i),No){o=0;do{if(No=!1,jo=0,25<=o)throw Error(Z(301));o+=1,lt=ot=null,t.updateQueue=null,el.current=ry,e=n(r,i)}while(No)}if(el.current=Al,t=ot!==null&&ot.next!==null,Kr=0,lt=ot=Je=null,Cl=!1,t)throw Error(Z(300));return e}function Qf(){var e=jo!==0;return jo=0,e}function Mn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return lt===null?Je.memoizedState=lt=e:lt=lt.next=e,lt}function pn(){if(ot===null){var e=Je.alternate;e=e!==null?e.memoizedState:null}else e=ot.next;var t=lt===null?Je.memoizedState:lt.next;if(t!==null)lt=t,ot=e;else{if(e===null)throw Error(Z(310));ot=e,e={memoizedState:ot.memoizedState,baseState:ot.baseState,baseQueue:ot.baseQueue,queue:ot.queue,next:null},lt===null?Je.memoizedState=lt=e:lt=lt.next=e}return lt}function es(e,t){return typeof t=="function"?t(e):t}function ba(e){var t=pn(),n=t.queue;if(n===null)throw Error(Z(311));n.lastRenderedReducer=e;var r=ot,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var l=s=null,u=null,f=o;do{var d=f.lane;if((Kr&d)===d)u!==null&&(u=u.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),r=f.hasEagerState?f.eagerState:e(r,f.action);else{var h={lane:d,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};u===null?(l=u=h,s=r):u=u.next=h,Je.lanes|=d,Xr|=d}f=f.next}while(f!==null&&f!==o);u===null?s=r:u.next=l,In(r,t.memoizedState)||(Gt=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do o=i.lane,Je.lanes|=o,Xr|=o,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Qa(e){var t=pn(),n=t.queue;if(n===null)throw Error(Z(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=e(o,s.action),s=s.next;while(s!==i);In(o,t.memoizedState)||(Gt=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Um(){}function Bm(e,t){var n=Je,r=pn(),i=t(),o=!In(r.memoizedState,i);if(o&&(r.memoizedState=i,Gt=!0),r=r.queue,Zf(Hm.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||lt!==null&&lt.memoizedState.tag&1){if(n.flags|=2048,ts(9,Gm.bind(null,n,r,i,t),void 0,null),ct===null)throw Error(Z(349));Kr&30||Vm(n,t,i)}return i}function Vm(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Je.updateQueue,t===null?(t={lastEffect:null,stores:null},Je.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Gm(e,t,n,r){t.value=n,t.getSnapshot=r,Wm(t)&&zm(e)}function Hm(e,t,n){return n(function(){Wm(t)&&zm(e)})}function Wm(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!In(e,n)}catch{return!0}}function zm(e){var t=Qn(e,1);t!==null&&Cn(t,e,1,-1)}function U0(e){var t=Mn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:es,lastRenderedState:e},t.queue=e,e=e.dispatch=ey.bind(null,Je,e),[t.memoizedState,e]}function ts(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Je.updateQueue,t===null?(t={lastEffect:null,stores:null},Je.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function qm(){return pn().memoizedState}function tl(e,t,n,r){var i=Mn();Je.flags|=e,i.memoizedState=ts(1|t,n,void 0,r===void 0?null:r)}function ia(e,t,n,r){var i=pn();r=r===void 0?null:r;var o=void 0;if(ot!==null){var s=ot.memoizedState;if(o=s.destroy,r!==null&&Xf(r,s.deps)){i.memoizedState=ts(t,n,o,r);return}}Je.flags|=e,i.memoizedState=ts(1|t,n,o,r)}function B0(e,t){return tl(8390656,8,e,t)}function Zf(e,t){return ia(2048,8,e,t)}function $m(e,t){return ia(4,2,e,t)}function Jm(e,t){return ia(4,4,e,t)}function Ym(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Km(e,t,n){return n=n!=null?n.concat([e]):null,ia(4,4,Ym.bind(null,t,e),n)}function jf(){}function Xm(e,t){var n=pn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Xf(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function bm(e,t){var n=pn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Xf(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Qm(e,t,n){return Kr&21?(In(n,t)||(n=nm(),Je.lanes|=n,Xr|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Gt=!0),e.memoizedState=n)}function Z_(e,t){var n=Me;Me=n!==0&&4>n?n:4,e(!0);var r=Xa.transition;Xa.transition={};try{e(!1),t()}finally{Me=n,Xa.transition=r}}function Zm(){return pn().memoizedState}function j_(e,t,n){var r=Er(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},jm(e))eg(t,n);else if(n=Dm(e,t,n,r),n!==null){var i=Lt();Cn(n,e,r,i),tg(n,t,r)}}function ey(e,t,n){var r=Er(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(jm(e))eg(t,i);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var s=t.lastRenderedState,l=o(s,n);if(i.hasEagerState=!0,i.eagerState=l,In(l,s)){var u=t.interleaved;u===null?(i.next=i,qf(t)):(i.next=u.next,u.next=i),t.interleaved=i;return}}catch{}finally{}n=Dm(e,t,i,r),n!==null&&(i=Lt(),Cn(n,e,r,i),tg(n,t,r))}}function jm(e){var t=e.alternate;return e===Je||t!==null&&t===Je}function eg(e,t){No=Cl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function tg(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Pf(e,n)}}var Al={readContext:hn,useCallback:St,useContext:St,useEffect:St,useImperativeHandle:St,useInsertionEffect:St,useLayoutEffect:St,useMemo:St,useReducer:St,useRef:St,useState:St,useDebugValue:St,useDeferredValue:St,useTransition:St,useMutableSource:St,useSyncExternalStore:St,useId:St,unstable_isNewReconciler:!1},ty={readContext:hn,useCallback:function(e,t){return Mn().memoizedState=[e,t===void 0?null:t],e},useContext:hn,useEffect:B0,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,tl(4194308,4,Ym.bind(null,t,e),n)},useLayoutEffect:function(e,t){return tl(4194308,4,e,t)},useInsertionEffect:function(e,t){return tl(4,2,e,t)},useMemo:function(e,t){var n=Mn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Mn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=j_.bind(null,Je,e),[r.memoizedState,e]},useRef:function(e){var t=Mn();return e={current:e},t.memoizedState=e},useState:U0,useDebugValue:jf,useDeferredValue:function(e){return Mn().memoizedState=e},useTransition:function(){var e=U0(!1),t=e[0];return e=Z_.bind(null,e[1]),Mn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Je,i=Mn();if(We){if(n===void 0)throw Error(Z(407));n=n()}else{if(n=t(),ct===null)throw Error(Z(349));Kr&30||Vm(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,B0(Hm.bind(null,r,o,e),[e]),r.flags|=2048,ts(9,Gm.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=Mn(),t=ct.identifierPrefix;if(We){var n=qn,r=zn;n=(r&~(1<<32-wn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=jo++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Q_++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ny={readContext:hn,useCallback:Xm,useContext:hn,useEffect:Zf,useImperativeHandle:Km,useInsertionEffect:$m,useLayoutEffect:Jm,useMemo:bm,useReducer:ba,useRef:qm,useState:function(){return ba(es)},useDebugValue:jf,useDeferredValue:function(e){var t=pn();return Qm(t,ot.memoizedState,e)},useTransition:function(){var e=ba(es)[0],t=pn().memoizedState;return[e,t]},useMutableSource:Um,useSyncExternalStore:Bm,useId:Zm,unstable_isNewReconciler:!1},ry={readContext:hn,useCallback:Xm,useContext:hn,useEffect:Zf,useImperativeHandle:Km,useInsertionEffect:$m,useLayoutEffect:Jm,useMemo:bm,useReducer:Qa,useRef:qm,useState:function(){return Qa(es)},useDebugValue:jf,useDeferredValue:function(e){var t=pn();return ot===null?t.memoizedState=e:Qm(t,ot.memoizedState,e)},useTransition:function(){var e=Qa(es)[0],t=pn().memoizedState;return[e,t]},useMutableSource:Um,useSyncExternalStore:Bm,useId:Zm,unstable_isNewReconciler:!1};function _n(e,t){if(e&&e.defaultProps){t=Ye({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Wu(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Ye({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var oa={isMounted:function(e){return(e=e._reactInternals)?ti(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Lt(),i=Er(e),o=$n(r,i);o.payload=t,n!=null&&(o.callback=n),t=yr(e,o,i),t!==null&&(Cn(t,e,i,r),js(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Lt(),i=Er(e),o=$n(r,i);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=yr(e,o,i),t!==null&&(Cn(t,e,i,r),js(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Lt(),r=Er(e),i=$n(n,r);i.tag=2,t!=null&&(i.callback=t),t=yr(e,i,r),t!==null&&(Cn(t,e,r,n),js(t,e,r))}};function V0(e,t,n,r,i,o,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,s):t.prototype&&t.prototype.isPureReactComponent?!Yo(n,r)||!Yo(i,o):!0}function ng(e,t,n){var r=!1,i=Cr,o=t.contextType;return typeof o=="object"&&o!==null?o=hn(o):(i=Wt(t)?Jr:Nt.current,r=t.contextTypes,o=(r=r!=null)?Wi(e,i):Cr),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=oa,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function G0(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&oa.enqueueReplaceState(t,t.state,null)}function zu(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},$f(e);var o=t.contextType;typeof o=="object"&&o!==null?i.context=hn(o):(o=Wt(t)?Jr:Nt.current,i.context=Wi(e,o)),i.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(Wu(e,t,o,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&oa.enqueueReplaceState(i,i.state,null),Sl(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Ji(e,t){try{var n="",r=t;do n+=Fx(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:i,digest:null}}function Za(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function qu(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var iy=typeof WeakMap=="function"?WeakMap:Map;function rg(e,t,n){n=$n(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Rl||(Rl=!0,ef=r),qu(e,t)},n}function ig(e,t,n){n=$n(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){qu(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){qu(e,t),typeof r!="function"&&(Tr===null?Tr=new Set([this]):Tr.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),n}function H0(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new iy;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=xy.bind(null,e,t,n),t.then(e,e))}function W0(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function z0(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=$n(-1,1),t.tag=2,yr(n,t,1))),n.lanes|=1),e)}var oy=nr.ReactCurrentOwner,Gt=!1;function Ft(e,t,n,r){t.child=e===null?Mm(t,null,n,r):qi(t,e.child,n,r)}function q0(e,t,n,r,i){n=n.render;var o=t.ref;return ki(t,i),r=bf(e,t,n,r,o,i),n=Qf(),e!==null&&!Gt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Zn(e,t,i)):(We&&n&&Bf(t),t.flags|=1,Ft(e,t,r,i),t.child)}function $0(e,t,n,r,i){if(e===null){var o=n.type;return typeof o=="function"&&!lc(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,og(e,t,o,r,i)):(e=ol(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:Yo,n(s,r)&&e.ref===t.ref)return Zn(e,t,i)}return t.flags|=1,e=Sr(o,r),e.ref=t.ref,e.return=t,t.child=e}function og(e,t,n,r,i){if(e!==null){var o=e.memoizedProps;if(Yo(o,r)&&e.ref===t.ref)if(Gt=!1,t.pendingProps=r=o,(e.lanes&i)!==0)e.flags&131072&&(Gt=!0);else return t.lanes=e.lanes,Zn(e,t,i)}return $u(e,t,n,r,i)}function sg(e,t,n){var r=t.pendingProps,i=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ue(Ci,Kt),Kt|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ue(Ci,Kt),Kt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Ue(Ci,Kt),Kt|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,Ue(Ci,Kt),Kt|=r;return Ft(e,t,i,n),t.child}function lg(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function $u(e,t,n,r,i){var o=Wt(n)?Jr:Nt.current;return o=Wi(t,o),ki(t,i),n=bf(e,t,n,r,o,i),r=Qf(),e!==null&&!Gt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Zn(e,t,i)):(We&&r&&Bf(t),t.flags|=1,Ft(e,t,n,i),t.child)}function J0(e,t,n,r,i){if(Wt(n)){var o=!0;xl(t)}else o=!1;if(ki(t,i),t.stateNode===null)nl(e,t),ng(t,n,r),zu(t,n,r,i),r=!0;else if(e===null){var s=t.stateNode,l=t.memoizedProps;s.props=l;var u=s.context,f=n.contextType;typeof f=="object"&&f!==null?f=hn(f):(f=Wt(n)?Jr:Nt.current,f=Wi(t,f));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof s.getSnapshotBeforeUpdate=="function";h||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==r||u!==f)&&G0(t,s,r,f),ur=!1;var p=t.memoizedState;s.state=p,Sl(t,r,s,i),u=t.memoizedState,l!==r||p!==u||Ht.current||ur?(typeof d=="function"&&(Wu(t,n,d,r),u=t.memoizedState),(l=ur||V0(t,n,l,r,p,u,f))?(h||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),s.props=r,s.state=u,s.context=f,r=l):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,Lm(e,t),l=t.memoizedProps,f=t.type===t.elementType?l:_n(t.type,l),s.props=f,h=t.pendingProps,p=s.context,u=n.contextType,typeof u=="object"&&u!==null?u=hn(u):(u=Wt(n)?Jr:Nt.current,u=Wi(t,u));var m=n.getDerivedStateFromProps;(d=typeof m=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==h||p!==u)&&G0(t,s,r,u),ur=!1,p=t.memoizedState,s.state=p,Sl(t,r,s,i);var v=t.memoizedState;l!==h||p!==v||Ht.current||ur?(typeof m=="function"&&(Wu(t,n,m,r),v=t.memoizedState),(f=ur||V0(t,n,f,r,p,v,u)||!1)?(d||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,v,u),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,v,u)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=v),s.props=r,s.state=v,s.context=u,r=f):(typeof s.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return Ju(e,t,n,r,o,i)}function Ju(e,t,n,r,i,o){lg(e,t);var s=(t.flags&128)!==0;if(!r&&!s)return i&&F0(t,n,!1),Zn(e,t,o);r=t.stateNode,oy.current=t;var l=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&s?(t.child=qi(t,e.child,null,o),t.child=qi(t,null,l,o)):Ft(e,t,l,o),t.memoizedState=r.state,i&&F0(t,n,!0),t.child}function ag(e){var t=e.stateNode;t.pendingContext?P0(e,t.pendingContext,t.pendingContext!==t.context):t.context&&P0(e,t.context,!1),Jf(e,t.containerInfo)}function Y0(e,t,n,r,i){return zi(),Gf(i),t.flags|=256,Ft(e,t,n,r),t.child}var Yu={dehydrated:null,treeContext:null,retryLane:0};function Ku(e){return{baseLanes:e,cachePool:null,transitions:null}}function ug(e,t,n){var r=t.pendingProps,i=$e.current,o=!1,s=(t.flags&128)!==0,l;if((l=s)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Ue($e,i&1),e===null)return Gu(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=r.children,e=r.fallback,o?(r=t.mode,o=t.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=aa(s,r,0,null),e=qr(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Ku(n),t.memoizedState=Yu,e):ec(t,s));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return sy(e,t,s,r,l,i,n);if(o){o=r.fallback,s=t.mode,i=e.child,l=i.sibling;var u={mode:"hidden",children:r.children};return!(s&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=Sr(i,u),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?o=Sr(l,o):(o=qr(o,s,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,s=e.child.memoizedState,s=s===null?Ku(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=e.childLanes&~n,t.memoizedState=Yu,r}return o=e.child,e=o.sibling,r=Sr(o,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function ec(e,t){return t=aa({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Os(e,t,n,r){return r!==null&&Gf(r),qi(t,e.child,null,n),e=ec(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function sy(e,t,n,r,i,o,s){if(n)return t.flags&256?(t.flags&=-257,r=Za(Error(Z(422))),Os(e,t,s,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=aa({mode:"visible",children:r.children},i,0,null),o=qr(o,i,s,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,t.mode&1&&qi(t,e.child,null,s),t.child.memoizedState=Ku(s),t.memoizedState=Yu,o);if(!(t.mode&1))return Os(e,t,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,o=Error(Z(419)),r=Za(o,r,void 0),Os(e,t,s,r)}if(l=(s&e.childLanes)!==0,Gt||l){if(r=ct,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Qn(e,i),Cn(r,e,i,-1))}return sc(),r=Za(Error(Z(421))),Os(e,t,s,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=_y.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,Zt=_r(i.nextSibling),jt=t,We=!0,Tn=null,e!==null&&(an[un++]=zn,an[un++]=qn,an[un++]=Yr,zn=e.id,qn=e.overflow,Yr=t),t=ec(t,r.children),t.flags|=4096,t)}function K0(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Hu(e.return,t,n)}function ja(e,t,n,r,i){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function fg(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(Ft(e,t,r.children,n),r=$e.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&K0(e,n,t);else if(e.tag===19)K0(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ue($e,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&wl(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),ja(t,!1,i,n,o);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&wl(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}ja(t,!0,n,null,o);break;case"together":ja(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function nl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Zn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Xr|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Z(153));if(t.child!==null){for(e=t.child,n=Sr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Sr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function ly(e,t,n){switch(t.tag){case 3:ag(t),zi();break;case 5:Om(t);break;case 1:Wt(t.type)&&xl(t);break;case 4:Jf(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ue(Tl,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Ue($e,$e.current&1),t.flags|=128,null):n&t.child.childLanes?ug(e,t,n):(Ue($e,$e.current&1),e=Zn(e,t,n),e!==null?e.sibling:null);Ue($e,$e.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return fg(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ue($e,$e.current),r)break;return null;case 22:case 23:return t.lanes=0,sg(e,t,n)}return Zn(e,t,n)}var cg,Xu,dg,hg;cg=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Xu=function(){};dg=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Wr(On.current);var o=null;switch(n){case"input":i=vu(e,i),r=vu(e,r),o=[];break;case"select":i=Ye({},i,{value:void 0}),r=Ye({},r,{value:void 0}),o=[];break;case"textarea":i=yu(e,i),r=yu(e,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=gl)}Eu(n,r);var s;n=null;for(f in i)if(!r.hasOwnProperty(f)&&i.hasOwnProperty(f)&&i[f]!=null)if(f==="style"){var l=i[f];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(Go.hasOwnProperty(f)?o||(o=[]):(o=o||[]).push(f,null));for(f in r){var u=r[f];if(l=i!=null?i[f]:void 0,r.hasOwnProperty(f)&&u!==l&&(u!=null||l!=null))if(f==="style")if(l){for(s in l)!l.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in u)u.hasOwnProperty(s)&&l[s]!==u[s]&&(n||(n={}),n[s]=u[s])}else n||(o||(o=[]),o.push(f,n)),n=u;else f==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(o=o||[]).push(f,u)):f==="children"?typeof u!="string"&&typeof u!="number"||(o=o||[]).push(f,""+u):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(Go.hasOwnProperty(f)?(u!=null&&f==="onScroll"&&Be("scroll",e),o||l===u||(o=[])):(o=o||[]).push(f,u))}n&&(o=o||[]).push("style",n);var f=o;(t.updateQueue=f)&&(t.flags|=4)}};hg=function(e,t,n,r){n!==r&&(t.flags|=4)};function mo(e,t){if(!We)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function wt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function ay(e,t,n){var r=t.pendingProps;switch(Vf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wt(t),null;case 1:return Wt(t.type)&&vl(),wt(t),null;case 3:return r=t.stateNode,$i(),Ge(Ht),Ge(Nt),Kf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Ds(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Tn!==null&&(rf(Tn),Tn=null))),Xu(e,t),wt(t),null;case 5:Yf(t);var i=Wr(Zo.current);if(n=t.type,e!==null&&t.stateNode!=null)dg(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(Z(166));return wt(t),null}if(e=Wr(On.current),Ds(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[Dn]=t,r[bo]=o,e=(t.mode&1)!==0,n){case"dialog":Be("cancel",r),Be("close",r);break;case"iframe":case"object":case"embed":Be("load",r);break;case"video":case"audio":for(i=0;i<Eo.length;i++)Be(Eo[i],r);break;case"source":Be("error",r);break;case"img":case"image":case"link":Be("error",r),Be("load",r);break;case"details":Be("toggle",r);break;case"input":r0(r,o),Be("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Be("invalid",r);break;case"textarea":o0(r,o),Be("invalid",r)}Eu(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="children"?typeof l=="string"?r.textContent!==l&&(o.suppressHydrationWarning!==!0&&Ms(r.textContent,l,e),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&Ms(r.textContent,l,e),i=["children",""+l]):Go.hasOwnProperty(s)&&l!=null&&s==="onScroll"&&Be("scroll",r)}switch(n){case"input":Cs(r),i0(r,o,!0);break;case"textarea":Cs(r),s0(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=gl)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Hp(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=s.createElement(n,{is:r.is}):(e=s.createElement(n),n==="select"&&(s=e,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):e=s.createElementNS(e,n),e[Dn]=t,e[bo]=r,cg(e,t,!1,!1),t.stateNode=e;e:{switch(s=Su(n,r),n){case"dialog":Be("cancel",e),Be("close",e),i=r;break;case"iframe":case"object":case"embed":Be("load",e),i=r;break;case"video":case"audio":for(i=0;i<Eo.length;i++)Be(Eo[i],e);i=r;break;case"source":Be("error",e),i=r;break;case"img":case"image":case"link":Be("error",e),Be("load",e),i=r;break;case"details":Be("toggle",e),i=r;break;case"input":r0(e,r),i=vu(e,r),Be("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=Ye({},r,{value:void 0}),Be("invalid",e);break;case"textarea":o0(e,r),i=yu(e,r),Be("invalid",e);break;default:i=r}Eu(n,i),l=i;for(o in l)if(l.hasOwnProperty(o)){var u=l[o];o==="style"?qp(e,u):o==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Wp(e,u)):o==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Ho(e,u):typeof u=="number"&&Ho(e,""+u):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Go.hasOwnProperty(o)?u!=null&&o==="onScroll"&&Be("scroll",e):u!=null&&wf(e,o,u,s))}switch(n){case"input":Cs(e),i0(e,r,!1);break;case"textarea":Cs(e),s0(e);break;case"option":r.value!=null&&e.setAttribute("value",""+wr(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?Ri(e,!!r.multiple,o,!1):r.defaultValue!=null&&Ri(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=gl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return wt(t),null;case 6:if(e&&t.stateNode!=null)hg(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(Z(166));if(n=Wr(Zo.current),Wr(On.current),Ds(t)){if(r=t.stateNode,n=t.memoizedProps,r[Dn]=t,(o=r.nodeValue!==n)&&(e=jt,e!==null))switch(e.tag){case 3:Ms(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ms(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Dn]=t,t.stateNode=r}return wt(t),null;case 13:if(Ge($e),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(We&&Zt!==null&&t.mode&1&&!(t.flags&128))Fm(),zi(),t.flags|=98560,o=!1;else if(o=Ds(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(Z(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(Z(317));o[Dn]=t}else zi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;wt(t),o=!1}else Tn!==null&&(rf(Tn),Tn=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||$e.current&1?st===0&&(st=3):sc())),t.updateQueue!==null&&(t.flags|=4),wt(t),null);case 4:return $i(),Xu(e,t),e===null&&Ko(t.stateNode.containerInfo),wt(t),null;case 10:return zf(t.type._context),wt(t),null;case 17:return Wt(t.type)&&vl(),wt(t),null;case 19:if(Ge($e),o=t.memoizedState,o===null)return wt(t),null;if(r=(t.flags&128)!==0,s=o.rendering,s===null)if(r)mo(o,!1);else{if(st!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=wl(e),s!==null){for(t.flags|=128,mo(o,!1),r=s.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,e=s.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ue($e,$e.current&1|2),t.child}e=e.sibling}o.tail!==null&&Ze()>Yi&&(t.flags|=128,r=!0,mo(o,!1),t.lanes=4194304)}else{if(!r)if(e=wl(s),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),mo(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!We)return wt(t),null}else 2*Ze()-o.renderingStartTime>Yi&&n!==1073741824&&(t.flags|=128,r=!0,mo(o,!1),t.lanes=4194304);o.isBackwards?(s.sibling=t.child,t.child=s):(n=o.last,n!==null?n.sibling=s:t.child=s,o.last=s)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ze(),t.sibling=null,n=$e.current,Ue($e,r?n&1|2:n&1),t):(wt(t),null);case 22:case 23:return oc(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Kt&1073741824&&(wt(t),t.subtreeFlags&6&&(t.flags|=8192)):wt(t),null;case 24:return null;case 25:return null}throw Error(Z(156,t.tag))}function uy(e,t){switch(Vf(t),t.tag){case 1:return Wt(t.type)&&vl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return $i(),Ge(Ht),Ge(Nt),Kf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Yf(t),null;case 13:if(Ge($e),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Z(340));zi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ge($e),null;case 4:return $i(),null;case 10:return zf(t.type._context),null;case 22:case 23:return oc(),null;case 24:return null;default:return null}}var Us=!1,Ct=!1,fy=typeof WeakSet=="function"?WeakSet:Set,ue=null;function wi(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Xe(e,t,r)}else n.current=null}function bu(e,t,n){try{n()}catch(r){Xe(e,t,r)}}var X0=!1;function cy(e,t){if(Mu=hl,e=xm(),Uf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,l=-1,u=-1,f=0,d=0,h=e,p=null;t:for(;;){for(var m;h!==n||i!==0&&h.nodeType!==3||(l=s+i),h!==o||r!==0&&h.nodeType!==3||(u=s+r),h.nodeType===3&&(s+=h.nodeValue.length),(m=h.firstChild)!==null;)p=h,h=m;for(;;){if(h===e)break t;if(p===n&&++f===i&&(l=s),p===o&&++d===r&&(u=s),(m=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=m}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Du={focusedElem:e,selectionRange:n},hl=!1,ue=t;ue!==null;)if(t=ue,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ue=e;else for(;ue!==null;){t=ue;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var g=v.memoizedProps,T=v.memoizedState,_=t.stateNode,x=_.getSnapshotBeforeUpdate(t.elementType===t.type?g:_n(t.type,g),T);_.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Z(163))}}catch(C){Xe(t,t.return,C)}if(e=t.sibling,e!==null){e.return=t.return,ue=e;break}ue=t.return}return v=X0,X0=!1,v}function Po(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,o!==void 0&&bu(t,n,o)}i=i.next}while(i!==r)}}function sa(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Qu(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function pg(e){var t=e.alternate;t!==null&&(e.alternate=null,pg(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Dn],delete t[bo],delete t[Uu],delete t[Y_],delete t[K_])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function mg(e){return e.tag===5||e.tag===3||e.tag===4}function b0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||mg(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Zu(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=gl));else if(r!==4&&(e=e.child,e!==null))for(Zu(e,t,n),e=e.sibling;e!==null;)Zu(e,t,n),e=e.sibling}function ju(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(ju(e,t,n),e=e.sibling;e!==null;)ju(e,t,n),e=e.sibling}var ht=null,yn=!1;function sr(e,t,n){for(n=n.child;n!==null;)gg(e,t,n),n=n.sibling}function gg(e,t,n){if(Ln&&typeof Ln.onCommitFiberUnmount=="function")try{Ln.onCommitFiberUnmount(Zl,n)}catch{}switch(n.tag){case 5:Ct||wi(n,t);case 6:var r=ht,i=yn;ht=null,sr(e,t,n),ht=r,yn=i,ht!==null&&(yn?(e=ht,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):ht.removeChild(n.stateNode));break;case 18:ht!==null&&(yn?(e=ht,n=n.stateNode,e.nodeType===8?Ja(e.parentNode,n):e.nodeType===1&&Ja(e,n),$o(e)):Ja(ht,n.stateNode));break;case 4:r=ht,i=yn,ht=n.stateNode.containerInfo,yn=!0,sr(e,t,n),ht=r,yn=i;break;case 0:case 11:case 14:case 15:if(!Ct&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&bu(n,t,s),i=i.next}while(i!==r)}sr(e,t,n);break;case 1:if(!Ct&&(wi(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Xe(n,t,l)}sr(e,t,n);break;case 21:sr(e,t,n);break;case 22:n.mode&1?(Ct=(r=Ct)||n.memoizedState!==null,sr(e,t,n),Ct=r):sr(e,t,n);break;default:sr(e,t,n)}}function Q0(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new fy),t.forEach(function(r){var i=yy.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function gn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,s=t,l=s;e:for(;l!==null;){switch(l.tag){case 5:ht=l.stateNode,yn=!1;break e;case 3:ht=l.stateNode.containerInfo,yn=!0;break e;case 4:ht=l.stateNode.containerInfo,yn=!0;break e}l=l.return}if(ht===null)throw Error(Z(160));gg(o,s,i),ht=null,yn=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(f){Xe(i,t,f)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)vg(t,e),t=t.sibling}function vg(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gn(t,e),Pn(e),r&4){try{Po(3,e,e.return),sa(3,e)}catch(g){Xe(e,e.return,g)}try{Po(5,e,e.return)}catch(g){Xe(e,e.return,g)}}break;case 1:gn(t,e),Pn(e),r&512&&n!==null&&wi(n,n.return);break;case 5:if(gn(t,e),Pn(e),r&512&&n!==null&&wi(n,n.return),e.flags&32){var i=e.stateNode;try{Ho(i,"")}catch(g){Xe(e,e.return,g)}}if(r&4&&(i=e.stateNode,i!=null)){var o=e.memoizedProps,s=n!==null?n.memoizedProps:o,l=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&Vp(i,o),Su(l,s);var f=Su(l,o);for(s=0;s<u.length;s+=2){var d=u[s],h=u[s+1];d==="style"?qp(i,h):d==="dangerouslySetInnerHTML"?Wp(i,h):d==="children"?Ho(i,h):wf(i,d,h,f)}switch(l){case"input":xu(i,o);break;case"textarea":Gp(i,o);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var m=o.value;m!=null?Ri(i,!!o.multiple,m,!1):p!==!!o.multiple&&(o.defaultValue!=null?Ri(i,!!o.multiple,o.defaultValue,!0):Ri(i,!!o.multiple,o.multiple?[]:"",!1))}i[bo]=o}catch(g){Xe(e,e.return,g)}}break;case 6:if(gn(t,e),Pn(e),r&4){if(e.stateNode===null)throw Error(Z(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){Xe(e,e.return,g)}}break;case 3:if(gn(t,e),Pn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{$o(t.containerInfo)}catch(g){Xe(e,e.return,g)}break;case 4:gn(t,e),Pn(e);break;case 13:gn(t,e),Pn(e),i=e.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(rc=Ze())),r&4&&Q0(e);break;case 22:if(d=n!==null&&n.memoizedState!==null,e.mode&1?(Ct=(f=Ct)||d,gn(t,e),Ct=f):gn(t,e),Pn(e),r&8192){if(f=e.memoizedState!==null,(e.stateNode.isHidden=f)&&!d&&e.mode&1)for(ue=e,d=e.child;d!==null;){for(h=ue=d;ue!==null;){switch(p=ue,m=p.child,p.tag){case 0:case 11:case 14:case 15:Po(4,p,p.return);break;case 1:wi(p,p.return);var v=p.stateNode;if(typeof v.componentWillUnmount=="function"){r=p,n=p.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){Xe(r,n,g)}}break;case 5:wi(p,p.return);break;case 22:if(p.memoizedState!==null){j0(h);continue}}m!==null?(m.return=p,ue=m):j0(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,f?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=h.stateNode,u=h.memoizedProps.style,s=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=zp("display",s))}catch(g){Xe(e,e.return,g)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=f?"":h.memoizedProps}catch(g){Xe(e,e.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gn(t,e),Pn(e),r&4&&Q0(e);break;case 21:break;default:gn(t,e),Pn(e)}}function Pn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(mg(n)){var r=n;break e}n=n.return}throw Error(Z(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Ho(i,""),r.flags&=-33);var o=b0(e);ju(e,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,l=b0(e);Zu(e,l,s);break;default:throw Error(Z(161))}}catch(u){Xe(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function dy(e,t,n){ue=e,xg(e)}function xg(e,t,n){for(var r=(e.mode&1)!==0;ue!==null;){var i=ue,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Us;if(!s){var l=i.alternate,u=l!==null&&l.memoizedState!==null||Ct;l=Us;var f=Ct;if(Us=s,(Ct=u)&&!f)for(ue=i;ue!==null;)s=ue,u=s.child,s.tag===22&&s.memoizedState!==null?ed(i):u!==null?(u.return=s,ue=u):ed(i);for(;o!==null;)ue=o,xg(o),o=o.sibling;ue=i,Us=l,Ct=f}Z0(e)}else i.subtreeFlags&8772&&o!==null?(o.return=i,ue=o):Z0(e)}}function Z0(e){for(;ue!==null;){var t=ue;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ct||sa(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Ct)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:_n(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&O0(t,o,r);break;case 3:var s=t.updateQueue;if(s!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}O0(t,s,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var f=t.alternate;if(f!==null){var d=f.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&$o(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Z(163))}Ct||t.flags&512&&Qu(t)}catch(p){Xe(t,t.return,p)}}if(t===e){ue=null;break}if(n=t.sibling,n!==null){n.return=t.return,ue=n;break}ue=t.return}}function j0(e){for(;ue!==null;){var t=ue;if(t===e){ue=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ue=n;break}ue=t.return}}function ed(e){for(;ue!==null;){var t=ue;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{sa(4,t)}catch(u){Xe(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(u){Xe(t,i,u)}}var o=t.return;try{Qu(t)}catch(u){Xe(t,o,u)}break;case 5:var s=t.return;try{Qu(t)}catch(u){Xe(t,s,u)}}}catch(u){Xe(t,t.return,u)}if(t===e){ue=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ue=l;break}ue=t.return}}var hy=Math.ceil,Il=nr.ReactCurrentDispatcher,tc=nr.ReactCurrentOwner,cn=nr.ReactCurrentBatchConfig,Se=0,ct=null,et=null,xt=0,Kt=0,Ci=Pr(0),st=0,ns=null,Xr=0,la=0,nc=0,Fo=null,Vt=null,rc=0,Yi=1/0,Hn=null,Rl=!1,ef=null,Tr=null,Bs=!1,hr=null,Nl=0,ko=0,tf=null,rl=-1,il=0;function Lt(){return Se&6?Ze():rl!==-1?rl:rl=Ze()}function Er(e){return e.mode&1?Se&2&&xt!==0?xt&-xt:b_.transition!==null?(il===0&&(il=nm()),il):(e=Me,e!==0||(e=window.event,e=e===void 0?16:um(e.type)),e):1}function Cn(e,t,n,r){if(50<ko)throw ko=0,tf=null,Error(Z(185));cs(e,n,r),(!(Se&2)||e!==ct)&&(e===ct&&(!(Se&2)&&(la|=n),st===4&&cr(e,xt)),zt(e,r),n===1&&Se===0&&!(t.mode&1)&&(Yi=Ze()+500,ra&&Fr()))}function zt(e,t){var n=e.callbackNode;bx(e,t);var r=dl(e,e===ct?xt:0);if(r===0)n!==null&&u0(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&u0(n),t===1)e.tag===0?X_(td.bind(null,e)):Rm(td.bind(null,e)),$_(function(){!(Se&6)&&Fr()}),n=null;else{switch(rm(r)){case 1:n=Nf;break;case 4:n=em;break;case 16:n=cl;break;case 536870912:n=tm;break;default:n=cl}n=Ag(n,_g.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function _g(e,t){if(rl=-1,il=0,Se&6)throw Error(Z(327));var n=e.callbackNode;if(Mi()&&e.callbackNode!==n)return null;var r=dl(e,e===ct?xt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Pl(e,r);else{t=r;var i=Se;Se|=2;var o=Tg();(ct!==e||xt!==t)&&(Hn=null,Yi=Ze()+500,zr(e,t));do try{gy();break}catch(l){yg(e,l)}while(!0);Wf(),Il.current=o,Se=i,et!==null?t=0:(ct=null,xt=0,t=st)}if(t!==0){if(t===2&&(i=Ru(e),i!==0&&(r=i,t=nf(e,i))),t===1)throw n=ns,zr(e,0),cr(e,r),zt(e,Ze()),n;if(t===6)cr(e,r);else{if(i=e.current.alternate,!(r&30)&&!py(i)&&(t=Pl(e,r),t===2&&(o=Ru(e),o!==0&&(r=o,t=nf(e,o))),t===1))throw n=ns,zr(e,0),cr(e,r),zt(e,Ze()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(Z(345));case 2:Br(e,Vt,Hn);break;case 3:if(cr(e,r),(r&130023424)===r&&(t=rc+500-Ze(),10<t)){if(dl(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){Lt(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Ou(Br.bind(null,e,Vt,Hn),t);break}Br(e,Vt,Hn);break;case 4:if(cr(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-wn(r);o=1<<s,s=t[s],s>i&&(i=s),r&=~o}if(r=i,r=Ze()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*hy(r/1960))-r,10<r){e.timeoutHandle=Ou(Br.bind(null,e,Vt,Hn),r);break}Br(e,Vt,Hn);break;case 5:Br(e,Vt,Hn);break;default:throw Error(Z(329))}}}return zt(e,Ze()),e.callbackNode===n?_g.bind(null,e):null}function nf(e,t){var n=Fo;return e.current.memoizedState.isDehydrated&&(zr(e,t).flags|=256),e=Pl(e,t),e!==2&&(t=Vt,Vt=n,t!==null&&rf(t)),e}function rf(e){Vt===null?Vt=e:Vt.push.apply(Vt,e)}function py(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!In(o(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function cr(e,t){for(t&=~nc,t&=~la,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-wn(t),r=1<<n;e[n]=-1,t&=~r}}function td(e){if(Se&6)throw Error(Z(327));Mi();var t=dl(e,0);if(!(t&1))return zt(e,Ze()),null;var n=Pl(e,t);if(e.tag!==0&&n===2){var r=Ru(e);r!==0&&(t=r,n=nf(e,r))}if(n===1)throw n=ns,zr(e,0),cr(e,t),zt(e,Ze()),n;if(n===6)throw Error(Z(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Br(e,Vt,Hn),zt(e,Ze()),null}function ic(e,t){var n=Se;Se|=1;try{return e(t)}finally{Se=n,Se===0&&(Yi=Ze()+500,ra&&Fr())}}function br(e){hr!==null&&hr.tag===0&&!(Se&6)&&Mi();var t=Se;Se|=1;var n=cn.transition,r=Me;try{if(cn.transition=null,Me=1,e)return e()}finally{Me=r,cn.transition=n,Se=t,!(Se&6)&&Fr()}}function oc(){Kt=Ci.current,Ge(Ci)}function zr(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,q_(n)),et!==null)for(n=et.return;n!==null;){var r=n;switch(Vf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&vl();break;case 3:$i(),Ge(Ht),Ge(Nt),Kf();break;case 5:Yf(r);break;case 4:$i();break;case 13:Ge($e);break;case 19:Ge($e);break;case 10:zf(r.type._context);break;case 22:case 23:oc()}n=n.return}if(ct=e,et=e=Sr(e.current,null),xt=Kt=t,st=0,ns=null,nc=la=Xr=0,Vt=Fo=null,Hr!==null){for(t=0;t<Hr.length;t++)if(n=Hr[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}Hr=null}return e}function yg(e,t){do{var n=et;try{if(Wf(),el.current=Al,Cl){for(var r=Je.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Cl=!1}if(Kr=0,lt=ot=Je=null,No=!1,jo=0,tc.current=null,n===null||n.return===null){st=1,ns=t,et=null;break}e:{var o=e,s=n.return,l=n,u=t;if(t=xt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var f=u,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=W0(s);if(m!==null){m.flags&=-257,z0(m,s,l,o,t),m.mode&1&&H0(o,f,t),t=m,u=f;var v=t.updateQueue;if(v===null){var g=new Set;g.add(u),t.updateQueue=g}else v.add(u);break e}else{if(!(t&1)){H0(o,f,t),sc();break e}u=Error(Z(426))}}else if(We&&l.mode&1){var T=W0(s);if(T!==null){!(T.flags&65536)&&(T.flags|=256),z0(T,s,l,o,t),Gf(Ji(u,l));break e}}o=u=Ji(u,l),st!==4&&(st=2),Fo===null?Fo=[o]:Fo.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var _=rg(o,u,t);L0(o,_);break e;case 1:l=u;var x=o.type,y=o.stateNode;if(!(o.flags&128)&&(typeof x.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Tr===null||!Tr.has(y)))){o.flags|=65536,t&=-t,o.lanes|=t;var C=ig(o,l,t);L0(o,C);break e}}o=o.return}while(o!==null)}Sg(n)}catch(k){t=k,et===n&&n!==null&&(et=n=n.return);continue}break}while(!0)}function Tg(){var e=Il.current;return Il.current=Al,e===null?Al:e}function sc(){(st===0||st===3||st===2)&&(st=4),ct===null||!(Xr&268435455)&&!(la&268435455)||cr(ct,xt)}function Pl(e,t){var n=Se;Se|=2;var r=Tg();(ct!==e||xt!==t)&&(Hn=null,zr(e,t));do try{my();break}catch(i){yg(e,i)}while(!0);if(Wf(),Se=n,Il.current=r,et!==null)throw Error(Z(261));return ct=null,xt=0,st}function my(){for(;et!==null;)Eg(et)}function gy(){for(;et!==null&&!Hx();)Eg(et)}function Eg(e){var t=Cg(e.alternate,e,Kt);e.memoizedProps=e.pendingProps,t===null?Sg(e):et=t,tc.current=null}function Sg(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=uy(n,t),n!==null){n.flags&=32767,et=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{st=6,et=null;return}}else if(n=ay(n,t,Kt),n!==null){et=n;return}if(t=t.sibling,t!==null){et=t;return}et=t=e}while(t!==null);st===0&&(st=5)}function Br(e,t,n){var r=Me,i=cn.transition;try{cn.transition=null,Me=1,vy(e,t,n,r)}finally{cn.transition=i,Me=r}return null}function vy(e,t,n,r){do Mi();while(hr!==null);if(Se&6)throw Error(Z(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Z(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(Qx(e,o),e===ct&&(et=ct=null,xt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Bs||(Bs=!0,Ag(cl,function(){return Mi(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=cn.transition,cn.transition=null;var s=Me;Me=1;var l=Se;Se|=4,tc.current=null,cy(e,n),vg(n,e),U_(Du),hl=!!Mu,Du=Mu=null,e.current=n,dy(n),Wx(),Se=l,Me=s,cn.transition=o}else e.current=n;if(Bs&&(Bs=!1,hr=e,Nl=i),o=e.pendingLanes,o===0&&(Tr=null),$x(n.stateNode),zt(e,Ze()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Rl)throw Rl=!1,e=ef,ef=null,e;return Nl&1&&e.tag!==0&&Mi(),o=e.pendingLanes,o&1?e===tf?ko++:(ko=0,tf=e):ko=0,Fr(),null}function Mi(){if(hr!==null){var e=rm(Nl),t=cn.transition,n=Me;try{if(cn.transition=null,Me=16>e?16:e,hr===null)var r=!1;else{if(e=hr,hr=null,Nl=0,Se&6)throw Error(Z(331));var i=Se;for(Se|=4,ue=e.current;ue!==null;){var o=ue,s=o.child;if(ue.flags&16){var l=o.deletions;if(l!==null){for(var u=0;u<l.length;u++){var f=l[u];for(ue=f;ue!==null;){var d=ue;switch(d.tag){case 0:case 11:case 15:Po(8,d,o)}var h=d.child;if(h!==null)h.return=d,ue=h;else for(;ue!==null;){d=ue;var p=d.sibling,m=d.return;if(pg(d),d===f){ue=null;break}if(p!==null){p.return=m,ue=p;break}ue=m}}}var v=o.alternate;if(v!==null){var g=v.child;if(g!==null){v.child=null;do{var T=g.sibling;g.sibling=null,g=T}while(g!==null)}}ue=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,ue=s;else e:for(;ue!==null;){if(o=ue,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Po(9,o,o.return)}var _=o.sibling;if(_!==null){_.return=o.return,ue=_;break e}ue=o.return}}var x=e.current;for(ue=x;ue!==null;){s=ue;var y=s.child;if(s.subtreeFlags&2064&&y!==null)y.return=s,ue=y;else e:for(s=x;ue!==null;){if(l=ue,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:sa(9,l)}}catch(k){Xe(l,l.return,k)}if(l===s){ue=null;break e}var C=l.sibling;if(C!==null){C.return=l.return,ue=C;break e}ue=l.return}}if(Se=i,Fr(),Ln&&typeof Ln.onPostCommitFiberRoot=="function")try{Ln.onPostCommitFiberRoot(Zl,e)}catch{}r=!0}return r}finally{Me=n,cn.transition=t}}return!1}function nd(e,t,n){t=Ji(n,t),t=rg(e,t,1),e=yr(e,t,1),t=Lt(),e!==null&&(cs(e,1,t),zt(e,t))}function Xe(e,t,n){if(e.tag===3)nd(e,e,n);else for(;t!==null;){if(t.tag===3){nd(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Tr===null||!Tr.has(r))){e=Ji(n,e),e=ig(t,e,1),t=yr(t,e,1),e=Lt(),t!==null&&(cs(t,1,e),zt(t,e));break}}t=t.return}}function xy(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Lt(),e.pingedLanes|=e.suspendedLanes&n,ct===e&&(xt&n)===n&&(st===4||st===3&&(xt&130023424)===xt&&500>Ze()-rc?zr(e,0):nc|=n),zt(e,t)}function wg(e,t){t===0&&(e.mode&1?(t=Rs,Rs<<=1,!(Rs&130023424)&&(Rs=4194304)):t=1);var n=Lt();e=Qn(e,t),e!==null&&(cs(e,t,n),zt(e,n))}function _y(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),wg(e,n)}function yy(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(Z(314))}r!==null&&r.delete(t),wg(e,n)}var Cg;Cg=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ht.current)Gt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Gt=!1,ly(e,t,n);Gt=!!(e.flags&131072)}else Gt=!1,We&&t.flags&1048576&&Nm(t,yl,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;nl(e,t),e=t.pendingProps;var i=Wi(t,Nt.current);ki(t,n),i=bf(null,t,r,e,i,n);var o=Qf();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Wt(r)?(o=!0,xl(t)):o=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,$f(t),i.updater=oa,t.stateNode=i,i._reactInternals=t,zu(t,r,e,n),t=Ju(null,t,r,!0,o,n)):(t.tag=0,We&&o&&Bf(t),Ft(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(nl(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=Ey(r),e=_n(r,e),i){case 0:t=$u(null,t,r,e,n);break e;case 1:t=J0(null,t,r,e,n);break e;case 11:t=q0(null,t,r,e,n);break e;case 14:t=$0(null,t,r,_n(r.type,e),n);break e}throw Error(Z(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:_n(r,i),$u(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:_n(r,i),J0(e,t,r,i,n);case 3:e:{if(ag(t),e===null)throw Error(Z(387));r=t.pendingProps,o=t.memoizedState,i=o.element,Lm(e,t),Sl(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){i=Ji(Error(Z(423)),t),t=Y0(e,t,r,n,i);break e}else if(r!==i){i=Ji(Error(Z(424)),t),t=Y0(e,t,r,n,i);break e}else for(Zt=_r(t.stateNode.containerInfo.firstChild),jt=t,We=!0,Tn=null,n=Mm(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(zi(),r===i){t=Zn(e,t,n);break e}Ft(e,t,r,n)}t=t.child}return t;case 5:return Om(t),e===null&&Gu(t),r=t.type,i=t.pendingProps,o=e!==null?e.memoizedProps:null,s=i.children,Lu(r,i)?s=null:o!==null&&Lu(r,o)&&(t.flags|=32),lg(e,t),Ft(e,t,s,n),t.child;case 6:return e===null&&Gu(t),null;case 13:return ug(e,t,n);case 4:return Jf(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=qi(t,null,r,n):Ft(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:_n(r,i),q0(e,t,r,i,n);case 7:return Ft(e,t,t.pendingProps,n),t.child;case 8:return Ft(e,t,t.pendingProps.children,n),t.child;case 12:return Ft(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,Ue(Tl,r._currentValue),r._currentValue=s,o!==null)if(In(o.value,s)){if(o.children===i.children&&!Ht.current){t=Zn(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var l=o.dependencies;if(l!==null){s=o.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(o.tag===1){u=$n(-1,n&-n),u.tag=2;var f=o.updateQueue;if(f!==null){f=f.shared;var d=f.pending;d===null?u.next=u:(u.next=d.next,d.next=u),f.pending=u}}o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),Hu(o.return,n,t),l.lanes|=n;break}u=u.next}}else if(o.tag===10)s=o.type===t.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(Z(341));s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Hu(s,n,t),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===t){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}Ft(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,ki(t,n),i=hn(i),r=r(i),t.flags|=1,Ft(e,t,r,n),t.child;case 14:return r=t.type,i=_n(r,t.pendingProps),i=_n(r.type,i),$0(e,t,r,i,n);case 15:return og(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:_n(r,i),nl(e,t),t.tag=1,Wt(r)?(e=!0,xl(t)):e=!1,ki(t,n),ng(t,r,i),zu(t,r,i,n),Ju(null,t,r,!0,e,n);case 19:return fg(e,t,n);case 22:return sg(e,t,n)}throw Error(Z(156,t.tag))};function Ag(e,t){return jp(e,t)}function Ty(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fn(e,t,n,r){return new Ty(e,t,n,r)}function lc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ey(e){if(typeof e=="function")return lc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Af)return 11;if(e===If)return 14}return 2}function Sr(e,t){var n=e.alternate;return n===null?(n=fn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ol(e,t,n,r,i,o){var s=2;if(r=e,typeof e=="function")lc(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case mi:return qr(n.children,i,o,t);case Cf:s=8,i|=8;break;case hu:return e=fn(12,n,t,i|2),e.elementType=hu,e.lanes=o,e;case pu:return e=fn(13,n,t,i),e.elementType=pu,e.lanes=o,e;case mu:return e=fn(19,n,t,i),e.elementType=mu,e.lanes=o,e;case Op:return aa(n,i,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Dp:s=10;break e;case Lp:s=9;break e;case Af:s=11;break e;case If:s=14;break e;case ar:s=16,r=null;break e}throw Error(Z(130,e==null?e:typeof e,""))}return t=fn(s,n,t,i),t.elementType=e,t.type=r,t.lanes=o,t}function qr(e,t,n,r){return e=fn(7,e,r,t),e.lanes=n,e}function aa(e,t,n,r){return e=fn(22,e,r,t),e.elementType=Op,e.lanes=n,e.stateNode={isHidden:!1},e}function eu(e,t,n){return e=fn(6,e,null,t),e.lanes=n,e}function tu(e,t,n){return t=fn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Sy(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=La(0),this.expirationTimes=La(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=La(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function ac(e,t,n,r,i,o,s,l,u){return e=new Sy(e,t,n,l,u),t===1?(t=1,o===!0&&(t|=8)):t=0,o=fn(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},$f(o),e}function wy(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:pi,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Ig(e){if(!e)return Cr;e=e._reactInternals;e:{if(ti(e)!==e||e.tag!==1)throw Error(Z(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Wt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Z(171))}if(e.tag===1){var n=e.type;if(Wt(n))return Im(e,n,t)}return t}function Rg(e,t,n,r,i,o,s,l,u){return e=ac(n,r,!0,e,i,o,s,l,u),e.context=Ig(null),n=e.current,r=Lt(),i=Er(n),o=$n(r,i),o.callback=t??null,yr(n,o,i),e.current.lanes=i,cs(e,i,r),zt(e,r),e}function ua(e,t,n,r){var i=t.current,o=Lt(),s=Er(i);return n=Ig(n),t.context===null?t.context=n:t.pendingContext=n,t=$n(o,s),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=yr(i,t,s),e!==null&&(Cn(e,i,s,o),js(e,i,s)),s}function Fl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function rd(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function uc(e,t){rd(e,t),(e=e.alternate)&&rd(e,t)}function Cy(){return null}var Ng=typeof reportError=="function"?reportError:function(e){console.error(e)};function fc(e){this._internalRoot=e}fa.prototype.render=fc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Z(409));ua(e,t,null,null)};fa.prototype.unmount=fc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;br(function(){ua(null,e,null,null)}),t[bn]=null}};function fa(e){this._internalRoot=e}fa.prototype.unstable_scheduleHydration=function(e){if(e){var t=sm();e={blockedOn:null,target:e,priority:t};for(var n=0;n<fr.length&&t!==0&&t<fr[n].priority;n++);fr.splice(n,0,e),n===0&&am(e)}};function cc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ca(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function id(){}function Ay(e,t,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var f=Fl(s);o.call(f)}}var s=Rg(t,r,e,0,null,!1,!1,"",id);return e._reactRootContainer=s,e[bn]=s.current,Ko(e.nodeType===8?e.parentNode:e),br(),s}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var f=Fl(u);l.call(f)}}var u=ac(e,0,!1,null,null,!1,!1,"",id);return e._reactRootContainer=u,e[bn]=u.current,Ko(e.nodeType===8?e.parentNode:e),br(function(){ua(t,u,n,r)}),u}function da(e,t,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var l=i;i=function(){var u=Fl(s);l.call(u)}}ua(t,s,e,i)}else s=Ay(n,t,e,i,r);return Fl(s)}im=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=To(t.pendingLanes);n!==0&&(Pf(t,n|1),zt(t,Ze()),!(Se&6)&&(Yi=Ze()+500,Fr()))}break;case 13:br(function(){var r=Qn(e,1);if(r!==null){var i=Lt();Cn(r,e,1,i)}}),uc(e,1)}};Ff=function(e){if(e.tag===13){var t=Qn(e,134217728);if(t!==null){var n=Lt();Cn(t,e,134217728,n)}uc(e,134217728)}};om=function(e){if(e.tag===13){var t=Er(e),n=Qn(e,t);if(n!==null){var r=Lt();Cn(n,e,t,r)}uc(e,t)}};sm=function(){return Me};lm=function(e,t){var n=Me;try{return Me=e,t()}finally{Me=n}};Cu=function(e,t,n){switch(t){case"input":if(xu(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=na(r);if(!i)throw Error(Z(90));Bp(r),xu(r,i)}}}break;case"textarea":Gp(e,n);break;case"select":t=n.value,t!=null&&Ri(e,!!n.multiple,t,!1)}};Yp=ic;Kp=br;var Iy={usingClientEntryPoint:!1,Events:[hs,_i,na,$p,Jp,ic]},go={findFiberByHostInstance:Gr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ry={bundleType:go.bundleType,version:go.version,rendererPackageName:go.rendererPackageName,rendererConfig:go.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:nr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Qp(e),e===null?null:e.stateNode},findFiberByHostInstance:go.findFiberByHostInstance||Cy,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vs.isDisabled&&Vs.supportsFiber)try{Zl=Vs.inject(Ry),Ln=Vs}catch{}}nn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Iy;nn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!cc(t))throw Error(Z(200));return wy(e,t,null,n)};nn.createRoot=function(e,t){if(!cc(e))throw Error(Z(299));var n=!1,r="",i=Ng;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=ac(e,1,!1,null,null,n,!1,r,i),e[bn]=t.current,Ko(e.nodeType===8?e.parentNode:e),new fc(t)};nn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Z(188)):(e=Object.keys(e).join(","),Error(Z(268,e)));return e=Qp(t),e=e===null?null:e.stateNode,e};nn.flushSync=function(e){return br(e)};nn.hydrate=function(e,t,n){if(!ca(t))throw Error(Z(200));return da(null,e,t,!0,n)};nn.hydrateRoot=function(e,t,n){if(!cc(e))throw Error(Z(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=Ng;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),t=Rg(t,null,e,1,n??null,i,!1,o,s),e[bn]=t.current,Ko(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new fa(t)};nn.render=function(e,t,n){if(!ca(t))throw Error(Z(200));return da(null,e,t,!1,n)};nn.unmountComponentAtNode=function(e){if(!ca(e))throw Error(Z(40));return e._reactRootContainer?(br(function(){da(null,null,e,!1,function(){e._reactRootContainer=null,e[bn]=null})}),!0):!1};nn.unstable_batchedUpdates=ic;nn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!ca(n))throw Error(Z(200));if(e==null||e._reactInternals===void 0)throw Error(Z(38));return da(e,t,n,!1,r)};nn.version="18.3.1-next-f1338f8080-20240426";function Pg(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Pg)}catch(e){console.error(e)}}Pg(),Pp.exports=nn;var Ny=Pp.exports,od=Ny;cu.createRoot=od.createRoot,cu.hydrateRoot=od.hydrateRoot;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var kl={};kl.version="0.18.5";var Fg=1252,Py=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],kg=function(e){Py.indexOf(e)!=-1&&(Fg=e)};function Fy(){kg(1252)}var rs=function(e){kg(e)};function ky(){rs(1200),Fy()}var Gs=function(t){return String.fromCharCode(t)},sd=function(t){return String.fromCharCode(t)},Ml,pr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function is(e){for(var t="",n=0,r=0,i=0,o=0,s=0,l=0,u=0,f=0;f<e.length;)n=e.charCodeAt(f++),o=n>>2,r=e.charCodeAt(f++),s=(n&3)<<4|r>>4,i=e.charCodeAt(f++),l=(r&15)<<2|i>>6,u=i&63,isNaN(r)?l=u=64:isNaN(i)&&(u=64),t+=pr.charAt(o)+pr.charAt(s)+pr.charAt(l)+pr.charAt(u);return t}function jn(e){var t="",n=0,r=0,i=0,o=0,s=0,l=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)o=pr.indexOf(e.charAt(f++)),s=pr.indexOf(e.charAt(f++)),n=o<<2|s>>4,t+=String.fromCharCode(n),l=pr.indexOf(e.charAt(f++)),r=(s&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(r)),u=pr.indexOf(e.charAt(f++)),i=(l&3)<<6|u,u!==64&&(t+=String.fromCharCode(i));return t}var Ie=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),rr=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,n){return n?new Buffer(t,n):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Qr(e){return Ie?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function ld(e){return Ie?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var En=function(t){return Ie?rr(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)&255})};function ha(e){if(typeof ArrayBuffer>"u")return En(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=e.charCodeAt(r)&255;return t}function ms(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function My(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var gt=Ie?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:rr(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),i=0;for(t=0,n=0;t<e.length;n+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if(typeof e[t]=="string")throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function Dy(e){for(var t=[],n=0,r=e.length+250,i=Qr(e.length+255),o=0;o<e.length;++o){var s=e.charCodeAt(o);if(s<128)i[n++]=s;else if(s<2048)i[n++]=192|s>>6&31,i[n++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var l=e.charCodeAt(++o)&1023;i[n++]=240|s>>8&7,i[n++]=128|s>>2&63,i[n++]=128|l>>6&15|(s&3)<<4,i[n++]=128|l&63}else i[n++]=224|s>>12&15,i[n++]=128|s>>6&63,i[n++]=128|s&63;n>r&&(t.push(i.slice(0,n)),n=0,i=Qr(65535),r=65530)}return t.push(i.slice(0,n)),gt(t)}var Mo=/\u0000/g,Hs=/[\u0001-\u0006]/g;function Di(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function Sn(e,t){var n=""+e;return n.length>=t?n:be("0",t-n.length)+n}function dc(e,t){var n=""+e;return n.length>=t?n:be(" ",t-n.length)+n}function Dl(e,t){var n=""+e;return n.length>=t?n:n+be(" ",t-n.length)}function Ly(e,t){var n=""+Math.round(e);return n.length>=t?n:be("0",t-n.length)+n}function Oy(e,t){var n=""+e;return n.length>=t?n:be("0",t-n.length)+n}var ad=Math.pow(2,32);function fi(e,t){if(e>ad||e<-ad)return Ly(e,t);var n=Math.round(e);return Oy(n,t)}function Ll(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var ud=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],nu=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Uy(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Qe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},fd={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},By={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ol(e,t,n){for(var r=e<0?-1:1,i=e*r,o=0,s=1,l=0,u=1,f=0,d=0,h=Math.floor(i);f<t&&(h=Math.floor(i),l=h*s+o,d=h*f+u,!(i-h<5e-8));)i=1/(i-h),o=s,s=l,u=f,f=d;if(d>t&&(f>t?(d=u,l=o):(d=f,l=s)),!n)return[0,r*l,d];var p=Math.floor(r*l/d);return[p,r*l-p*d,d]}function Ws(e,t,n){if(e>2958465||e<0)return null;var r=e|0,i=Math.floor(86400*(e-r)),o=0,s=[],l={D:r,T:i,u:86400*(e-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(r+=1462),l.u>.9999&&(l.u=0,++i==86400&&(l.T=i=0,++r,++l.D)),r===60)s=n?[1317,10,29]:[1900,2,29],o=3;else if(r===0)s=n?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var u=new Date(1900,0,1);u.setDate(u.getDate()+r-1),s=[u.getFullYear(),u.getMonth()+1,u.getDate()],o=u.getDay(),r<60&&(o=(o+6)%7),n&&(o=$y(u,s))}return l.y=s[0],l.m=s[1],l.d=s[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=o,l}var Mg=new Date(1899,11,31,0,0,0),Vy=Mg.getTime(),Gy=new Date(1900,2,1,0,0,0);function Dg(e,t){var n=e.getTime();return t?n-=1461*24*60*60*1e3:e>=Gy&&(n+=24*60*60*1e3),(n-(Vy+(e.getTimezoneOffset()-Mg.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function hc(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Hy(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Wy(e){var t=e<0?12:11,n=hc(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10),n.length<=t)?n:e.toExponential(5)}function zy(e){var t=hc(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function qy(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),n;return t>=-4&&t<=-1?n=e.toPrecision(10+t):Math.abs(t)<=9?n=Wy(e):t===10?n=e.toFixed(10).substr(0,12):n=zy(e),hc(Hy(n.toUpperCase()))}function of(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):qy(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ar(14,Dg(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function $y(e,t){t[0]-=581;var n=e.getDay();return e<60&&(n=(n+6)%7),n}function Jy(e,t,n,r){var i="",o=0,s=0,l=n.y,u,f=0;switch(e){case 98:l=n.y+543;case 121:switch(t.length){case 1:case 2:u=l%100,f=2;break;default:u=l%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:u=n.m,f=t.length;break;case 3:return nu[n.m-1][1];case 5:return nu[n.m-1][0];default:return nu[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=n.d,f=t.length;break;case 3:return ud[n.q][0];default:return ud[n.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(n.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=n.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=n.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return n.u===0&&(t=="s"||t=="ss")?Sn(n.S,t.length):(r>=2?s=r===3?1e3:100:s=r===1?10:1,o=Math.round(s*(n.S+n.u)),o>=60*s&&(o=0),t==="s"?o===0?"0":""+o/s:(i=Sn(o,2+r),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=n.D*24+n.H;break;case"[m]":case"[mm]":u=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":u=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:u=l,f=1;break}var d=f>0?Sn(u,f):"";return d}function mr(e){var t=3;if(e.length<=t)return e;for(var n=e.length%t,r=e.substr(0,n);n!=e.length;n+=t)r+=(r.length>0?",":"")+e.substr(n,t);return r}var Lg=/%/g;function Yy(e,t,n){var r=t.replace(Lg,""),i=t.length-r.length;return Jn(e,r,n*Math.pow(10,2*i))+be("%",i)}function Ky(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return Jn(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function Og(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Og(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%i;if(o<0&&(o+=i),n=(t/Math.pow(10,o)).toPrecision(r+1+(i+o)%i),n.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+o):n+="E+"+(s-o);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,i)+"."+n.substr(2+i),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,d){return u+f+d.substr(0,(i+o)%i)+"."+d.substr(o)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var Ug=/# (\?+)( ?)\/( ?)(\d+)/;function Xy(e,t,n){var r=parseInt(e[4],10),i=Math.round(t*r),o=Math.floor(i/r),s=i-o*r,l=r;return n+(o===0?"":""+o)+" "+(s===0?be(" ",e[1].length+1+e[4].length):dc(s,e[1].length)+e[2]+"/"+e[3]+Sn(l,e[4].length))}function by(e,t,n){return n+(t===0?"":""+t)+be(" ",e[1].length+2+e[4].length)}var Bg=/^#*0*\.([0#]+)/,Vg=/\).*[0#]/,Gg=/\(###\) ###\\?-####/;function kt(e){for(var t="",n,r=0;r!=e.length;++r)switch(n=e.charCodeAt(r)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(n)}return t}function cd(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function dd(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function Qy(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Zy(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function sn(e,t,n){if(e.charCodeAt(0)===40&&!t.match(Vg)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?sn("n",r,n):"("+sn("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return Ky(e,t,n);if(t.indexOf("%")!==-1)return Yy(e,t,n);if(t.indexOf("E")!==-1)return Og(t,n);if(t.charCodeAt(0)===36)return"$"+sn(e,t.substr(t.charAt(1)==" "?2:1),n);var i,o,s,l,u=Math.abs(n),f=n<0?"-":"";if(t.match(/^00+$/))return f+fi(u,t.length);if(t.match(/^[#?]+$/))return i=fi(n,0),i==="0"&&(i=""),i.length>t.length?i:kt(t.substr(0,t.length-i.length))+i;if(o=t.match(Ug))return Xy(o,u,f);if(t.match(/^#+0+$/))return f+fi(u,t.length-t.indexOf("0"));if(o=t.match(Bg))return i=cd(n,o[1].length).replace(/^([^\.]+)$/,"$1."+kt(o[1])).replace(/\.$/,"."+kt(o[1])).replace(/\.(\d*)$/,function(v,g){return"."+g+be("0",kt(o[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return f+cd(u,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return f+mr(fi(u,0));if(o=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+sn(e,t,-n):mr(""+(Math.floor(n)+Qy(n,o[1].length)))+"."+Sn(dd(n,o[1].length),o[1].length);if(o=t.match(/^#,#*,#0/))return sn(e,t.replace(/^#,#*,/,""),n);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Di(sn(e,t.replace(/[\\-]/g,""),n)),s=0,Di(Di(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<i.length?i.charAt(s++):v==="0"?"0":""}));if(t.match(Gg))return i=sn(e,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),l=Ol(u,Math.pow(10,s)-1,!1),i=""+f,d=Jn("n",o[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+o[2]+"/"+o[3],d=Dl(l[2],s),d.length<o[4].length&&(d=kt(o[4].substr(o[4].length-d.length))+d),i+=d,i;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),l=Ol(u,Math.pow(10,s)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?dc(l[1],s)+o[2]+"/"+o[3]+Dl(l[2],s):be(" ",2*s+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return i=fi(n,0),t.length<=i.length?i:kt(t.substr(0,t.length-i.length))+i;if(o=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var h=t.indexOf(".")-s,p=t.length-i.length-h;return kt(t.substr(0,h)+i+t.substr(t.length-p))}if(o=t.match(/^00,000\.([#0]*0)$/))return s=dd(n,o[1].length),n<0?"-"+sn(e,t,-n):mr(Zy(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Sn(0,3-v.length):"")+v})+"."+Sn(s,o[1].length);switch(t){case"###,##0.00":return sn(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var m=mr(fi(u,0));return m!=="0"?f+m:"";case"###,###.00":return sn(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return sn(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function jy(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return Jn(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function eT(e,t,n){var r=t.replace(Lg,""),i=t.length-r.length;return Jn(e,r,n*Math.pow(10,2*i))+be("%",i)}function Hg(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Hg(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%i;if(o<0&&(o+=i),n=(t/Math.pow(10,o)).toPrecision(r+1+(i+o)%i),!n.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+o):n+="E+"+(s-o),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,u,f,d){return u+f+d.substr(0,(i+o)%i)+"."+d.substr(o)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function Fn(e,t,n){if(e.charCodeAt(0)===40&&!t.match(Vg)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Fn("n",r,n):"("+Fn("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return jy(e,t,n);if(t.indexOf("%")!==-1)return eT(e,t,n);if(t.indexOf("E")!==-1)return Hg(t,n);if(t.charCodeAt(0)===36)return"$"+Fn(e,t.substr(t.charAt(1)==" "?2:1),n);var i,o,s,l,u=Math.abs(n),f=n<0?"-":"";if(t.match(/^00+$/))return f+Sn(u,t.length);if(t.match(/^[#?]+$/))return i=""+n,n===0&&(i=""),i.length>t.length?i:kt(t.substr(0,t.length-i.length))+i;if(o=t.match(Ug))return by(o,u,f);if(t.match(/^#+0+$/))return f+Sn(u,t.length-t.indexOf("0"));if(o=t.match(Bg))return i=(""+n).replace(/^([^\.]+)$/,"$1."+kt(o[1])).replace(/\.$/,"."+kt(o[1])),i=i.replace(/\.(\d*)$/,function(v,g){return"."+g+be("0",kt(o[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return f+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return f+mr(""+u);if(o=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Fn(e,t,-n):mr(""+n)+"."+be("0",o[1].length);if(o=t.match(/^#,#*,#0/))return Fn(e,t.replace(/^#,#*,/,""),n);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Di(Fn(e,t.replace(/[\\-]/g,""),n)),s=0,Di(Di(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<i.length?i.charAt(s++):v==="0"?"0":""}));if(t.match(Gg))return i=Fn(e,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),l=Ol(u,Math.pow(10,s)-1,!1),i=""+f,d=Jn("n",o[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+o[2]+"/"+o[3],d=Dl(l[2],s),d.length<o[4].length&&(d=kt(o[4].substr(o[4].length-d.length))+d),i+=d,i;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),l=Ol(u,Math.pow(10,s)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?dc(l[1],s)+o[2]+"/"+o[3]+Dl(l[2],s):be(" ",2*s+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return i=""+n,t.length<=i.length?i:kt(t.substr(0,t.length-i.length))+i;if(o=t.match(/^([#0]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var h=t.indexOf(".")-s,p=t.length-i.length-h;return kt(t.substr(0,h)+i+t.substr(t.length-p))}if(o=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+Fn(e,t,-n):mr(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Sn(0,3-v.length):"")+v})+"."+Sn(0,o[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=mr(""+u);return m!=="0"?f+m:"";default:if(t.match(/\.[0#?]*$/))return Fn(e,t.slice(0,t.lastIndexOf(".")),n)+kt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Jn(e,t,n){return(n|0)===n?Fn(e,t,n):sn(e,t,n)}function tT(e){for(var t=[],n=!1,r=0,i=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(i,r-i),i=r+1}if(t[t.length]=e.substr(i),n===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Wg=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function zg(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":Ll(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(r=n;e.charAt(t++)!=="]"&&t<e.length;)r+=e.charAt(t);if(r.match(Wg))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||n=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function nT(e,t,n,r){for(var i=[],o="",s=0,l="",u="t",f,d,h,p="H";s<e.length;)switch(l=e.charAt(s)){case"G":if(!Ll(e,s))throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(o="";(h=e.charCodeAt(++s))!==34&&s<e.length;)o+=String.fromCharCode(h);i[i.length]={t:"t",v:o},++s;break;case"\\":var m=e.charAt(++s),v=m==="("||m===")"?m:"t";i[i.length]={t:v,v:m},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(f==null&&(f=Ws(t,n,e.charAt(s+1)==="2"),f==null))return"";i[i.length]={t:"X",v:e.substr(s,2)},u=l,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=Ws(t,n),f==null))return"";for(o=l;++s<e.length&&e.charAt(s).toLowerCase()===l;)o+=l;l==="m"&&u.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=p),i[i.length]={t:l,v:o},u=l;break;case"A":case"a":case"":var g={t:l,v:l};if(f==null&&(f=Ws(t,n)),e.substr(s,3).toUpperCase()==="A/P"?(f!=null&&(g.v=f.H>=12?"P":"A"),g.t="T",p="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(f!=null&&(g.v=f.H>=12?"PM":"AM"),g.t="T",s+=5,p="h"):e.substr(s,5).toUpperCase()==="/"?(f!=null&&(g.v=f.H>=12?"":""),g.t="T",s+=5,p="h"):(g.t="t",++s),f==null&&g.t==="T")return"";i[i.length]=g,u=l;break;case"[":for(o=l;e.charAt(s++)!=="]"&&s<e.length;)o+=e.charAt(s);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(Wg)){if(f==null&&(f=Ws(t,n),f==null))return"";i[i.length]={t:"Z",v:o.toLowerCase()},u=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",zg(e)||(i[i.length]={t:"t",v:o}));break;case".":if(f!=null){for(o=l;++s<e.length&&(l=e.charAt(s))==="0";)o+=l;i[i.length]={t:"s",v:o};break}case"0":case"#":for(o=l;++s<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(s))>-1;)o+=l;i[i.length]={t:"n",v:o};break;case"?":for(o=l;e.charAt(++s)===l;)o+=l;i[i.length]={t:l,v:o},u=l;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":i[i.length]={t:r===1?"t":l,v:l},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=l;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)o+=e.charAt(s);i[i.length]={t:"D",v:o};break;case" ":i[i.length]={t:l,v:l},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"t",v:l},++s;break}var T=0,_=0,x;for(s=i.length-1,u="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=p,u="h",T<1&&(T=1);break;case"s":(x=i[s].v.match(/\.0+$/))&&(_=Math.max(_,x[0].length-1)),T<3&&(T=3);case"d":case"y":case"M":case"e":u=i[s].t;break;case"m":u==="s"&&(i[s].t="M",T<2&&(T=2));break;case"X":break;case"Z":T<1&&i[s].v.match(/[Hh]/)&&(T=1),T<2&&i[s].v.match(/[Mm]/)&&(T=2),T<3&&i[s].v.match(/[Ss]/)&&(T=3)}switch(T){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var y="",C;for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=Jy(i[s].t.charCodeAt(0),i[s].v,f,_),i[s].t="t";break;case"n":case"?":for(C=s+1;i[C]!=null&&((l=i[C].t)==="?"||l==="D"||(l===" "||l==="t")&&i[C+1]!=null&&(i[C+1].t==="?"||i[C+1].t==="t"&&i[C+1].v==="/")||i[s].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(i[C].v==="/"||i[C].v===" "&&i[C+1]!=null&&i[C+1].t=="?"));)i[s].v+=i[C].v,i[C]={v:"",t:";"},++C;y+=i[s].v,s=C-1;break;case"G":i[s].t="t",i[s].v=of(t,n);break}var k="",M,R;if(y.length>0){y.charCodeAt(0)==40?(M=t<0&&y.charCodeAt(0)===45?-t:t,R=Jn("n",y,M)):(M=t<0&&r>1?-t:t,R=Jn("n",y,M),M<0&&i[0]&&i[0].t=="t"&&(R=R.substr(1),i[0].v="-"+i[0].v)),C=R.length-1;var D=i.length;for(s=0;s<i.length;++s)if(i[s]!=null&&i[s].t!="t"&&i[s].v.indexOf(".")>-1){D=s;break}var F=i.length;if(D===i.length&&R.indexOf("E")===-1){for(s=i.length-1;s>=0;--s)i[s]==null||"n?".indexOf(i[s].t)===-1||(C>=i[s].v.length-1?(C-=i[s].v.length,i[s].v=R.substr(C+1,i[s].v.length)):C<0?i[s].v="":(i[s].v=R.substr(0,C+1),C=-1),i[s].t="t",F=s);C>=0&&F<i.length&&(i[F].v=R.substr(0,C+1)+i[F].v)}else if(D!==i.length&&R.indexOf("E")===-1){for(C=R.indexOf(".")-1,s=D;s>=0;--s)if(!(i[s]==null||"n?".indexOf(i[s].t)===-1)){for(d=i[s].v.indexOf(".")>-1&&s===D?i[s].v.indexOf(".")-1:i[s].v.length-1,k=i[s].v.substr(d+1);d>=0;--d)C>=0&&(i[s].v.charAt(d)==="0"||i[s].v.charAt(d)==="#")&&(k=R.charAt(C--)+k);i[s].v=k,i[s].t="t",F=s}for(C>=0&&F<i.length&&(i[F].v=R.substr(0,C+1)+i[F].v),C=R.indexOf(".")+1,s=D;s<i.length;++s)if(!(i[s]==null||"n?(".indexOf(i[s].t)===-1&&s!==D)){for(d=i[s].v.indexOf(".")>-1&&s===D?i[s].v.indexOf(".")+1:0,k=i[s].v.substr(0,d);d<i[s].v.length;++d)C<R.length&&(k+=R.charAt(C++));i[s].v=k,i[s].t="t",F=s}}}for(s=0;s<i.length;++s)i[s]!=null&&"n?".indexOf(i[s].t)>-1&&(M=r>1&&t<0&&s>0&&i[s-1].v==="-"?-t:t,i[s].v=Jn(i[s].t,i[s].v,M),i[s].t="t");var U="";for(s=0;s!==i.length;++s)i[s]!=null&&(U+=i[s].v);return U}var hd=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function pd(e,t){if(t==null)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0;break}return!1}function rT(e,t){var n=tT(e),r=n.length,i=n[r-1].indexOf("@");if(r<4&&i>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof t!="number")return[4,n.length===4||i>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=i>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=i>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=i>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var o=t>0?n[0]:t<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,o];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var s=n[0].match(hd),l=n[1].match(hd);return pd(t,s)?[r,n[0]]:pd(t,l)?[r,n[1]]:[r,n[s!=null&&l!=null?2:1]]}return[r,o]}function Ar(e,t,n){n==null&&(n={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&n.dateNF?r=n.dateNF:r=e;break;case"number":e==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:Qe)[e],r==null&&(r=n.table&&n.table[fd[e]]||Qe[fd[e]]),r==null&&(r=By[e]||"General");break}if(Ll(r,0))return of(t,n);t instanceof Date&&(t=Dg(t,n.date1904));var i=rT(r,t);if(Ll(i[1]))return of(t,n);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return nT(i[1],t,n,i[0])}function qg(e,t){if(typeof t!="number"){t=+t||-1;for(var n=0;n<392;++n){if(Qe[n]==null){t<0&&(t=n);continue}if(Qe[n]==e){t=n;break}}t<0&&(t=391)}return Qe[t]=e,t}function pa(e){for(var t=0;t!=392;++t)e[t]!==void 0&&qg(e[t],t)}function ma(){Qe=Uy()}var $g=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function iT(e){var t=typeof e=="number"?Qe[e]:e;return t=t.replace($g,"(\\d+)"),new RegExp("^"+t+"$")}function oT(e,t,n){var r=-1,i=-1,o=-1,s=-1,l=-1,u=-1;(t.match($g)||[]).forEach(function(h,p){var m=parseInt(n[p+1],10);switch(h.toLowerCase().charAt(0)){case"y":r=m;break;case"d":o=m;break;case"h":s=m;break;case"s":u=m;break;case"m":s>=0?l=m:i=m;break}}),u>=0&&l==-1&&i>=0&&(l=i,i=-1);var f=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var d=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return s==-1&&l==-1&&u==-1?f:r==-1&&i==-1&&o==-1?d:f+"T"+d}var sT=function(){var e={};e.version="1.2.0";function t(){for(var R=0,D=new Array(256),F=0;F!=256;++F)R=F,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,D[F]=R;return typeof Int32Array<"u"?new Int32Array(D):D}var n=t();function r(R){var D=0,F=0,U=0,q=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)q[U]=R[U];for(U=0;U!=256;++U)for(F=R[U],D=256+U;D<4096;D+=256)F=q[D]=F>>>8^R[F&255];var K=[];for(U=1;U!=16;++U)K[U-1]=typeof Int32Array<"u"?q.subarray(U*256,U*256+256):q.slice(U*256,U*256+256);return K}var i=r(n),o=i[0],s=i[1],l=i[2],u=i[3],f=i[4],d=i[5],h=i[6],p=i[7],m=i[8],v=i[9],g=i[10],T=i[11],_=i[12],x=i[13],y=i[14];function C(R,D){for(var F=D^-1,U=0,q=R.length;U<q;)F=F>>>8^n[(F^R.charCodeAt(U++))&255];return~F}function k(R,D){for(var F=D^-1,U=R.length-15,q=0;q<U;)F=y[R[q++]^F&255]^x[R[q++]^F>>8&255]^_[R[q++]^F>>16&255]^T[R[q++]^F>>>24]^g[R[q++]]^v[R[q++]]^m[R[q++]]^p[R[q++]]^h[R[q++]]^d[R[q++]]^f[R[q++]]^u[R[q++]]^l[R[q++]]^s[R[q++]]^o[R[q++]]^n[R[q++]];for(U+=15;q<U;)F=F>>>8^n[(F^R[q++])&255];return~F}function M(R,D){for(var F=D^-1,U=0,q=R.length,K=0,ee=0;U<q;)K=R.charCodeAt(U++),K<128?F=F>>>8^n[(F^K)&255]:K<2048?(F=F>>>8^n[(F^(192|K>>6&31))&255],F=F>>>8^n[(F^(128|K&63))&255]):K>=55296&&K<57344?(K=(K&1023)+64,ee=R.charCodeAt(U++)&1023,F=F>>>8^n[(F^(240|K>>8&7))&255],F=F>>>8^n[(F^(128|K>>2&63))&255],F=F>>>8^n[(F^(128|ee>>6&15|(K&3)<<4))&255],F=F>>>8^n[(F^(128|ee&63))&255]):(F=F>>>8^n[(F^(224|K>>12&15))&255],F=F>>>8^n[(F^(128|K>>6&63))&255],F=F>>>8^n[(F^(128|K&63))&255]);return~F}return e.table=n,e.bstr=C,e.buf=k,e.str=M,e}(),Le=function(){var t={};t.version="1.2.1";function n(E,A){for(var S=E.split("/"),w=A.split("/"),I=0,N=0,G=Math.min(S.length,w.length);I<G;++I){if(N=S[I].length-w[I].length)return N;if(S[I]!=w[I])return S[I]<w[I]?-1:1}return S.length-w.length}function r(E){if(E.charAt(E.length-1)=="/")return E.slice(0,-1).indexOf("/")===-1?E:r(E.slice(0,-1));var A=E.lastIndexOf("/");return A===-1?E:E.slice(0,A+1)}function i(E){if(E.charAt(E.length-1)=="/")return i(E.slice(0,-1));var A=E.lastIndexOf("/");return A===-1?E:E.slice(A+1)}function o(E,A){typeof A=="string"&&(A=new Date(A));var S=A.getHours();S=S<<6|A.getMinutes(),S=S<<5|A.getSeconds()>>>1,E.write_shift(2,S);var w=A.getFullYear()-1980;w=w<<4|A.getMonth()+1,w=w<<5|A.getDate(),E.write_shift(2,w)}function s(E){var A=E.read_shift(2)&65535,S=E.read_shift(2)&65535,w=new Date,I=S&31;S>>>=5;var N=S&15;S>>>=4,w.setMilliseconds(0),w.setFullYear(S+1980),w.setMonth(N-1),w.setDate(I);var G=A&31;A>>>=5;var Y=A&63;return A>>>=6,w.setHours(A),w.setMinutes(Y),w.setSeconds(G<<1),w}function l(E){Xt(E,0);for(var A={},S=0;E.l<=E.length-4;){var w=E.read_shift(2),I=E.read_shift(2),N=E.l+I,G={};switch(w){case 21589:S=E.read_shift(1),S&1&&(G.mtime=E.read_shift(4)),I>5&&(S&2&&(G.atime=E.read_shift(4)),S&4&&(G.ctime=E.read_shift(4))),G.mtime&&(G.mt=new Date(G.mtime*1e3));break}E.l=N,A[w]=G}return A}var u;function f(){return u||(u={})}function d(E,A){if(E[0]==80&&E[1]==75)return bc(E,A);if((E[0]|32)==109&&(E[1]|32)==105)return bv(E,A);if(E.length<512)throw new Error("CFB file size "+E.length+" < 512");var S=3,w=512,I=0,N=0,G=0,Y=0,V=0,H=[],z=E.slice(0,512);Xt(z,0);var Q=h(z);switch(S=Q[0],S){case 3:w=512;break;case 4:w=4096;break;case 0:if(Q[1]==0)return bc(E,A);default:throw new Error("Major Version: Expected 3 or 4 saw "+S)}w!==512&&(z=E.slice(0,w),Xt(z,28));var re=E.slice(0,w);p(z,S);var ae=z.read_shift(4,"i");if(S===3&&ae!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ae);z.l+=4,G=z.read_shift(4,"i"),z.l+=4,z.chk("00100000","Mini Stream Cutoff Size: "),Y=z.read_shift(4,"i"),I=z.read_shift(4,"i"),V=z.read_shift(4,"i"),N=z.read_shift(4,"i");for(var j=-1,le=0;le<109&&(j=z.read_shift(4,"i"),!(j<0));++le)H[le]=j;var ve=m(E,w);T(V,N,ve,w,H);var ze=x(ve,G,H,w);ze[G].name="!Directory",I>0&&Y!==ee&&(ze[Y].name="!MiniFAT"),ze[H[0]].name="!FAT",ze.fat_addrs=H,ze.ssz=w;var qe={},Et=[],oo=[],so=[];y(G,ze,ve,Et,I,qe,oo,Y),v(oo,so,Et),Et.shift();var lo={FileIndex:oo,FullPaths:so};return A&&A.raw&&(lo.raw={header:re,sectors:ve}),lo}function h(E){if(E[E.l]==80&&E[E.l+1]==75)return[0,0];E.chk(Te,"Header Signature: "),E.l+=16;var A=E.read_shift(2,"u");return[E.read_shift(2,"u"),A]}function p(E,A){var S=9;switch(E.l+=2,S=E.read_shift(2)){case 9:if(A!=3)throw new Error("Sector Shift: Expected 9 saw "+S);break;case 12:if(A!=4)throw new Error("Sector Shift: Expected 12 saw "+S);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+S)}E.chk("0600","Mini Sector Shift: "),E.chk("000000000000","Reserved: ")}function m(E,A){for(var S=Math.ceil(E.length/A)-1,w=[],I=1;I<S;++I)w[I-1]=E.slice(I*A,(I+1)*A);return w[S-1]=E.slice(S*A),w}function v(E,A,S){for(var w=0,I=0,N=0,G=0,Y=0,V=S.length,H=[],z=[];w<V;++w)H[w]=z[w]=w,A[w]=S[w];for(;Y<z.length;++Y)w=z[Y],I=E[w].L,N=E[w].R,G=E[w].C,H[w]===w&&(I!==-1&&H[I]!==I&&(H[w]=H[I]),N!==-1&&H[N]!==N&&(H[w]=H[N])),G!==-1&&(H[G]=w),I!==-1&&w!=H[w]&&(H[I]=H[w],z.lastIndexOf(I)<Y&&z.push(I)),N!==-1&&w!=H[w]&&(H[N]=H[w],z.lastIndexOf(N)<Y&&z.push(N));for(w=1;w<V;++w)H[w]===w&&(N!==-1&&H[N]!==N?H[w]=H[N]:I!==-1&&H[I]!==I&&(H[w]=H[I]));for(w=1;w<V;++w)if(E[w].type!==0){if(Y=w,Y!=H[Y])do Y=H[Y],A[w]=A[Y]+"/"+A[w];while(Y!==0&&H[Y]!==-1&&Y!=H[Y]);H[w]=-1}for(A[0]+="/",w=1;w<V;++w)E[w].type!==2&&(A[w]+="/")}function g(E,A,S){for(var w=E.start,I=E.size,N=[],G=w;S&&I>0&&G>=0;)N.push(A.slice(G*K,G*K+K)),I-=K,G=Vr(S,G*4);return N.length===0?J(0):gt(N).slice(0,E.size)}function T(E,A,S,w,I){var N=ee;if(E===ee){if(A!==0)throw new Error("DIFAT chain shorter than expected")}else if(E!==-1){var G=S[E],Y=(w>>>2)-1;if(!G)return;for(var V=0;V<Y&&(N=Vr(G,V*4))!==ee;++V)I.push(N);T(Vr(G,w-4),A-1,S,w,I)}}function _(E,A,S,w,I){var N=[],G=[];I||(I=[]);var Y=w-1,V=0,H=0;for(V=A;V>=0;){I[V]=!0,N[N.length]=V,G.push(E[V]);var z=S[Math.floor(V*4/w)];if(H=V*4&Y,w<4+H)throw new Error("FAT boundary crossed: "+V+" 4 "+w);if(!E[z])break;V=Vr(E[z],H)}return{nodes:N,data:Ed([G])}}function x(E,A,S,w){var I=E.length,N=[],G=[],Y=[],V=[],H=w-1,z=0,Q=0,re=0,ae=0;for(z=0;z<I;++z)if(Y=[],re=z+A,re>=I&&(re-=I),!G[re]){V=[];var j=[];for(Q=re;Q>=0;){j[Q]=!0,G[Q]=!0,Y[Y.length]=Q,V.push(E[Q]);var le=S[Math.floor(Q*4/w)];if(ae=Q*4&H,w<4+ae)throw new Error("FAT boundary crossed: "+Q+" 4 "+w);if(!E[le]||(Q=Vr(E[le],ae),j[Q]))break}N[re]={nodes:Y,data:Ed([V])}}return N}function y(E,A,S,w,I,N,G,Y){for(var V=0,H=w.length?2:0,z=A[E].data,Q=0,re=0,ae;Q<z.length;Q+=128){var j=z.slice(Q,Q+128);Xt(j,64),re=j.read_shift(2),ae=xc(j,0,re-H),w.push(ae);var le={name:ae,type:j.read_shift(1),color:j.read_shift(1),L:j.read_shift(4,"i"),R:j.read_shift(4,"i"),C:j.read_shift(4,"i"),clsid:j.read_shift(16),state:j.read_shift(4,"i"),start:0,size:0},ve=j.read_shift(2)+j.read_shift(2)+j.read_shift(2)+j.read_shift(2);ve!==0&&(le.ct=C(j,j.l-8));var ze=j.read_shift(2)+j.read_shift(2)+j.read_shift(2)+j.read_shift(2);ze!==0&&(le.mt=C(j,j.l-8)),le.start=j.read_shift(4,"i"),le.size=j.read_shift(4,"i"),le.size<0&&le.start<0&&(le.size=le.type=0,le.start=ee,le.name=""),le.type===5?(V=le.start,I>0&&V!==ee&&(A[V].name="!StreamData")):le.size>=4096?(le.storage="fat",A[le.start]===void 0&&(A[le.start]=_(S,le.start,A.fat_addrs,A.ssz)),A[le.start].name=le.name,le.content=A[le.start].data.slice(0,le.size)):(le.storage="minifat",le.size<0?le.size=0:V!==ee&&le.start!==ee&&A[V]&&(le.content=g(le,A[V].data,(A[Y]||{}).data))),le.content&&Xt(le.content,0),N[ae]=le,G.push(le)}}function C(E,A){return new Date((Qt(E,A+4)/1e7*Math.pow(2,32)+Qt(E,A)/1e7-11644473600)*1e3)}function k(E,A){return f(),d(u.readFileSync(E),A)}function M(E,A){var S=A&&A.type;switch(S||Ie&&Buffer.isBuffer(E)&&(S="buffer"),S||"base64"){case"file":return k(E,A);case"base64":return d(En(jn(E)),A);case"binary":return d(En(E),A)}return d(E,A)}function R(E,A){var S=A||{},w=S.root||"Root Entry";if(E.FullPaths||(E.FullPaths=[]),E.FileIndex||(E.FileIndex=[]),E.FullPaths.length!==E.FileIndex.length)throw new Error("inconsistent CFB structure");E.FullPaths.length===0&&(E.FullPaths[0]=w+"/",E.FileIndex[0]={name:w,type:5}),S.CLSID&&(E.FileIndex[0].clsid=S.CLSID),D(E)}function D(E){var A="Sh33tJ5";if(!Le.find(E,"/"+A)){var S=J(4);S[0]=55,S[1]=S[3]=50,S[2]=54,E.FileIndex.push({name:A,type:2,content:S,size:4,L:69,R:69,C:69}),E.FullPaths.push(E.FullPaths[0]+A),F(E)}}function F(E,A){R(E);for(var S=!1,w=!1,I=E.FullPaths.length-1;I>=0;--I){var N=E.FileIndex[I];switch(N.type){case 0:w?S=!0:(E.FileIndex.pop(),E.FullPaths.pop());break;case 1:case 2:case 5:w=!0,isNaN(N.R*N.L*N.C)&&(S=!0),N.R>-1&&N.L>-1&&N.R==N.L&&(S=!0);break;default:S=!0;break}}if(!(!S&&!A)){var G=new Date(1987,1,19),Y=0,V=Object.create?Object.create(null):{},H=[];for(I=0;I<E.FullPaths.length;++I)V[E.FullPaths[I]]=!0,E.FileIndex[I].type!==0&&H.push([E.FullPaths[I],E.FileIndex[I]]);for(I=0;I<H.length;++I){var z=r(H[I][0]);w=V[z],w||(H.push([z,{name:i(z).replace("/",""),type:1,clsid:Ae,ct:G,mt:G,content:null}]),V[z]=!0)}for(H.sort(function(ae,j){return n(ae[0],j[0])}),E.FullPaths=[],E.FileIndex=[],I=0;I<H.length;++I)E.FullPaths[I]=H[I][0],E.FileIndex[I]=H[I][1];for(I=0;I<H.length;++I){var Q=E.FileIndex[I],re=E.FullPaths[I];if(Q.name=i(re).replace("/",""),Q.L=Q.R=Q.C=-(Q.color=1),Q.size=Q.content?Q.content.length:0,Q.start=0,Q.clsid=Q.clsid||Ae,I===0)Q.C=H.length>1?1:-1,Q.size=0,Q.type=5;else if(re.slice(-1)=="/"){for(Y=I+1;Y<H.length&&r(E.FullPaths[Y])!=re;++Y);for(Q.C=Y>=H.length?-1:Y,Y=I+1;Y<H.length&&r(E.FullPaths[Y])!=r(re);++Y);Q.R=Y>=H.length?-1:Y,Q.type=1}else r(E.FullPaths[I+1]||"")==r(re)&&(Q.R=I+1),Q.type=2}}}function U(E,A){var S=A||{};if(S.fileType=="mad")return Qv(E,S);switch(F(E),S.fileType){case"zip":return qv(E,S)}var w=function(ae){for(var j=0,le=0,ve=0;ve<ae.FileIndex.length;++ve){var ze=ae.FileIndex[ve];if(ze.content){var qe=ze.content.length;qe>0&&(qe<4096?j+=qe+63>>6:le+=qe+511>>9)}}for(var Et=ae.FullPaths.length+3>>2,oo=j+7>>3,so=j+127>>7,lo=oo+le+Et+so,Or=lo+127>>7,Na=Or<=109?0:Math.ceil((Or-109)/127);lo+Or+Na+127>>7>Or;)Na=++Or<=109?0:Math.ceil((Or-109)/127);var Gn=[1,Na,Or,so,Et,le,j,0];return ae.FileIndex[0].size=j<<6,Gn[7]=(ae.FileIndex[0].start=Gn[0]+Gn[1]+Gn[2]+Gn[3]+Gn[4]+Gn[5])+(Gn[6]+7>>3),Gn}(E),I=J(w[7]<<9),N=0,G=0;{for(N=0;N<8;++N)I.write_shift(1,ge[N]);for(N=0;N<8;++N)I.write_shift(2,0);for(I.write_shift(2,62),I.write_shift(2,3),I.write_shift(2,65534),I.write_shift(2,9),I.write_shift(2,6),N=0;N<3;++N)I.write_shift(2,0);for(I.write_shift(4,0),I.write_shift(4,w[2]),I.write_shift(4,w[0]+w[1]+w[2]+w[3]-1),I.write_shift(4,0),I.write_shift(4,4096),I.write_shift(4,w[3]?w[0]+w[1]+w[2]-1:ee),I.write_shift(4,w[3]),I.write_shift(-4,w[1]?w[0]-1:ee),I.write_shift(4,w[1]),N=0;N<109;++N)I.write_shift(-4,N<w[2]?w[1]+N:-1)}if(w[1])for(G=0;G<w[1];++G){for(;N<236+G*127;++N)I.write_shift(-4,N<w[2]?w[1]+N:-1);I.write_shift(-4,G===w[1]-1?ee:G+1)}var Y=function(ae){for(G+=ae;N<G-1;++N)I.write_shift(-4,N+1);ae&&(++N,I.write_shift(-4,ee))};for(G=N=0,G+=w[1];N<G;++N)I.write_shift(-4,Ne.DIFSECT);for(G+=w[2];N<G;++N)I.write_shift(-4,Ne.FATSECT);Y(w[3]),Y(w[4]);for(var V=0,H=0,z=E.FileIndex[0];V<E.FileIndex.length;++V)z=E.FileIndex[V],z.content&&(H=z.content.length,!(H<4096)&&(z.start=G,Y(H+511>>9)));for(Y(w[6]+7>>3);I.l&511;)I.write_shift(-4,Ne.ENDOFCHAIN);for(G=N=0,V=0;V<E.FileIndex.length;++V)z=E.FileIndex[V],z.content&&(H=z.content.length,!(!H||H>=4096)&&(z.start=G,Y(H+63>>6)));for(;I.l&511;)I.write_shift(-4,Ne.ENDOFCHAIN);for(N=0;N<w[4]<<2;++N){var Q=E.FullPaths[N];if(!Q||Q.length===0){for(V=0;V<17;++V)I.write_shift(4,0);for(V=0;V<3;++V)I.write_shift(4,-1);for(V=0;V<12;++V)I.write_shift(4,0);continue}z=E.FileIndex[N],N===0&&(z.start=z.size?z.start-1:ee);var re=N===0&&S.root||z.name;if(H=2*(re.length+1),I.write_shift(64,re,"utf16le"),I.write_shift(2,H),I.write_shift(1,z.type),I.write_shift(1,z.color),I.write_shift(-4,z.L),I.write_shift(-4,z.R),I.write_shift(-4,z.C),z.clsid)I.write_shift(16,z.clsid,"hex");else for(V=0;V<4;++V)I.write_shift(4,0);I.write_shift(4,z.state||0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,0),I.write_shift(4,z.start),I.write_shift(4,z.size),I.write_shift(4,0)}for(N=1;N<E.FileIndex.length;++N)if(z=E.FileIndex[N],z.size>=4096)if(I.l=z.start+1<<9,Ie&&Buffer.isBuffer(z.content))z.content.copy(I,I.l,0,z.size),I.l+=z.size+511&-512;else{for(V=0;V<z.size;++V)I.write_shift(1,z.content[V]);for(;V&511;++V)I.write_shift(1,0)}for(N=1;N<E.FileIndex.length;++N)if(z=E.FileIndex[N],z.size>0&&z.size<4096)if(Ie&&Buffer.isBuffer(z.content))z.content.copy(I,I.l,0,z.size),I.l+=z.size+63&-64;else{for(V=0;V<z.size;++V)I.write_shift(1,z.content[V]);for(;V&63;++V)I.write_shift(1,0)}if(Ie)I.l=I.length;else for(;I.l<I.length;)I.write_shift(1,0);return I}function q(E,A){var S=E.FullPaths.map(function(V){return V.toUpperCase()}),w=S.map(function(V){var H=V.split("/");return H[H.length-(V.slice(-1)=="/"?2:1)]}),I=!1;A.charCodeAt(0)===47?(I=!0,A=S[0].slice(0,-1)+A):I=A.indexOf("/")!==-1;var N=A.toUpperCase(),G=I===!0?S.indexOf(N):w.indexOf(N);if(G!==-1)return E.FileIndex[G];var Y=!N.match(Hs);for(N=N.replace(Mo,""),Y&&(N=N.replace(Hs,"!")),G=0;G<S.length;++G)if((Y?S[G].replace(Hs,"!"):S[G]).replace(Mo,"")==N||(Y?w[G].replace(Hs,"!"):w[G]).replace(Mo,"")==N)return E.FileIndex[G];return null}var K=64,ee=-2,Te="d0cf11e0a1b11ae1",ge=[208,207,17,224,161,177,26,225],Ae="00000000000000000000000000000000",Ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ee,FREESECT:-1,HEADER_SIGNATURE:Te,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ie(E,A,S){f();var w=U(E,S);u.writeFileSync(A,w)}function he(E){for(var A=new Array(E.length),S=0;S<E.length;++S)A[S]=String.fromCharCode(E[S]);return A.join("")}function me(E,A){var S=U(E,A);switch(A&&A.type||"buffer"){case"file":return f(),u.writeFileSync(A.filename,S),S;case"binary":return typeof S=="string"?S:he(S);case"base64":return is(typeof S=="string"?S:he(S));case"buffer":if(Ie)return Buffer.isBuffer(S)?S:rr(S);case"array":return typeof S=="string"?En(S):S}return S}var ye;function P(E){try{var A=E.InflateRaw,S=new A;if(S._processChunk(new Uint8Array([3,0]),S._finishFlushFlag),S.bytesRead)ye=E;else throw new Error("zlib does not expose bytesRead")}catch(w){console.error("cannot use native zlib: "+(w.message||w))}}function W(E,A){if(!ye)return Kc(E,A);var S=ye.InflateRaw,w=new S,I=w._processChunk(E.slice(E.l),w._finishFlushFlag);return E.l+=w.bytesRead,I}function O(E){return ye?ye.deflateRawSync(E):Wc(E)}var L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function pe(E){var A=(E<<1|E<<11)&139536|(E<<5|E<<15)&558144;return(A>>16|A>>8|A)&255}for(var de=typeof Uint8Array<"u",oe=de?new Uint8Array(256):[],Oe=0;Oe<256;++Oe)oe[Oe]=pe(Oe);function Ee(E,A){var S=oe[E&255];return A<=8?S>>>8-A:(S=S<<8|oe[E>>8&255],A<=16?S>>>16-A:(S=S<<8|oe[E>>16&255],S>>>24-A))}function Pt(E,A){var S=A&7,w=A>>>3;return(E[w]|(S<=6?0:E[w+1]<<8))>>>S&3}function Re(E,A){var S=A&7,w=A>>>3;return(E[w]|(S<=5?0:E[w+1]<<8))>>>S&7}function Bn(E,A){var S=A&7,w=A>>>3;return(E[w]|(S<=4?0:E[w+1]<<8))>>>S&15}function Ke(E,A){var S=A&7,w=A>>>3;return(E[w]|(S<=3?0:E[w+1]<<8))>>>S&31}function ce(E,A){var S=A&7,w=A>>>3;return(E[w]|(S<=1?0:E[w+1]<<8))>>>S&127}function on(E,A,S){var w=A&7,I=A>>>3,N=(1<<S)-1,G=E[I]>>>w;return S<8-w||(G|=E[I+1]<<8-w,S<16-w)||(G|=E[I+2]<<16-w,S<24-w)||(G|=E[I+3]<<24-w),G&N}function Vn(E,A,S){var w=A&7,I=A>>>3;return w<=5?E[I]|=(S&7)<<w:(E[I]|=S<<w&255,E[I+1]=(S&7)>>8-w),A+3}function Dr(E,A,S){var w=A&7,I=A>>>3;return S=(S&1)<<w,E[I]|=S,A+1}function ai(E,A,S){var w=A&7,I=A>>>3;return S<<=w,E[I]|=S&255,S>>>=8,E[I+1]=S,A+8}function Hc(E,A,S){var w=A&7,I=A>>>3;return S<<=w,E[I]|=S&255,S>>>=8,E[I+1]=S&255,E[I+2]=S>>>8,A+16}function Ca(E,A){var S=E.length,w=2*S>A?2*S:A+5,I=0;if(S>=A)return E;if(Ie){var N=ld(w);if(E.copy)E.copy(N);else for(;I<E.length;++I)N[I]=E[I];return N}else if(de){var G=new Uint8Array(w);if(G.set)G.set(E);else for(;I<S;++I)G[I]=E[I];return G}return E.length=w,E}function Nn(E){for(var A=new Array(E),S=0;S<E;++S)A[S]=0;return A}function Ts(E,A,S){var w=1,I=0,N=0,G=0,Y=0,V=E.length,H=de?new Uint16Array(32):Nn(32);for(N=0;N<32;++N)H[N]=0;for(N=V;N<S;++N)E[N]=0;V=E.length;var z=de?new Uint16Array(V):Nn(V);for(N=0;N<V;++N)H[I=E[N]]++,w<I&&(w=I),z[N]=0;for(H[0]=0,N=1;N<=w;++N)H[N+16]=Y=Y+H[N-1]<<1;for(N=0;N<V;++N)Y=E[N],Y!=0&&(z[N]=H[Y+16]++);var Q=0;for(N=0;N<V;++N)if(Q=E[N],Q!=0)for(Y=Ee(z[N],w)>>w-Q,G=(1<<w+4-Q)-1;G>=0;--G)A[Y|G<<Q]=Q&15|N<<4;return w}var Aa=de?new Uint16Array(512):Nn(512),Ia=de?new Uint16Array(32):Nn(32);if(!de){for(var Lr=0;Lr<512;++Lr)Aa[Lr]=0;for(Lr=0;Lr<32;++Lr)Ia[Lr]=0}(function(){for(var E=[],A=0;A<32;A++)E.push(5);Ts(E,Ia,32);var S=[];for(A=0;A<=143;A++)S.push(8);for(;A<=255;A++)S.push(9);for(;A<=279;A++)S.push(7);for(;A<=287;A++)S.push(8);Ts(S,Aa,288)})();var Gv=function(){for(var A=de?new Uint8Array(32768):[],S=0,w=0;S<fe.length-1;++S)for(;w<fe[S+1];++w)A[w]=S;for(;w<32768;++w)A[w]=29;var I=de?new Uint8Array(259):[];for(S=0,w=0;S<X.length-1;++S)for(;w<X[S+1];++w)I[w]=S;function N(Y,V){for(var H=0;H<Y.length;){var z=Math.min(65535,Y.length-H),Q=H+z==Y.length;for(V.write_shift(1,+Q),V.write_shift(2,z),V.write_shift(2,~z&65535);z-- >0;)V[V.l++]=Y[H++]}return V.l}function G(Y,V){for(var H=0,z=0,Q=de?new Uint16Array(32768):[];z<Y.length;){var re=Math.min(65535,Y.length-z);if(re<10){for(H=Vn(V,H,+(z+re==Y.length)),H&7&&(H+=8-(H&7)),V.l=H/8|0,V.write_shift(2,re),V.write_shift(2,~re&65535);re-- >0;)V[V.l++]=Y[z++];H=V.l*8;continue}H=Vn(V,H,+(z+re==Y.length)+2);for(var ae=0;re-- >0;){var j=Y[z];ae=(ae<<5^j)&32767;var le=-1,ve=0;if((le=Q[ae])&&(le|=z&-32768,le>z&&(le-=32768),le<z))for(;Y[le+ve]==Y[z+ve]&&ve<250;)++ve;if(ve>2){j=I[ve],j<=22?H=ai(V,H,oe[j+1]>>1)-1:(ai(V,H,3),H+=5,ai(V,H,oe[j-23]>>5),H+=3);var ze=j<8?0:j-4>>2;ze>0&&(Hc(V,H,ve-X[j]),H+=ze),j=A[z-le],H=ai(V,H,oe[j]>>3),H-=3;var qe=j<4?0:j-2>>1;qe>0&&(Hc(V,H,z-le-fe[j]),H+=qe);for(var Et=0;Et<ve;++Et)Q[ae]=z&32767,ae=(ae<<5^Y[z])&32767,++z;re-=ve-1}else j<=143?j=j+48:H=Dr(V,H,1),H=ai(V,H,oe[j]),Q[ae]=z&32767,++z}H=ai(V,H,0)-1}return V.l=(H+7)/8|0,V.l}return function(V,H){return V.length<8?N(V,H):G(V,H)}}();function Wc(E){var A=J(50+Math.floor(E.length*1.1)),S=Gv(E,A);return A.slice(0,S)}var zc=de?new Uint16Array(32768):Nn(32768),qc=de?new Uint16Array(32768):Nn(32768),$c=de?new Uint16Array(128):Nn(128),Jc=1,Yc=1;function Hv(E,A){var S=Ke(E,A)+257;A+=5;var w=Ke(E,A)+1;A+=5;var I=Bn(E,A)+4;A+=4;for(var N=0,G=de?new Uint8Array(19):Nn(19),Y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],V=1,H=de?new Uint8Array(8):Nn(8),z=de?new Uint8Array(8):Nn(8),Q=G.length,re=0;re<I;++re)G[L[re]]=N=Re(E,A),V<N&&(V=N),H[N]++,A+=3;var ae=0;for(H[0]=0,re=1;re<=V;++re)z[re]=ae=ae+H[re-1]<<1;for(re=0;re<Q;++re)(ae=G[re])!=0&&(Y[re]=z[ae]++);var j=0;for(re=0;re<Q;++re)if(j=G[re],j!=0){ae=oe[Y[re]]>>8-j;for(var le=(1<<7-j)-1;le>=0;--le)$c[ae|le<<j]=j&7|re<<3}var ve=[];for(V=1;ve.length<S+w;)switch(ae=$c[ce(E,A)],A+=ae&7,ae>>>=3){case 16:for(N=3+Pt(E,A),A+=2,ae=ve[ve.length-1];N-- >0;)ve.push(ae);break;case 17:for(N=3+Re(E,A),A+=3;N-- >0;)ve.push(0);break;case 18:for(N=11+ce(E,A),A+=7;N-- >0;)ve.push(0);break;default:ve.push(ae),V<ae&&(V=ae);break}var ze=ve.slice(0,S),qe=ve.slice(S);for(re=S;re<286;++re)ze[re]=0;for(re=w;re<30;++re)qe[re]=0;return Jc=Ts(ze,zc,286),Yc=Ts(qe,qc,30),A}function Wv(E,A){if(E[0]==3&&!(E[1]&3))return[Qr(A),2];for(var S=0,w=0,I=ld(A||1<<18),N=0,G=I.length>>>0,Y=0,V=0;!(w&1);){if(w=Re(E,S),S+=3,w>>>1)w>>1==1?(Y=9,V=5):(S=Hv(E,S),Y=Jc,V=Yc);else{S&7&&(S+=8-(S&7));var H=E[S>>>3]|E[(S>>>3)+1]<<8;if(S+=32,H>0)for(!A&&G<N+H&&(I=Ca(I,N+H),G=I.length);H-- >0;)I[N++]=E[S>>>3],S+=8;continue}for(;;){!A&&G<N+32767&&(I=Ca(I,N+32767),G=I.length);var z=on(E,S,Y),Q=w>>>1==1?Aa[z]:zc[z];if(S+=Q&15,Q>>>=4,!(Q>>>8&255))I[N++]=Q;else{if(Q==256)break;Q-=257;var re=Q<8?0:Q-4>>2;re>5&&(re=0);var ae=N+X[Q];re>0&&(ae+=on(E,S,re),S+=re),z=on(E,S,V),Q=w>>>1==1?Ia[z]:qc[z],S+=Q&15,Q>>>=4;var j=Q<4?0:Q-2>>1,le=fe[Q];for(j>0&&(le+=on(E,S,j),S+=j),!A&&G<ae&&(I=Ca(I,ae+100),G=I.length);N<ae;)I[N]=I[N-le],++N}}}return A?[I,S+7>>>3]:[I.slice(0,N),S+7>>>3]}function Kc(E,A){var S=E.slice(E.l||0),w=Wv(S,A);return E.l+=w[1],w[0]}function Xc(E,A){if(E)typeof console<"u"&&console.error(A);else throw new Error(A)}function bc(E,A){var S=E;Xt(S,0);var w=[],I=[],N={FileIndex:w,FullPaths:I};R(N,{root:A.root});for(var G=S.length-4;(S[G]!=80||S[G+1]!=75||S[G+2]!=5||S[G+3]!=6)&&G>=0;)--G;S.l=G+4,S.l+=4;var Y=S.read_shift(2);S.l+=6;var V=S.read_shift(4);for(S.l=V,G=0;G<Y;++G){S.l+=20;var H=S.read_shift(4),z=S.read_shift(4),Q=S.read_shift(2),re=S.read_shift(2),ae=S.read_shift(2);S.l+=8;var j=S.read_shift(4),le=l(S.slice(S.l+Q,S.l+Q+re));S.l+=Q+re+ae;var ve=S.l;S.l=j+4,zv(S,H,z,N,le),S.l=ve}return N}function zv(E,A,S,w,I){E.l+=2;var N=E.read_shift(2),G=E.read_shift(2),Y=s(E);if(N&8257)throw new Error("Unsupported ZIP encryption");for(var V=E.read_shift(4),H=E.read_shift(4),z=E.read_shift(4),Q=E.read_shift(2),re=E.read_shift(2),ae="",j=0;j<Q;++j)ae+=String.fromCharCode(E[E.l++]);if(re){var le=l(E.slice(E.l,E.l+re));(le[21589]||{}).mt&&(Y=le[21589].mt),((I||{})[21589]||{}).mt&&(Y=I[21589].mt)}E.l+=re;var ve=E.slice(E.l,E.l+H);switch(G){case 8:ve=W(E,z);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+G)}var ze=!1;N&8&&(V=E.read_shift(4),V==134695760&&(V=E.read_shift(4),ze=!0),H=E.read_shift(4),z=E.read_shift(4)),H!=A&&Xc(ze,"Bad compressed size: "+A+" != "+H),z!=S&&Xc(ze,"Bad uncompressed size: "+S+" != "+z),Ra(w,ae,ve,{unsafe:!0,mt:Y})}function qv(E,A){var S=A||{},w=[],I=[],N=J(1),G=S.compression?8:0,Y=0,V=0,H=0,z=0,Q=0,re=E.FullPaths[0],ae=re,j=E.FileIndex[0],le=[],ve=0;for(V=1;V<E.FullPaths.length;++V)if(ae=E.FullPaths[V].slice(re.length),j=E.FileIndex[V],!(!j.size||!j.content||ae=="Sh33tJ5")){var ze=z,qe=J(ae.length);for(H=0;H<ae.length;++H)qe.write_shift(1,ae.charCodeAt(H)&127);qe=qe.slice(0,qe.l),le[Q]=sT.buf(j.content,0);var Et=j.content;G==8&&(Et=O(Et)),N=J(30),N.write_shift(4,67324752),N.write_shift(2,20),N.write_shift(2,Y),N.write_shift(2,G),j.mt?o(N,j.mt):N.write_shift(4,0),N.write_shift(-4,le[Q]),N.write_shift(4,Et.length),N.write_shift(4,j.content.length),N.write_shift(2,qe.length),N.write_shift(2,0),z+=N.length,w.push(N),z+=qe.length,w.push(qe),z+=Et.length,w.push(Et),N=J(46),N.write_shift(4,33639248),N.write_shift(2,0),N.write_shift(2,20),N.write_shift(2,Y),N.write_shift(2,G),N.write_shift(4,0),N.write_shift(-4,le[Q]),N.write_shift(4,Et.length),N.write_shift(4,j.content.length),N.write_shift(2,qe.length),N.write_shift(2,0),N.write_shift(2,0),N.write_shift(2,0),N.write_shift(2,0),N.write_shift(4,0),N.write_shift(4,ze),ve+=N.l,I.push(N),ve+=qe.length,I.push(qe),++Q}return N=J(22),N.write_shift(4,101010256),N.write_shift(2,0),N.write_shift(2,0),N.write_shift(2,Q),N.write_shift(2,Q),N.write_shift(4,ve),N.write_shift(4,z),N.write_shift(2,0),gt([gt(w),gt(I),N])}var Es={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function $v(E,A){if(E.ctype)return E.ctype;var S=E.name||"",w=S.match(/\.([^\.]+)$/);return w&&Es[w[1]]||A&&(w=(S=A).match(/[\.\\]([^\.\\])+$/),w&&Es[w[1]])?Es[w[1]]:"application/octet-stream"}function Jv(E){for(var A=is(E),S=[],w=0;w<A.length;w+=76)S.push(A.slice(w,w+76));return S.join(`\r
`)+`\r
`}function Yv(E){var A=E.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(H){var z=H.charCodeAt(0).toString(16).toUpperCase();return"="+(z.length==1?"0"+z:z)});A=A.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),A.charAt(0)==`
`&&(A="=0D"+A.slice(1)),A=A.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var S=[],w=A.split(`\r
`),I=0;I<w.length;++I){var N=w[I];if(N.length==0){S.push("");continue}for(var G=0;G<N.length;){var Y=76,V=N.slice(G,G+Y);V.charAt(Y-1)=="="?Y--:V.charAt(Y-2)=="="?Y-=2:V.charAt(Y-3)=="="&&(Y-=3),V=N.slice(G,G+Y),G+=Y,G<N.length&&(V+="="),S.push(V)}}return S.join(`\r
`)}function Kv(E){for(var A=[],S=0;S<E.length;++S){for(var w=E[S];S<=E.length&&w.charAt(w.length-1)=="=";)w=w.slice(0,w.length-1)+E[++S];A.push(w)}for(var I=0;I<A.length;++I)A[I]=A[I].replace(/[=][0-9A-Fa-f]{2}/g,function(N){return String.fromCharCode(parseInt(N.slice(1),16))});return En(A.join(`\r
`))}function Xv(E,A,S){for(var w="",I="",N="",G,Y=0;Y<10;++Y){var V=A[Y];if(!V||V.match(/^\s*$/))break;var H=V.match(/^(.*?):\s*([^\s].*)$/);if(H)switch(H[1].toLowerCase()){case"content-location":w=H[2].trim();break;case"content-type":N=H[2].trim();break;case"content-transfer-encoding":I=H[2].trim();break}}switch(++Y,I.toLowerCase()){case"base64":G=En(jn(A.slice(Y).join("")));break;case"quoted-printable":G=Kv(A.slice(Y));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+I)}var z=Ra(E,w.slice(S.length),G,{unsafe:!0});N&&(z.ctype=N)}function bv(E,A){if(he(E.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var S=A&&A.root||"",w=(Ie&&Buffer.isBuffer(E)?E.toString("binary"):he(E)).split(`\r
`),I=0,N="";for(I=0;I<w.length;++I)if(N=w[I],!!/^Content-Location:/i.test(N)&&(N=N.slice(N.indexOf("file")),S||(S=N.slice(0,N.lastIndexOf("/")+1)),N.slice(0,S.length)!=S))for(;S.length>0&&(S=S.slice(0,S.length-1),S=S.slice(0,S.lastIndexOf("/")+1),N.slice(0,S.length)!=S););var G=(w[1]||"").match(/boundary="(.*?)"/);if(!G)throw new Error("MAD cannot find boundary");var Y="--"+(G[1]||""),V=[],H=[],z={FileIndex:V,FullPaths:H};R(z);var Q,re=0;for(I=0;I<w.length;++I){var ae=w[I];ae!==Y&&ae!==Y+"--"||(re++&&Xv(z,w.slice(Q,I),S),Q=I)}return z}function Qv(E,A){var S=A||{},w=S.boundary||"SheetJS";w="------="+w;for(var I=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+w.slice(2)+'"',"","",""],N=E.FullPaths[0],G=N,Y=E.FileIndex[0],V=1;V<E.FullPaths.length;++V)if(G=E.FullPaths[V].slice(N.length),Y=E.FileIndex[V],!(!Y.size||!Y.content||G=="Sh33tJ5")){G=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ve){return"_x"+ve.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ve){return"_u"+ve.charCodeAt(0).toString(16)+"_"});for(var H=Y.content,z=Ie&&Buffer.isBuffer(H)?H.toString("binary"):he(H),Q=0,re=Math.min(1024,z.length),ae=0,j=0;j<=re;++j)(ae=z.charCodeAt(j))>=32&&ae<128&&++Q;var le=Q>=re*4/5;I.push(w),I.push("Content-Location: "+(S.root||"file:///C:/SheetJS/")+G),I.push("Content-Transfer-Encoding: "+(le?"quoted-printable":"base64")),I.push("Content-Type: "+$v(Y,G)),I.push(""),I.push(le?Yv(z):Jv(z))}return I.push(w+`--\r
`),I.join(`\r
`)}function Zv(E){var A={};return R(A,E),A}function Ra(E,A,S,w){var I=w&&w.unsafe;I||R(E);var N=!I&&Le.find(E,A);if(!N){var G=E.FullPaths[0];A.slice(0,G.length)==G?G=A:(G.slice(-1)!="/"&&(G+="/"),G=(G+A).replace("//","/")),N={name:i(A),type:2},E.FileIndex.push(N),E.FullPaths.push(G),I||Le.utils.cfb_gc(E)}return N.content=S,N.size=S?S.length:0,w&&(w.CLSID&&(N.clsid=w.CLSID),w.mt&&(N.mt=w.mt),w.ct&&(N.ct=w.ct)),N}function jv(E,A){R(E);var S=Le.find(E,A);if(S){for(var w=0;w<E.FileIndex.length;++w)if(E.FileIndex[w]==S)return E.FileIndex.splice(w,1),E.FullPaths.splice(w,1),!0}return!1}function ex(E,A,S){R(E);var w=Le.find(E,A);if(w){for(var I=0;I<E.FileIndex.length;++I)if(E.FileIndex[I]==w)return E.FileIndex[I].name=i(S),E.FullPaths[I]=S,!0}return!1}function tx(E){F(E,!0)}return t.find=q,t.read=M,t.parse=d,t.write=me,t.writeFile=ie,t.utils={cfb_new:Zv,cfb_add:Ra,cfb_del:jv,cfb_mov:ex,cfb_gc:tx,ReadShift:Lo,CheckField:u1,prep_blob:Xt,bconcat:gt,use_zlib:P,_deflateRaw:Wc,_inflateRaw:Kc,consts:Ne},t}();function lT(e){return typeof e=="string"?ha(e):Array.isArray(e)?My(e):e}function gs(e,t,n){if(typeof Deno<"u"){if(n&&typeof t=="string")switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=ha(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r=n=="utf8"?ss(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,e);if(typeof Blob<"u"){var i=new Blob([lT(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=o,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=ms(t)),l.write(t),l.close(),t}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+e)}function Tt(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function md(e,t){for(var n=[],r=Tt(e),i=0;i!==r.length;++i)n[e[r[i]][t]]==null&&(n[e[r[i]][t]]=r[i]);return n}function pc(e){for(var t=[],n=Tt(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function ga(e){for(var t=[],n=Tt(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}function aT(e){for(var t=[],n=Tt(e),r=0;r!==n.length;++r)t[e[n[r]]]==null&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}var Ul=new Date(1899,11,30,0,0,0);function $t(e,t){var n=e.getTime(),r=Ul.getTime()+(e.getTimezoneOffset()-Ul.getTimezoneOffset())*6e4;return(n-r)/(24*60*60*1e3)}var Jg=new Date,uT=Ul.getTime()+(Jg.getTimezoneOffset()-Ul.getTimezoneOffset())*6e4,gd=Jg.getTimezoneOffset();function Yg(e){var t=new Date;return t.setTime(e*24*60*60*1e3+uT),t.getTimezoneOffset()!==gd&&t.setTime(t.getTime()+(t.getTimezoneOffset()-gd)*6e4),t}var vd=new Date("2017-02-19T19:06:09.000Z"),Kg=isNaN(vd.getFullYear())?new Date("2/19/17"):vd,fT=Kg.getFullYear()==2017;function Ot(e,t){var n=new Date(e);if(fT)return t>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):t<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(e instanceof Date)return e;if(Kg.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function va(e,t){if(Ie&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(o){return n[o]||o})}catch{}for(var r=[],i=0;i!=e.length;++i)r.push(String.fromCharCode(e[i]));return r.join("")}function Jt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=Jt(e[n]));return t}function be(e,t){for(var n="";n.length<t;)n+=e;return n}function Yn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(t=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,o){return n=-n,o}),!isNaN(t=Number(r)))?t/n:t}var cT=["january","february","march","april","may","june","july","august","september","october","november","december"];function os(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),i=t.getMonth(),o=t.getDate();if(isNaN(o))return n;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&cT.indexOf(s)==-1)return n}else if(s.match(/[a-z]/))return n;return r<0||r>8099?n:(i>0||o>1)&&r!=101?t:e.match(/[^-0-9:,\/\\]/)?n:t}function xe(e,t,n){if(e.FullPaths){if(typeof n=="string"){var r;return Ie?r=rr(n):r=Dy(n),Le.utils.cfb_add(e,t,r)}Le.utils.cfb_add(e,t,n)}else e.file(t,n)}function mc(){return Le.utils.cfb_new()}var nt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,dT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},gc=pc(dT),vc=/[&<>'"]/g,hT=/[\u0000-\u0008\u000b-\u001f]/g;function ke(e){var t=e+"";return t.replace(vc,function(n){return gc[n]}).replace(hT,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function xd(e){return ke(e).replace(/ /g,"_x0020_")}var Xg=/[\u0000-\u001f]/g;function pT(e){var t=e+"";return t.replace(vc,function(n){return gc[n]}).replace(/\n/g,"<br/>").replace(Xg,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function mT(e){var t=e+"";return t.replace(vc,function(n){return gc[n]}).replace(Xg,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}function gT(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function vT(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ru(e){for(var t="",n=0,r=0,i=0,o=0,s=0,l=0;n<e.length;){if(r=e.charCodeAt(n++),r<128){t+=String.fromCharCode(r);continue}if(i=e.charCodeAt(n++),r>191&&r<224){s=(r&31)<<6,s|=i&63,t+=String.fromCharCode(s);continue}if(o=e.charCodeAt(n++),r<240){t+=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63);continue}s=e.charCodeAt(n++),l=((r&7)<<18|(i&63)<<12|(o&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function _d(e){var t=Qr(2*e.length),n,r,i=1,o=0,s=0,l;for(r=0;r<e.length;r+=i)i=1,(l=e.charCodeAt(r))<128?n=l:l<224?(n=(l&31)*64+(e.charCodeAt(r+1)&63),i=2):l<240?(n=(l&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),i=3):(i=4,n=(l&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),n-=65536,s=55296+(n>>>10&1023),n=56320+(n&1023)),s!==0&&(t[o++]=s&255,t[o++]=s>>>8,s=0),t[o++]=n%256,t[o++]=n>>>8;return t.slice(0,o).toString("ucs2")}function yd(e){return rr(e,"binary").toString("utf8")}var zs="foo bar baz",Do=Ie&&(yd(zs)==ru(zs)&&yd||_d(zs)==ru(zs)&&_d)||ru,ss=Ie?function(e){return rr(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,i=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)))}return t.join("")},xT=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)r=r.replace(e[i][0],e[i][1]);return r}}(),bg=/(^\s|\s$|\n)/;function vt(e,t){return"<"+e+(t.match(bg)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function ls(e){return Tt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function te(e,t,n){return"<"+e+(n!=null?ls(n):"")+(t!=null?(t.match(bg)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function sf(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(n){if(t)throw n}return""}function _T(e,t){switch(typeof e){case"string":var n=te("vt:lpwstr",ke(e));return n=n.replace(/&quot;/g,"_x0022_"),n;case"number":return te((e|0)==e?"vt:i4":"vt:r8",ke(String(e)));case"boolean":return te("vt:bool",e?"true":"false")}if(e instanceof Date)return te("vt:filetime",sf(e));throw new Error("Unable to serialize "+e)}var at={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Zi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],bt={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function yT(e,t){for(var n=1-2*(e[t+7]>>>7),r=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,o=5;o>=0;--o)i=i*256+e[t+o];return r==2047?i==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),n*Math.pow(2,r-52)*i)}function TT(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,i=0,o=0,s=r?-t:t;isFinite(s)?s==0?i=o=0:(i=Math.floor(Math.log(s)/Math.LN2),o=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?i=-1022:(o-=Math.pow(2,52),i+=1023)):(i=2047,o=isNaN(t)?26985:0);for(var l=0;l<=5;++l,o/=256)e[n+l]=o&255;e[n+6]=(i&15)<<4|o&15,e[n+7]=i>>4|r}var Td=function(e){for(var t=[],n=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var i=0,o=e[0][r].length;i<o;i+=n)t.push.apply(t,e[0][r].slice(i,i+n));return t},Ed=Ie?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:rr(t)})):Td(e)}:Td,Sd=function(e,t,n){for(var r=[],i=t;i<n;i+=2)r.push(String.fromCharCode(So(e,i)));return r.join("").replace(Mo,"")},xc=Ie?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(Mo,""):Sd(e,t,n)}:Sd,wd=function(e,t,n){for(var r=[],i=t;i<t+n;++i)r.push(("0"+e[i].toString(16)).slice(-2));return r.join("")},Qg=Ie?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):wd(e,t,n)}:wd,Cd=function(e,t,n){for(var r=[],i=t;i<n;i++)r.push(String.fromCharCode(hi(e,i)));return r.join("")},vs=Ie?function(t,n,r){return Buffer.isBuffer(t)?t.toString("utf8",n,r):Cd(t,n,r)}:Cd,Zg=function(e,t){var n=Qt(e,t);return n>0?vs(e,t+4,t+4+n-1):""},jg=Zg,e1=function(e,t){var n=Qt(e,t);return n>0?vs(e,t+4,t+4+n-1):""},t1=e1,n1=function(e,t){var n=2*Qt(e,t);return n>0?vs(e,t+4,t+4+n-1):""},r1=n1,i1=function(t,n){var r=Qt(t,n);return r>0?xc(t,n+4,n+4+r):""},o1=i1,s1=function(e,t){var n=Qt(e,t);return n>0?vs(e,t+4,t+4+n):""},l1=s1,a1=function(e,t){return yT(e,t)},Bl=a1,_c=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ie&&(jg=function(t,n){if(!Buffer.isBuffer(t))return Zg(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},t1=function(t,n){if(!Buffer.isBuffer(t))return e1(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},r1=function(t,n){if(!Buffer.isBuffer(t))return n1(t,n);var r=2*t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r-1)},o1=function(t,n){if(!Buffer.isBuffer(t))return i1(t,n);var r=t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r)},l1=function(t,n){if(!Buffer.isBuffer(t))return s1(t,n);var r=t.readUInt32LE(n);return t.toString("utf8",n+4,n+4+r)},Bl=function(t,n){return Buffer.isBuffer(t)?t.readDoubleLE(n):a1(t,n)},_c=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var hi=function(e,t){return e[t]},So=function(e,t){return e[t+1]*256+e[t]},ET=function(e,t){var n=e[t+1]*256+e[t];return n<32768?n:(65535-n+1)*-1},Qt=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Vr=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},ST=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Lo(e,t){var n="",r,i,o=[],s,l,u,f;switch(t){case"dbcs":if(f=this.l,Ie&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)n+=String.fromCharCode(So(this,f)),f+=2;e*=2;break;case"utf8":n=vs(this,this.l,this.l+e);break;case"utf16le":e*=2,n=xc(this,this.l,this.l+e);break;case"wstr":return Lo.call(this,e,"dbcs");case"lpstr-ansi":n=jg(this,this.l),e=4+Qt(this,this.l);break;case"lpstr-cp":n=t1(this,this.l),e=4+Qt(this,this.l);break;case"lpwstr":n=r1(this,this.l),e=4+2*Qt(this,this.l);break;case"lpp4":e=4+Qt(this,this.l),n=o1(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Qt(this,this.l),n=l1(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,n="";(s=hi(this,this.l+e++))!==0;)o.push(Gs(s));n=o.join("");break;case"_wstr":for(e=0,n="";(s=So(this,this.l+e))!==0;)o.push(Gs(s)),e+=2;e+=2,n=o.join("");break;case"dbcs-cont":for(n="",f=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return s=hi(this,f),this.l=f+1,l=Lo.call(this,e-u,s?"dbcs-cont":"sbcs-cont"),o.join("")+l;o.push(Gs(So(this,f))),f+=2}n=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(n="",f=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(f)!==-1)return s=hi(this,f),this.l=f+1,l=Lo.call(this,e-u,s?"dbcs-cont":"sbcs-cont"),o.join("")+l;o.push(Gs(hi(this,f))),f+=1}n=o.join("");break;default:switch(e){case 1:return r=hi(this,this.l),this.l++,r;case 2:return r=(t==="i"?ET:So)(this,this.l),this.l+=2,r;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(r=(e>0?Vr:ST)(this,this.l),this.l+=4,r):(i=Qt(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Bl(this,this.l):i=Bl([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:n=Qg(this,this.l,e);break}}return this.l+=e,n}var wT=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},CT=function(e,t,n){e[n]=t&255,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},AT=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255};function IT(e,t,n){var r=0,i=0;if(n==="dbcs"){for(i=0;i!=t.length;++i)AT(this,t.charCodeAt(i),this.l+2*i);r=2*t.length}else if(n==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;r=t.length}else if(n==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(n==="utf16le"){var o=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var s=t.charCodeAt(i);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=t&255;break;case 2:r=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:r=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:r=4,wT(this,t,this.l);break;case 8:if(r=8,n==="f"){TT(this,t,this.l);break}case 16:break;case-4:r=4,CT(this,t,this.l);break}return this.l+=r,this}function u1(e,t){var n=Qg(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function Xt(e,t){e.l=t,e.read_shift=Lo,e.chk=u1,e.write_shift=IT}function Un(e,t){e.l+=t}function J(e){var t=Qr(e);return Xt(t,0),t}function qt(){var e=[],t=Ie?256:2048,n=function(f){var d=J(f);return Xt(d,0),d},r=n(t),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},o=function(f){return r&&f<r.length-r.l?r:(i(),r=n(Math.max(f+1,t)))},s=function(){return i(),gt(e)},l=function(f){i(),r=f,r.l==null&&(r.l=r.length),o(t)};return{next:o,push:l,end:s,_bufs:e}}function b(e,t,n,r){var i=+t,o;if(!isNaN(i)){r||(r=yA[i].p||(n||[]).length||0),o=1+(i>=128?1:0)+1,r>=128&&++o,r>=16384&&++o,r>=2097152&&++o;var s=e.next(o);i<=127?s.write_shift(1,i):(s.write_shift(1,(i&127)+128),s.write_shift(1,i>>7));for(var l=0;l!=4;++l)if(r>=128)s.write_shift(1,(r&127)+128),r>>=7;else{s.write_shift(1,r);break}r>0&&_c(n)&&e.push(n)}}function Oo(e,t,n){var r=Jt(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Ad(e,t,n){var r=Jt(e);return r.s=Oo(r.s,t.s,n),r.e=Oo(r.e,t.s,n),r}function Uo(e,t){if(e.cRel&&e.c<0)for(e=Jt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Jt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=De(e);return!e.cRel&&e.cRel!=null&&(n=PT(n)),!e.rRel&&e.rRel!=null&&(n=RT(n)),n}function iu(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+It(e.s.c)+":"+(e.e.cRel?"":"$")+It(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+_t(e.s.r)+":"+(e.e.rRel?"":"$")+_t(e.e.r):Uo(e.s,t.biff)+":"+Uo(e.e,t.biff)}function yc(e){return parseInt(NT(e),10)-1}function _t(e){return""+(e+1)}function RT(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function NT(e){return e.replace(/\$(\d+)$/,"$1")}function Tc(e){for(var t=FT(e),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function It(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function PT(e){return e.replace(/^([A-Z])/,"$$$1")}function FT(e){return e.replace(/^\$([A-Z])/,"$1")}function kT(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ut(e){for(var t=0,n=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(n=26*n+(i-64))}return{c:n-1,r:t-1}}function De(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function tn(e){var t=e.indexOf(":");return t==-1?{s:ut(e),e:ut(e)}:{s:ut(e.slice(0,t)),e:ut(e.slice(t+1))}}function tt(e,t){return typeof t>"u"||typeof t=="number"?tt(e.s,e.e):(typeof e!="string"&&(e=De(e)),typeof t!="string"&&(t=De(t)),e==t?e:e+":"+t)}function He(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,i=0,o=e.length;for(n=0;r<o&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.s.c=--n,n=0;r<o&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;if(t.s.r=--n,r===o||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=o&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.e.c=--n,n=0;r!=o&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;return t.e.r=--n,t}function Id(e,t){var n=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ar(e.z,n?$t(t):t)}catch{}try{return e.w=Ar((e.XF||{}).numFmtId||(n?14:0),n?$t(t):t)}catch{return""+t}}function er(e,t,n){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),e.t=="e"?xs[e.v]||e.v:t==null?Id(e,e.v):Id(e,t))}function ni(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function f1(e,t,n){var r=n||{},i=e?Array.isArray(e):r.dense,o=e||(i?[]:{}),s=0,l=0;if(o&&r.origin!=null){if(typeof r.origin=="number")s=r.origin;else{var u=typeof r.origin=="string"?ut(r.origin):r.origin;s=u.r,l=u.c}o["!ref"]||(o["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var d=He(o["!ref"]);f.s.c=d.s.c,f.s.r=d.s.r,f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),s==-1&&(f.e.r=s=d.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[h].length;++p)if(!(typeof t[h][p]>"u")){var m={v:t[h][p]},v=s+h,g=l+p;if(f.s.r>v&&(f.s.r=v),f.s.c>g&&(f.s.c=g),f.e.r<v&&(f.e.r=v),f.e.c<g&&(f.e.c=g),t[h][p]&&typeof t[h][p]=="object"&&!Array.isArray(t[h][p])&&!(t[h][p]instanceof Date))m=t[h][p];else if(Array.isArray(m.v)&&(m.f=t[h][p][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(r.nullError)m.t="e",m.v=0;else if(r.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=r.dateNF||Qe[14],r.cellDates?(m.t="d",m.w=Ar(m.z,$t(m.v))):(m.t="n",m.v=$t(m.v),m.w=Ar(m.z,m.v))):m.t="s";if(i)o[v]||(o[v]=[]),o[v][g]&&o[v][g].z&&(m.z=o[v][g].z),o[v][g]=m;else{var T=De({c:g,r:v});o[T]&&o[T].z&&(m.z=o[T].z),o[T]=m}}}return f.s.c<1e7&&(o["!ref"]=tt(f)),o}function ji(e,t){return f1(null,e,t)}function MT(e){return e.read_shift(4,"i")}function An(e,t){return t||(t=J(4)),t.write_shift(4,e),t}function Rt(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function ft(e,t){var n=!1;return t==null&&(n=!0,t=J(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function DT(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function LT(e,t){return t||(t=J(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Ec(e,t){var n=e.l,r=e.read_shift(1),i=Rt(e),o=[],s={t:i,h:i};if(r&1){for(var l=e.read_shift(4),u=0;u!=l;++u)o.push(DT(e));s.r=o}else s.r=[{ich:0,ifnt:0}];return e.l=n+t,s}function OT(e,t){var n=!1;return t==null&&(n=!0,t=J(15+4*e.t.length)),t.write_shift(1,0),ft(e.t,t),n?t.slice(0,t.l):t}var UT=Ec;function BT(e,t){var n=!1;return t==null&&(n=!0,t=J(23+4*e.t.length)),t.write_shift(1,1),ft(e.t,t),t.write_shift(4,1),LT({},t),n?t.slice(0,t.l):t}function mn(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function ri(e,t){return t==null&&(t=J(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ii(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function oi(e,t){return t==null&&(t=J(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var VT=Rt,c1=ft;function Sc(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Vl(e,t){var n=!1;return t==null&&(n=!0,t=J(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var GT=Rt,lf=Sc,wc=Vl;function d1(e){var t=e.slice(e.l,e.l+4),n=t[0]&1,r=t[0]&2;e.l+=4;var i=r===0?Bl([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Vr(t,0)>>2;return n?i/100:i}function h1(e,t){t==null&&(t=J(4));var n=0,r=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,n=1),r)t.write_shift(-4,((n?i:e)<<2)+(n+2));else throw new Error("unsupported RkNumber "+e)}function p1(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function HT(e,t){return t||(t=J(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var si=p1,eo=HT;function to(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Zr(e,t){return(t||J(8)).write_shift(8,e,"f")}function WT(e){var t={},n=e.read_shift(1),r=n>>>1,i=e.read_shift(1),o=e.read_shift(2,"i"),s=e.read_shift(1),l=e.read_shift(1),u=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=i;var f=QT[i];f&&(t.rgb=Bd(f));break;case 2:t.rgb=Bd([s,l,u]);break;case 3:t.theme=i;break}return o!=0&&(t.tint=o>0?o/32767:o/32768),t}function Gl(e,t){if(t||(t=J(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var r=e.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}return t}function zT(e){var t=e.read_shift(1);e.l++;var n={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return n}function qT(e,t){t||(t=J(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,n),t.write_shift(1,0),t}var m1=2,Yt=3,qs=11,Hl=19,$s=64,$T=65,JT=71,YT=4108,KT=4126,pt=80,Rd={1:{n:"CodePage",t:m1},2:{n:"Category",t:pt},3:{n:"PresentationFormat",t:pt},4:{n:"ByteCount",t:Yt},5:{n:"LineCount",t:Yt},6:{n:"ParagraphCount",t:Yt},7:{n:"SlideCount",t:Yt},8:{n:"NoteCount",t:Yt},9:{n:"HiddenCount",t:Yt},10:{n:"MultimediaClipCount",t:Yt},11:{n:"ScaleCrop",t:qs},12:{n:"HeadingPairs",t:YT},13:{n:"TitlesOfParts",t:KT},14:{n:"Manager",t:pt},15:{n:"Company",t:pt},16:{n:"LinksUpToDate",t:qs},17:{n:"CharacterCount",t:Yt},19:{n:"SharedDoc",t:qs},22:{n:"HyperlinksChanged",t:qs},23:{n:"AppVersion",t:Yt,p:"version"},24:{n:"DigSig",t:$T},26:{n:"ContentType",t:pt},27:{n:"ContentStatus",t:pt},28:{n:"Language",t:pt},29:{n:"Version",t:pt},255:{},2147483648:{n:"Locale",t:Hl},2147483651:{n:"Behavior",t:Hl},1919054434:{}},Nd={1:{n:"CodePage",t:m1},2:{n:"Title",t:pt},3:{n:"Subject",t:pt},4:{n:"Author",t:pt},5:{n:"Keywords",t:pt},6:{n:"Comments",t:pt},7:{n:"Template",t:pt},8:{n:"LastAuthor",t:pt},9:{n:"RevNumber",t:pt},10:{n:"EditTime",t:$s},11:{n:"LastPrinted",t:$s},12:{n:"CreatedDate",t:$s},13:{n:"ModifiedDate",t:$s},14:{n:"PageCount",t:Yt},15:{n:"WordCount",t:Yt},16:{n:"CharCount",t:Yt},17:{n:"Thumbnail",t:JT},18:{n:"Application",t:pt},19:{n:"DocSecurity",t:Yt},255:{},2147483648:{n:"Locale",t:Hl},2147483651:{n:"Behavior",t:Hl},1919054434:{}};function XT(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var bT=XT([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),QT=Jt(bT),xs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ZT={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Js={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function g1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function v1(e,t){var n=aT(ZT),r=[],i;r[r.length]=nt,r[r.length]=te("Types",null,{xmlns:at.CT,"xmlns:xsd":at.xsd,"xmlns:xsi":at.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return te("Default",null,{Extension:u[0],ContentType:u[1]})}));var o=function(u){e[u]&&e[u].length>0&&(i=e[u][0],r[r.length]=te("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Js[u][t.bookType]||Js[u].xlsx}))},s=function(u){(e[u]||[]).forEach(function(f){r[r.length]=te("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:Js[u][t.bookType]||Js[u].xlsx})})},l=function(u){(e[u]||[]).forEach(function(f){r[r.length]=te("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:n[u][0]})})};return o("workbooks"),s("sheets"),s("charts"),l("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),s("metadata"),l("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var we={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function x1(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Li(e){var t=[nt,te("Relationships",null,{xmlns:at.RELS})];return Tt(e["!id"]).forEach(function(n){t[t.length]=te("Relationship",null,e["!id"][n])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Fe(e,t,n,r,i,o){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=r,i.Target=n,[we.HLINK,we.XPATH,we.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function jT(e){var t=[nt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Pd(e,t,n){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function eE(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function tE(e){var t=[nt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=e.length;++n)t.push(Pd(e[n][0],e[n][1])),t.push(eE("",e[n][0]));return t.push(Pd("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function _1(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+kl.version+"</meta:generator></office:meta></office:document-meta>"}var $r=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function ou(e,t,n,r,i){i[e]!=null||t==null||t===""||(i[e]=t,t=ke(t),r[r.length]=n?te(e,t,n):vt(e,t))}function y1(e,t){var n=t||{},r=[nt,te("cp:coreProperties",null,{"xmlns:cp":at.CORE_PROPS,"xmlns:dc":at.dc,"xmlns:dcterms":at.dcterms,"xmlns:dcmitype":at.dcmitype,"xmlns:xsi":at.xsi})],i={};if(!e&&!n.Props)return r.join("");e&&(e.CreatedDate!=null&&ou("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:sf(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),e.ModifiedDate!=null&&ou("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:sf(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var o=0;o!=$r.length;++o){var s=$r[o],l=n.Props&&n.Props[s[1]]!=null?n.Props[s[1]]:e?e[s[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&ou(s[0],l,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Oi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],T1=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function E1(e){var t=[],n=te;return e||(e={}),e.Application="SheetJS",t[t.length]=nt,t[t.length]=te("Properties",null,{xmlns:at.EXT_PROPS,"xmlns:vt":at.vt}),Oi.forEach(function(r){if(e[r[1]]!==void 0){var i;switch(r[2]){case"string":i=ke(String(e[r[1]]));break;case"bool":i=e[r[1]]?"true":"false";break}i!==void 0&&(t[t.length]=n(r[0],i))}}),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(r){return"<vt:lpstr>"+ke(r)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function S1(e){var t=[nt,te("Properties",null,{xmlns:at.CUST_PROPS,"xmlns:vt":at.vt})];if(!e)return t.join("");var n=1;return Tt(e).forEach(function(i){++n,t[t.length]=te("property",_T(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:ke(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Fd={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function nE(e,t){var n=[];return Tt(Fd).map(function(r){for(var i=0;i<$r.length;++i)if($r[i][1]==r)return $r[i];for(i=0;i<Oi.length;++i)if(Oi[i][1]==r)return Oi[i];throw r}).forEach(function(r){if(e[r[1]]!=null){var i=t&&t.Props&&t.Props[r[1]]!=null?t.Props[r[1]]:e[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),n.push(vt(Fd[r[1]]||r[1],i))}}),te("DocumentProperties",n.join(""),{xmlns:bt.o})}function rE(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return e&&Tt(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)){for(var s=0;s<$r.length;++s)if(o==$r[s][1])return;for(s=0;s<Oi.length;++s)if(o==Oi[s][1])return;for(s=0;s<n.length;++s)if(o==n[s])return;var l=e[o],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l=String(l),i.push(te(xd(o),l,{"dt:dt":u}))}}),t&&Tt(t).forEach(function(o){if(Object.prototype.hasOwnProperty.call(t,o)&&!(e&&Object.prototype.hasOwnProperty.call(e,o))){var s=t[o],l="string";typeof s=="number"?(l="float",s=String(s)):s===!0||s===!1?(l="boolean",s=s?"1":"0"):s instanceof Date?(l="dateTime.tz",s=s.toISOString()):s=String(s),i.push(te(xd(o),s,{"dt:dt":l}))}}),"<"+r+' xmlns="'+bt.o+'">'+i.join("")+"</"+r+">"}function iE(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,n=t.getTime()/1e3+11644473600,r=n%Math.pow(2,32),i=(n-r)/Math.pow(2,32);r*=1e7,i*=1e7;var o=r/Math.pow(2,32)|0;o>0&&(r=r%Math.pow(2,32),i+=o);var s=J(8);return s.write_shift(4,r),s.write_shift(4,i),s}function kd(e,t){var n=J(4),r=J(4);switch(n.write_shift(4,e==80?31:e),e){case 3:r.write_shift(-4,t);break;case 5:r=J(8),r.write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=iE(t);break;case 31:case 80:for(r=J(4+2*(t.length+1)+(t.length%2?0:2)),r.write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return gt([n,r])}var w1=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function oE(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Md(e,t,n){var r=J(8),i=[],o=[],s=8,l=0,u=J(8),f=J(8);if(u.write_shift(4,2),u.write_shift(4,1200),f.write_shift(4,1),o.push(u),i.push(f),s+=8+u.length,!t){f=J(8),f.write_shift(4,0),i.unshift(f);var d=[J(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var h=e[l][0];for(u=J(8+2*(h.length+1)+(h.length%2?0:2)),u.write_shift(4,l+2),u.write_shift(4,h.length+1),u.write_shift(0,h,"dbcs");u.l!=u.length;)u.write_shift(1,0);d.push(u)}u=gt(d),o.unshift(u),s+=8+u.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(w1.indexOf(e[l][0])>-1||T1.indexOf(e[l][0])>-1)&&e[l][1]!=null){var p=e[l][1],m=0;if(t){m=+t[e[l][0]];var v=n[m];if(v.p=="version"&&typeof p=="string"){var g=p.split(".");p=(+g[0]<<16)+(+g[1]||0)}u=kd(v.t,p)}else{var T=oE(p);T==-1&&(T=31,p=String(p)),u=kd(T,p)}o.push(u),f=J(8),f.write_shift(4,t?m:2+l),i.push(f),s+=8+u.length}var _=8*(o.length+1);for(l=0;l<o.length;++l)i[l].write_shift(4,_),_+=o[l].length;return r.write_shift(4,s),r.write_shift(4,o.length),gt([r].concat(i).concat(o))}function Dd(e,t,n,r,i,o){var s=J(i?68:48),l=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Le.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,i?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,i?68:48);var u=Md(e,n,r);if(l.push(u),i){var f=Md(i,null,null);s.write_shift(16,o,"hex"),s.write_shift(4,68+u.length),l.push(f)}return gt(l)}function sE(e,t){t||(t=J(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}function lE(e,t){return e.read_shift(t)===1}function Mt(e,t){return t||(t=J(2)),t.write_shift(2,+!!e),t}function C1(e){return e.read_shift(2,"u")}function ln(e,t){return t||(t=J(2)),t.write_shift(2,e),t}function A1(e,t,n){return n||(n=J(2)),n.write_shift(1,t=="e"?+e:+!!e),n.write_shift(1,t=="e"?1:0),n}function I1(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),i="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var o=e.read_shift(1);o&&(i="dbcs-cont")}else n.biff==12&&(i="wstr");n.biff>=2&&n.biff<=5&&(i="cpstr");var s=r?e.read_shift(r,i):"";return s}function aE(e){var t=e.t||"",n=J(3);n.write_shift(2,t.length),n.write_shift(1,1);var r=J(2*t.length);r.write_shift(2*t.length,t,"utf16le");var i=[n,r];return gt(i)}function uE(e,t,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?r=e.read_shift(t,"sbcs-cont"):r=e.read_shift(t,"dbcs-cont"),r}function fE(e,t,n){var r=e.read_shift(n&&n.biff==2?1:2);return r===0?(e.l++,""):uE(e,r,n)}function cE(e,t,n){if(n.biff>5)return fE(e,t,n);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function R1(e,t,n){return n||(n=J(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function Ld(e,t){t||(t=J(6+e.length*2)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function dE(e){var t=J(512),n=0,r=e.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),o=i>-1?31:23;switch(r.charAt(0)){case"#":o=28;break;case".":o&=-3;break}t.write_shift(4,2),t.write_shift(4,o);var s=[8,6815827,6619237,4849780,83];for(n=0;n<s.length;++n)t.write_shift(4,s[n]);if(o==28)r=r.slice(1),Ld(r,t);else if(o&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<s.length;++n)t.write_shift(1,parseInt(s[n],16));var l=i>-1?r.slice(0,i):r;for(t.write_shift(4,2*(l.length+1)),n=0;n<l.length;++n)t.write_shift(2,l.charCodeAt(n));t.write_shift(2,0),o&8&&Ld(i>-1?r.slice(i+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<s.length;++n)t.write_shift(1,parseInt(s[n],16));for(var u=0;r.slice(u*3,u*3+3)=="../"||r.slice(u*3,u*3+3)=="..\\";)++u;for(t.write_shift(2,u),t.write_shift(4,r.length-3*u+1),n=0;n<r.length-3*u;++n)t.write_shift(1,r.charCodeAt(n+3*u)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function jr(e,t,n,r){return r||(r=J(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function hE(e,t,n){var r=n.biff>8?4:2,i=e.read_shift(r),o=e.read_shift(r,"i"),s=e.read_shift(r,"i");return[i,o,s]}function pE(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2);return{s:{c:r,r:t},e:{c:i,r:n}}}function N1(e,t){return t||(t=J(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Cc(e,t,n){var r=1536,i=16;switch(n.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=J(i);return o.write_shift(2,r),o.write_shift(2,t),i>4&&o.write_shift(2,29282),i>6&&o.write_shift(2,1997),i>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function mE(e,t){var n=!t||t.biff==8,r=J(n?112:54);for(r.write_shift(t.biff==8?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}function gE(e,t){var n=!t||t.biff>=8?2:1,r=J(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function vE(e,t){var n=J(8);n.write_shift(4,e.Count),n.write_shift(4,e.Unique);for(var r=[],i=0;i<e.length;++i)r[i]=aE(e[i]);var o=gt([n].concat(r));return o.parts=[n.length].concat(r.map(function(s){return s.length})),o}function xE(){var e=J(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function _E(e){var t=J(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function yE(e,t){var n=e.name||"Arial",r=t&&t.biff==5,i=r?15+n.length:16+2*n.length,o=J(i);return o.write_shift(2,e.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,n.length),r||o.write_shift(1,1),o.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),o}function TE(e,t,n,r){var i=J(10);return jr(e,t,r,i),i.write_shift(4,n),i}function EE(e,t,n,r,i){var o=!i||i.biff==8,s=J(8+ +o+(1+o)*n.length);return jr(e,t,r,s),s.write_shift(2,n.length),o&&s.write_shift(1,1),s.write_shift((1+o)*n.length,n,o?"utf16le":"sbcs"),s}function SE(e,t,n,r){var i=n&&n.biff==5;r||(r=J(i?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(i?1:2,t.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var o=r.length>r.l?r.slice(0,r.l):r;return o.l==null&&(o.l=o.length),o}function wE(e,t){var n=t.biff==8||!t.biff?4:2,r=J(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}function Od(e,t,n,r){var i=n&&n.biff==5;r||(r=J(i?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var o=0;return e.numFmtId>0&&i&&(o|=1024),r.write_shift(4,o),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function CE(e){var t=J(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function AE(e,t,n,r,i,o){var s=J(8);return jr(e,t,r,s),A1(n,o,s),s}function IE(e,t,n,r){var i=J(14);return jr(e,t,r,i),Zr(n,i),i}function RE(e,t,n){if(n.biff<8)return NE(e,t,n);for(var r=[],i=e.l+t,o=e.read_shift(n.biff>8?4:2);o--!==0;)r.push(hE(e,n.biff>8?12:6,n));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return r}function NE(e,t,n){e[e.l+1]==3&&e[e.l]++;var r=I1(e,t,n);return r.charCodeAt(0)==3?r.slice(1):r}function PE(e){var t=J(2+e.length*8);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)N1(e[n],t);return t}function FE(e){var t=J(24),n=ut(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(r[i],16));return gt([t,dE(e[1])])}function kE(e){var t=e[1].Tooltip,n=J(10+2*(t.length+1));n.write_shift(2,2048);var r=ut(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var i=0;i<t.length;++i)n.write_shift(2,t.charCodeAt(i));return n.write_shift(2,0),n}function ME(e){return e||(e=J(4)),e.write_shift(2,1),e.write_shift(2,1),e}function DE(e,t,n){if(!n.cellStyles)return Un(e,t);var r=n&&n.biff>=12?4:2,i=e.read_shift(r),o=e.read_shift(r),s=e.read_shift(r),l=e.read_shift(r),u=e.read_shift(2);r==2&&(e.l+=2);var f={s:i,e:o,w:s,ixfe:l,flags:u};return(n.biff>=5||!n.biff)&&(f.level=u>>8&7),f}function LE(e,t){var n=J(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,e.width*256),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}function OE(e){for(var t=J(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}function UE(e,t,n){var r=J(15);return ys(r,e,t),r.write_shift(8,n,"f"),r}function BE(e,t,n){var r=J(9);return ys(r,e,t),r.write_shift(2,n),r}var VE=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=pc({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(l,u){var f=[],d=Qr(1);switch(u.type){case"base64":d=En(jn(l));break;case"binary":d=En(l);break;case"buffer":case"array":d=l;break}Xt(d,0);var h=d.read_shift(1),p=!!(h&136),m=!1,v=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,p=!0;break;case 49:m=!0,p=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,T=521;h==2&&(g=d.read_shift(2)),d.l+=3,h!=2&&(g=d.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(T=d.read_shift(2));var _=d.read_shift(2),x=u.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(x=e[d[d.l]]),d.l+=1,d.l+=2),v&&(d.l+=36);for(var y=[],C={},k=Math.min(d.length,h==2?521:T-10-(m?264:0)),M=v?32:11;d.l<k&&d[d.l]!=13;)switch(C={},C.name=Ml.utils.decode(x,d.slice(d.l,d.l+M)).replace(/[\u0000\r\n].*$/g,""),d.l+=M,C.type=String.fromCharCode(d.read_shift(1)),h!=2&&!v&&(C.offset=d.read_shift(4)),C.len=d.read_shift(1),h==2&&(C.offset=d.read_shift(2)),C.dec=d.read_shift(1),C.name.length&&y.push(C),h!=2&&(d.l+=v?13:14),C.type){case"B":(!m||C.len!=8)&&u.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(d[d.l]!==13&&(d.l=T-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=T;var R=0,D=0;for(f[0]=[],D=0;D!=y.length;++D)f[0][D]=y[D].name;for(;g-- >0;){if(d[d.l]===42){d.l+=_;continue}for(++d.l,f[++R]=[],D=0,D=0;D!=y.length;++D){var F=d.slice(d.l,d.l+y[D].len);d.l+=y[D].len,Xt(F,0);var U=Ml.utils.decode(x,F);switch(y[D].type){case"C":U.trim().length&&(f[R][D]=U.replace(/\s+$/,""));break;case"D":U.length===8?f[R][D]=new Date(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8)):f[R][D]=U;break;case"F":f[R][D]=parseFloat(U.trim());break;case"+":case"I":f[R][D]=v?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":f[R][D]=!0;break;case"N":case"F":f[R][D]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));f[R][D]="##MEMO##"+(v?parseInt(U.trim(),10):F.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(f[R][D]=+U||0);break;case"@":f[R][D]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":f[R][D]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":f[R][D]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[R][D]=-F.read_shift(-8,"f");break;case"B":if(m&&y[D].len==8){f[R][D]=F.read_shift(8,"f");break}case"G":case"P":F.l+=y[D].len;break;case"0":if(y[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[D].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(f=f.slice(0,u.sheetRows)),u.DBF=y,f}function r(l,u){var f=u||{};f.dateNF||(f.dateNF="yyyymmdd");var d=ji(n(l,f),f);return d["!cols"]=f.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete f.DBF,d}function i(l,u){try{return ni(r(l,u),u)}catch(f){if(u&&u.WTF)throw f}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function s(l,u){var f=u||{};if(+f.codepage>=0&&rs(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var d=qt(),h=Jl(l,{header:1,raw:!0,cellDates:!0}),p=h[0],m=h.slice(1),v=l["!cols"]||[],g=0,T=0,_=0,x=1;for(g=0;g<p.length;++g){if(((v[g]||{}).DBF||{}).name){p[g]=v[g].DBF.name,++_;continue}if(p[g]!=null){if(++_,typeof p[g]=="number"&&(p[g]=p[g].toString(10)),typeof p[g]!="string")throw new Error("DBF Invalid column name "+p[g]+" |"+typeof p[g]+"|");if(p.indexOf(p[g])!==g){for(T=0;T<1024;++T)if(p.indexOf(p[g]+"_"+T)==-1){p[g]+="_"+T;break}}}}var y=He(l["!ref"]),C=[],k=[],M=[];for(g=0;g<=y.e.c-y.s.c;++g){var R="",D="",F=0,U=[];for(T=0;T<m.length;++T)m[T][g]!=null&&U.push(m[T][g]);if(U.length==0||p[g]==null){C[g]="?";continue}for(T=0;T<U.length;++T){switch(typeof U[T]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=U[T]instanceof Date?"D":"C";break;default:D="C"}F=Math.max(F,String(U[T]).length),R=R&&R!=D?"C":D}F>250&&(F=250),D=((v[g]||{}).DBF||{}).type,D=="C"&&v[g].DBF.len>F&&(F=v[g].DBF.len),R=="B"&&D=="N"&&(R="N",M[g]=v[g].DBF.dec,F=v[g].DBF.len),k[g]=R=="C"||D=="N"?F:o[R]||0,x+=k[g],C[g]=R}var q=d.next(32);for(q.write_shift(4,318902576),q.write_shift(4,m.length),q.write_shift(2,296+32*_),q.write_shift(2,x),g=0;g<4;++g)q.write_shift(4,0);for(q.write_shift(4,0|(+t[Fg]||3)<<8),g=0,T=0;g<p.length;++g)if(p[g]!=null){var K=d.next(32),ee=(p[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);K.write_shift(1,ee,"sbcs"),K.write_shift(1,C[g]=="?"?"C":C[g],"sbcs"),K.write_shift(4,T),K.write_shift(1,k[g]||o[C[g]]||0),K.write_shift(1,M[g]||0),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(1,0),K.write_shift(4,0),K.write_shift(4,0),T+=k[g]||o[C[g]]||0}var Te=d.next(264);for(Te.write_shift(4,13),g=0;g<65;++g)Te.write_shift(4,0);for(g=0;g<m.length;++g){var ge=d.next(x);for(ge.write_shift(1,0),T=0;T<p.length;++T)if(p[T]!=null)switch(C[T]){case"L":ge.write_shift(1,m[g][T]==null?63:m[g][T]?84:70);break;case"B":ge.write_shift(8,m[g][T]||0,"f");break;case"N":var Ae="0";for(typeof m[g][T]=="number"&&(Ae=m[g][T].toFixed(M[T]||0)),_=0;_<k[T]-Ae.length;++_)ge.write_shift(1,32);ge.write_shift(1,Ae,"sbcs");break;case"D":m[g][T]?(ge.write_shift(4,("0000"+m[g][T].getFullYear()).slice(-4),"sbcs"),ge.write_shift(2,("00"+(m[g][T].getMonth()+1)).slice(-2),"sbcs"),ge.write_shift(2,("00"+m[g][T].getDate()).slice(-2),"sbcs")):ge.write_shift(8,"00000000","sbcs");break;case"C":var Ne=String(m[g][T]!=null?m[g][T]:"").slice(0,k[T]);for(ge.write_shift(1,Ne,"sbcs"),_=0;_<k[T]-Ne.length;++_)ge.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:r,from_sheet:s}}(),GE=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Tt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(p,m){var v=e[m];return typeof v=="number"?sd(v):v},r=function(p,m,v){var g=m.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return g==59?p:sd(g)};e["|"]=254;function i(p,m){switch(m.type){case"base64":return o(jn(p),m);case"binary":return o(p,m);case"buffer":return o(Ie&&Buffer.isBuffer(p)?p.toString("binary"):ms(p),m);case"array":return o(va(p),m)}throw new Error("Unrecognized type "+m.type)}function o(p,m){var v=p.split(/[\n\r]+/),g=-1,T=-1,_=0,x=0,y=[],C=[],k=null,M={},R=[],D=[],F=[],U=0,q;for(+m.codepage>=0&&rs(+m.codepage);_!==v.length;++_){U=0;var K=v[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),ee=K.replace(/;;/g,"\0").split(";").map(function(L){return L.replace(/\u0000/g,";")}),Te=ee[0],ge;if(K.length>0)switch(Te){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ee[1].charAt(0)=="P"&&C.push(K.slice(3).replace(/;;/g,";"));break;case"C":var Ae=!1,Ne=!1,ie=!1,he=!1,me=-1,ye=-1;for(x=1;x<ee.length;++x)switch(ee[x].charAt(0)){case"A":break;case"X":T=parseInt(ee[x].slice(1))-1,Ne=!0;break;case"Y":for(g=parseInt(ee[x].slice(1))-1,Ne||(T=0),q=y.length;q<=g;++q)y[q]=[];break;case"K":ge=ee[x].slice(1),ge.charAt(0)==='"'?ge=ge.slice(1,ge.length-1):ge==="TRUE"?ge=!0:ge==="FALSE"?ge=!1:isNaN(Yn(ge))?isNaN(os(ge).getDate())||(ge=Ot(ge)):(ge=Yn(ge),k!==null&&zg(k)&&(ge=Yg(ge))),Ae=!0;break;case"E":he=!0;var P=BS(ee[x].slice(1),{r:g,c:T});y[g][T]=[y[g][T],P];break;case"S":ie=!0,y[g][T]=[y[g][T],"S5S"];break;case"G":break;case"R":me=parseInt(ee[x].slice(1))-1;break;case"C":ye=parseInt(ee[x].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+K)}if(Ae&&(y[g][T]&&y[g][T].length==2?y[g][T][0]=ge:y[g][T]=ge,k=null),ie){if(he)throw new Error("SYLK shared formula cannot have own formula");var W=me>-1&&y[me][ye];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");y[g][T][1]=VS(W[1],{r:g-me,c:T-ye})}break;case"F":var O=0;for(x=1;x<ee.length;++x)switch(ee[x].charAt(0)){case"X":T=parseInt(ee[x].slice(1))-1,++O;break;case"Y":for(g=parseInt(ee[x].slice(1))-1,q=y.length;q<=g;++q)y[q]=[];break;case"M":U=parseInt(ee[x].slice(1))/20;break;case"F":break;case"G":break;case"P":k=C[parseInt(ee[x].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=ee[x].slice(1).split(" "),q=parseInt(F[0],10);q<=parseInt(F[1],10);++q)U=parseInt(F[2],10),D[q-1]=U===0?{hidden:!0}:{wch:U},Ac(D[q-1]);break;case"C":T=parseInt(ee[x].slice(1))-1,D[T]||(D[T]={});break;case"R":g=parseInt(ee[x].slice(1))-1,R[g]||(R[g]={}),U>0?(R[g].hpt=U,R[g].hpx=D1(U)):U===0&&(R[g].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+K)}O<1&&(k=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+K)}}return R.length>0&&(M["!rows"]=R),D.length>0&&(M["!cols"]=D),m&&m.sheetRows&&(y=y.slice(0,m.sheetRows)),[y,M]}function s(p,m){var v=i(p,m),g=v[0],T=v[1],_=ji(g,m);return Tt(T).forEach(function(x){_[x]=T[x]}),_}function l(p,m){return ni(s(p,m),m)}function u(p,m,v,g){var T="C;Y"+(v+1)+";X"+(g+1)+";K";switch(p.t){case"n":T+=p.v||0,p.f&&!p.F&&(T+=";E"+Rc(p.f,{r:v,c:g}));break;case"b":T+=p.v?"TRUE":"FALSE";break;case"e":T+=p.w||p.v;break;case"d":T+='"'+(p.w||p.v)+'"';break;case"s":T+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return T}function f(p,m){m.forEach(function(v,g){var T="F;W"+(g+1)+" "+(g+1)+" ";v.hidden?T+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Wl(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=zl(v.wpx)),typeof v.wch=="number"&&(T+=Math.round(v.wch))),T.charAt(T.length-1)!=" "&&p.push(T)})}function d(p,m){m.forEach(function(v,g){var T="F;";v.hidden?T+="M0;":v.hpt?T+="M"+20*v.hpt+";":v.hpx&&(T+="M"+20*ql(v.hpx)+";"),T.length>2&&p.push(T+"R"+(g+1))})}function h(p,m){var v=["ID;PWXL;N;E"],g=[],T=He(p["!ref"]),_,x=Array.isArray(p),y=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),p["!cols"]&&f(v,p["!cols"]),p["!rows"]&&d(v,p["!rows"]),v.push("B;Y"+(T.e.r-T.s.r+1)+";X"+(T.e.c-T.s.c+1)+";D"+[T.s.c,T.s.r,T.e.c,T.e.r].join(" "));for(var C=T.s.r;C<=T.e.r;++C)for(var k=T.s.c;k<=T.e.c;++k){var M=De({r:C,c:k});_=x?(p[C]||[])[k]:p[M],!(!_||_.v==null&&(!_.f||_.F))&&g.push(u(_,p,C,k))}return v.join(y)+y+g.join(y)+y+"E"+y}return{to_workbook:l,to_sheet:s,from_sheet:h}}(),HE=function(){function e(o,s){switch(s.type){case"base64":return t(jn(o),s);case"binary":return t(o,s);case"buffer":return t(Ie&&Buffer.isBuffer(o)?o.toString("binary"):ms(o),s);case"array":return t(va(o),s)}throw new Error("Unrecognized type "+s.type)}function t(o,s){for(var l=o.split(`
`),u=-1,f=-1,d=0,h=[];d!==l.length;++d){if(l[d].trim()==="BOT"){h[++u]=[],f=0;continue}if(!(u<0)){var p=l[d].trim().split(","),m=p[0],v=p[1];++d;for(var g=l[d]||"";(g.match(/["]/g)||[]).length&1&&d<l.length-1;)g+=`
`+l[++d];switch(g=g.trim(),+m){case-1:if(g==="BOT"){h[++u]=[],f=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[u][f]=!0:g==="FALSE"?h[u][f]=!1:isNaN(Yn(v))?isNaN(os(v).getDate())?h[u][f]=v:h[u][f]=Ot(v):h[u][f]=Yn(v),++f;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[u][f++]=g!==""?g:null;break}if(g==="EOD")break}}return s&&s.sheetRows&&(h=h.slice(0,s.sheetRows)),h}function n(o,s){return ji(e(o,s),s)}function r(o,s){return ni(n(o,s),s)}var i=function(){var o=function(u,f,d,h,p){u.push(f),u.push(d+","+h),u.push('"'+p.replace(/"/g,'""')+'"')},s=function(u,f,d,h){u.push(f+","+d),u.push(f==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(u){var f=[],d=He(u["!ref"]),h,p=Array.isArray(u);o(f,"TABLE",0,1,"sheetjs"),o(f,"VECTORS",0,d.e.r-d.s.r+1,""),o(f,"TUPLES",0,d.e.c-d.s.c+1,""),o(f,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){s(f,-1,0,"BOT");for(var v=d.s.c;v<=d.e.c;++v){var g=De({r:m,c:v});if(h=p?(u[m]||[])[v]:u[g],!h){s(f,1,0,"");continue}switch(h.t){case"n":var T=h.w;!T&&h.v!=null&&(T=h.v),T==null?h.f&&!h.F?s(f,1,0,"="+h.f):s(f,1,0,""):s(f,0,T,"V");break;case"b":s(f,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":s(f,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Ar(h.z||Qe[14],$t(Ot(h.v)))),s(f,0,h.w,"V");break;default:s(f,1,0,"")}}}s(f,-1,0,"EOD");var _=`\r
`,x=f.join(_);return x}}();return{to_workbook:r,to_sheet:n,from_sheet:i}}(),P1=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(h,p){for(var m=h.split(`
`),v=-1,g=-1,T=0,_=[];T!==m.length;++T){var x=m[T].trim().split(":");if(x[0]==="cell"){var y=ut(x[1]);if(_.length<=y.r)for(v=_.length;v<=y.r;++v)_[v]||(_[v]=[]);switch(v=y.r,g=y.c,x[2]){case"t":_[v][g]=e(x[3]);break;case"v":_[v][g]=+x[3];break;case"vtf":var C=x[x.length-1];case"vtc":switch(x[3]){case"nl":_[v][g]=!!+x[4];break;default:_[v][g]=+x[4];break}x[2]=="vtf"&&(_[v][g]=[_[v][g],C])}}}return p&&p.sheetRows&&(_=_.slice(0,p.sheetRows)),_}function r(h,p){return ji(n(h,p),p)}function i(h,p){return ni(r(h,p),p)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function f(h){if(!h||!h["!ref"])return"";for(var p=[],m=[],v,g="",T=tn(h["!ref"]),_=Array.isArray(h),x=T.s.r;x<=T.e.r;++x)for(var y=T.s.c;y<=T.e.c;++y)if(g=De({r:x,c:y}),v=_?(h[x]||[])[y]:h[g],!(!v||v.v==null||v.t==="z")){switch(m=["cell",g,"t"],v.t){case"s":case"str":m.push(t(v.v));break;case"n":v.f?(m[2]="vtf",m[3]="n",m[4]=v.v,m[5]=t(v.f)):(m[2]="v",m[3]=v.v);break;case"b":m[2]="vt"+(v.f?"f":"c"),m[3]="nl",m[4]=v.v?"1":"0",m[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var C=$t(Ot(v.v));m[2]="vtc",m[3]="nd",m[4]=""+C,m[5]=v.w||Ar(v.z||Qe[14],C);break;case"e":continue}p.push(m.join(":"))}return p.push("sheet:c:"+(T.e.c-T.s.c+1)+":r:"+(T.e.r-T.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function d(h){return[o,s,l,s,f(h),u].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:d}}(),WE=function(){function e(d,h,p,m,v){v.raw?h[p][m]=d:d===""||(d==="TRUE"?h[p][m]=!0:d==="FALSE"?h[p][m]=!1:isNaN(Yn(d))?isNaN(os(d).getDate())?h[p][m]=d:h[p][m]=Ot(d):h[p][m]=Yn(d))}function t(d,h){var p=h||{},m=[];if(!d||d.length===0)return m;for(var v=d.split(/[\r\n]/),g=v.length-1;g>=0&&v[g].length===0;)--g;for(var T=10,_=0,x=0;x<=g;++x)_=v[x].indexOf(" "),_==-1?_=v[x].length:_++,T=Math.max(T,_);for(x=0;x<=g;++x){m[x]=[];var y=0;for(e(v[x].slice(0,T).trim(),m,x,y,p),y=1;y<=(v[x].length-T)/10+1;++y)e(v[x].slice(T+(y-1)*10,T+y*10).trim(),m,x,y,p)}return p.sheetRows&&(m=m.slice(0,p.sheetRows)),m}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(d){for(var h={},p=!1,m=0,v=0;m<d.length;++m)(v=d.charCodeAt(m))==34?p=!p:!p&&v in n&&(h[v]=(h[v]||0)+1);v=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&v.push([h[m],m]);if(!v.length){h=r;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&v.push([h[m],m])}return v.sort(function(g,T){return g[0]-T[0]||r[g[1]]-r[T[1]]}),n[v.pop()[1]]||44}function o(d,h){var p=h||{},m="",v=p.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(m=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(m=d.charAt(4),d=d.slice(6)):m=i(d.slice(0,1024)):p&&p.FS?m=p.FS:m=i(d.slice(0,1024));var T=0,_=0,x=0,y=0,C=0,k=m.charCodeAt(0),M=!1,R=0,D=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var F=p.dateNF!=null?iT(p.dateNF):null;function U(){var q=d.slice(y,C),K={};if(q.charAt(0)=='"'&&q.charAt(q.length-1)=='"'&&(q=q.slice(1,-1).replace(/""/g,'"')),q.length===0)K.t="z";else if(p.raw)K.t="s",K.v=q;else if(q.trim().length===0)K.t="s",K.v=q;else if(q.charCodeAt(0)==61)q.charCodeAt(1)==34&&q.charCodeAt(q.length-1)==34?(K.t="s",K.v=q.slice(2,-1).replace(/""/g,'"')):GS(q)?(K.t="n",K.f=q.slice(1)):(K.t="s",K.v=q);else if(q=="TRUE")K.t="b",K.v=!0;else if(q=="FALSE")K.t="b",K.v=!1;else if(!isNaN(x=Yn(q)))K.t="n",p.cellText!==!1&&(K.w=q),K.v=x;else if(!isNaN(os(q).getDate())||F&&q.match(F)){K.z=p.dateNF||Qe[14];var ee=0;F&&q.match(F)&&(q=oT(q,p.dateNF,q.match(F)||[]),ee=1),p.cellDates?(K.t="d",K.v=Ot(q,ee)):(K.t="n",K.v=$t(Ot(q,ee))),p.cellText!==!1&&(K.w=Ar(K.z,K.v instanceof Date?$t(K.v):K.v)),p.cellNF||delete K.z}else K.t="s",K.v=q;if(K.t=="z"||(p.dense?(v[T]||(v[T]=[]),v[T][_]=K):v[De({c:_,r:T})]=K),y=C+1,D=d.charCodeAt(y),g.e.c<_&&(g.e.c=_),g.e.r<T&&(g.e.r=T),R==k)++_;else if(_=0,++T,p.sheetRows&&p.sheetRows<=T)return!0}e:for(;C<d.length;++C)switch(R=d.charCodeAt(C)){case 34:D===34&&(M=!M);break;case k:case 10:case 13:if(!M&&U())break e;break}return C-y>0&&U(),v["!ref"]=tt(g),v}function s(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?o(d,h):ji(t(d,h),h)}function l(d,h){var p="",m=h.type=="string"?[0,0,0,0]:eI(d,h);switch(h.type){case"base64":p=jn(d);break;case"binary":p=d;break;case"buffer":h.codepage==65001?p=d.toString("utf8"):h.codepage&&typeof Ml<"u"||(p=Ie&&Buffer.isBuffer(d)?d.toString("binary"):ms(d));break;case"array":p=va(d);break;case"string":p=d;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?p=Do(p.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?p=Do(p):h.type=="binary"&&typeof Ml<"u",p.slice(0,19)=="socialcalc:version:"?P1.to_sheet(h.type=="string"?p:Do(p),h):s(p,h)}function u(d,h){return ni(l(d,h),h)}function f(d){for(var h=[],p=He(d["!ref"]),m,v=Array.isArray(d),g=p.s.r;g<=p.e.r;++g){for(var T=[],_=p.s.c;_<=p.e.c;++_){var x=De({r:g,c:_});if(m=v?(d[g]||[])[_]:d[x],!m||m.v==null){T.push("          ");continue}for(var y=(m.w||(er(m),m.w)||"").slice(0,10);y.length<10;)y+=" ";T.push(y+(_===0?" ":""))}h.push(T.join(""))}return h.join(`
`)}return{to_workbook:u,to_sheet:l,from_sheet:f}}(),Ud=function(){function e(P,W,O){if(P){Xt(P,P.l||0);for(var L=O.Enum||me;P.l<P.length;){var X=P.read_shift(2),fe=L[X]||L[65535],pe=P.read_shift(2),de=P.l+pe,oe=fe.f&&fe.f(P,pe,O);if(P.l=de,W(oe,fe,X))return}}}function t(P,W){switch(W.type){case"base64":return n(En(jn(P)),W);case"binary":return n(En(P),W);case"buffer":case"array":return n(P,W)}throw"Unsupported type "+W.type}function n(P,W){if(!P)return P;var O=W||{},L=O.dense?[]:{},X="Sheet1",fe="",pe=0,de={},oe=[],Oe=[],Ee={s:{r:0,c:0},e:{r:0,c:0}},Pt=O.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)O.Enum=me,e(P,function(ce,on,Vn){switch(Vn){case 0:O.vers=ce,ce>=4096&&(O.qpro=!0);break;case 6:Ee=ce;break;case 204:ce&&(fe=ce);break;case 222:fe=ce;break;case 15:case 51:O.qpro||(ce[1].v=ce[1].v.slice(1));case 13:case 14:case 16:Vn==14&&(ce[2]&112)==112&&(ce[2]&15)>1&&(ce[2]&15)<15&&(ce[1].z=O.dateNF||Qe[14],O.cellDates&&(ce[1].t="d",ce[1].v=Yg(ce[1].v))),O.qpro&&ce[3]>pe&&(L["!ref"]=tt(Ee),de[X]=L,oe.push(X),L=O.dense?[]:{},Ee={s:{r:0,c:0},e:{r:0,c:0}},pe=ce[3],X=fe||"Sheet"+(pe+1),fe="");var Dr=O.dense?(L[ce[0].r]||[])[ce[0].c]:L[De(ce[0])];if(Dr){Dr.t=ce[1].t,Dr.v=ce[1].v,ce[1].z!=null&&(Dr.z=ce[1].z),ce[1].f!=null&&(Dr.f=ce[1].f);break}O.dense?(L[ce[0].r]||(L[ce[0].r]=[]),L[ce[0].r][ce[0].c]=ce[1]):L[De(ce[0])]=ce[1];break}},O);else if(P[2]==26||P[2]==14)O.Enum=ye,P[2]==14&&(O.qpro=!0,P.l=0),e(P,function(ce,on,Vn){switch(Vn){case 204:X=ce;break;case 22:ce[1].v=ce[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ce[3]>pe&&(L["!ref"]=tt(Ee),de[X]=L,oe.push(X),L=O.dense?[]:{},Ee={s:{r:0,c:0},e:{r:0,c:0}},pe=ce[3],X="Sheet"+(pe+1)),Pt>0&&ce[0].r>=Pt)break;O.dense?(L[ce[0].r]||(L[ce[0].r]=[]),L[ce[0].r][ce[0].c]=ce[1]):L[De(ce[0])]=ce[1],Ee.e.c<ce[0].c&&(Ee.e.c=ce[0].c),Ee.e.r<ce[0].r&&(Ee.e.r=ce[0].r);break;case 27:ce[14e3]&&(Oe[ce[14e3][0]]=ce[14e3][1]);break;case 1537:Oe[ce[0]]=ce[1],ce[0]==pe&&(X=ce[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(L["!ref"]=tt(Ee),de[fe||X]=L,oe.push(fe||X),!Oe.length)return{SheetNames:oe,Sheets:de};for(var Re={},Bn=[],Ke=0;Ke<Oe.length;++Ke)de[oe[Ke]]?(Bn.push(Oe[Ke]||oe[Ke]),Re[Oe[Ke]]=de[Oe[Ke]]||de[oe[Ke]]):(Bn.push(Oe[Ke]),Re[Oe[Ke]]={"!ref":"A1"});return{SheetNames:Bn,Sheets:Re}}function r(P,W){var O=W||{};if(+O.codepage>=0&&rs(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var L=qt(),X=He(P["!ref"]),fe=Array.isArray(P),pe=[];ne(L,0,o(1030)),ne(L,6,u(X));for(var de=Math.min(X.e.r,8191),oe=X.s.r;oe<=de;++oe)for(var Oe=_t(oe),Ee=X.s.c;Ee<=X.e.c;++Ee){oe===X.s.r&&(pe[Ee]=It(Ee));var Pt=pe[Ee]+Oe,Re=fe?(P[oe]||[])[Ee]:P[Pt];if(!(!Re||Re.t=="z"))if(Re.t=="n")(Re.v|0)==Re.v&&Re.v>=-32768&&Re.v<=32767?ne(L,13,m(oe,Ee,Re.v)):ne(L,14,g(oe,Ee,Re.v));else{var Bn=er(Re);ne(L,15,h(oe,Ee,Bn.slice(0,239)))}}return ne(L,1),L.end()}function i(P,W){var O=W||{};if(+O.codepage>=0&&rs(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var L=qt();ne(L,0,s(P));for(var X=0,fe=0;X<P.SheetNames.length;++X)(P.Sheets[P.SheetNames[X]]||{})["!ref"]&&ne(L,27,he(P.SheetNames[X],fe++));var pe=0;for(X=0;X<P.SheetNames.length;++X){var de=P.Sheets[P.SheetNames[X]];if(!(!de||!de["!ref"])){for(var oe=He(de["!ref"]),Oe=Array.isArray(de),Ee=[],Pt=Math.min(oe.e.r,8191),Re=oe.s.r;Re<=Pt;++Re)for(var Bn=_t(Re),Ke=oe.s.c;Ke<=oe.e.c;++Ke){Re===oe.s.r&&(Ee[Ke]=It(Ke));var ce=Ee[Ke]+Bn,on=Oe?(de[Re]||[])[Ke]:de[ce];if(!(!on||on.t=="z"))if(on.t=="n")ne(L,23,U(Re,Ke,pe,on.v));else{var Vn=er(on);ne(L,22,R(Re,Ke,pe,Vn.slice(0,239)))}}++pe}}return ne(L,1),L.end()}function o(P){var W=J(2);return W.write_shift(2,P),W}function s(P){var W=J(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var O=0,L=0,X=0,fe=0;fe<P.SheetNames.length;++fe){var pe=P.SheetNames[fe],de=P.Sheets[pe];if(!(!de||!de["!ref"])){++X;var oe=tn(de["!ref"]);O<oe.e.r&&(O=oe.e.r),L<oe.e.c&&(L=oe.e.c)}}return O>8191&&(O=8191),W.write_shift(2,O),W.write_shift(1,X),W.write_shift(1,L),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function l(P,W,O){var L={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&O.qpro?(L.s.c=P.read_shift(1),P.l++,L.s.r=P.read_shift(2),L.e.c=P.read_shift(1),P.l++,L.e.r=P.read_shift(2),L):(L.s.c=P.read_shift(2),L.s.r=P.read_shift(2),W==12&&O.qpro&&(P.l+=2),L.e.c=P.read_shift(2),L.e.r=P.read_shift(2),W==12&&O.qpro&&(P.l+=2),L.s.c==65535&&(L.s.c=L.e.c=L.s.r=L.e.r=0),L)}function u(P){var W=J(8);return W.write_shift(2,P.s.c),W.write_shift(2,P.s.r),W.write_shift(2,P.e.c),W.write_shift(2,P.e.r),W}function f(P,W,O){var L=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(L[0].c=P.read_shift(1),L[3]=P.read_shift(1),L[0].r=P.read_shift(2),P.l+=2):(L[2]=P.read_shift(1),L[0].c=P.read_shift(2),L[0].r=P.read_shift(2)),L}function d(P,W,O){var L=P.l+W,X=f(P,W,O);if(X[1].t="s",O.vers==20768){P.l++;var fe=P.read_shift(1);return X[1].v=P.read_shift(fe,"utf8"),X}return O.qpro&&P.l++,X[1].v=P.read_shift(L-P.l,"cstr"),X}function h(P,W,O){var L=J(7+O.length);L.write_shift(1,255),L.write_shift(2,W),L.write_shift(2,P),L.write_shift(1,39);for(var X=0;X<L.length;++X){var fe=O.charCodeAt(X);L.write_shift(1,fe>=128?95:fe)}return L.write_shift(1,0),L}function p(P,W,O){var L=f(P,W,O);return L[1].v=P.read_shift(2,"i"),L}function m(P,W,O){var L=J(7);return L.write_shift(1,255),L.write_shift(2,W),L.write_shift(2,P),L.write_shift(2,O,"i"),L}function v(P,W,O){var L=f(P,W,O);return L[1].v=P.read_shift(8,"f"),L}function g(P,W,O){var L=J(13);return L.write_shift(1,255),L.write_shift(2,W),L.write_shift(2,P),L.write_shift(8,O,"f"),L}function T(P,W,O){var L=P.l+W,X=f(P,W,O);if(X[1].v=P.read_shift(8,"f"),O.qpro)P.l=L;else{var fe=P.read_shift(2);C(P.slice(P.l,P.l+fe),X),P.l+=fe}return X}function _(P,W,O){var L=W&32768;return W&=-32769,W=(L?P:0)+(W>=8192?W-16384:W),(L?"":"$")+(O?It(W):_t(W))}var x={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(P,W){Xt(P,0);for(var O=[],L=0,X="",fe="",pe="",de="";P.l<P.length;){var oe=P[P.l++];switch(oe){case 0:O.push(P.read_shift(8,"f"));break;case 1:fe=_(W[0].c,P.read_shift(2),!0),X=_(W[0].r,P.read_shift(2),!1),O.push(fe+X);break;case 2:{var Oe=_(W[0].c,P.read_shift(2),!0),Ee=_(W[0].r,P.read_shift(2),!1);fe=_(W[0].c,P.read_shift(2),!0),X=_(W[0].r,P.read_shift(2),!1),O.push(Oe+Ee+":"+fe+X)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(P.read_shift(2));break;case 6:{for(var Pt="";oe=P[P.l++];)Pt+=String.fromCharCode(oe);O.push('"'+Pt.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:de=O.pop(),pe=O.pop(),O.push(["AND","OR"][oe-20]+"("+pe+","+de+")");break;default:if(oe<32&&y[oe])de=O.pop(),pe=O.pop(),O.push(pe+y[oe]+de);else if(x[oe]){if(L=x[oe][1],L==69&&(L=P[P.l++]),L>O.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+O.join("|")+"|");return}var Re=O.slice(-L);O.length-=L,O.push(x[oe][0]+"("+Re.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}O.length==1?W[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function k(P){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=P.read_shift(2),W[3]=P[P.l++],W[0].c=P[P.l++],W}function M(P,W){var O=k(P);return O[1].t="s",O[1].v=P.read_shift(W-4,"cstr"),O}function R(P,W,O,L){var X=J(6+L.length);X.write_shift(2,P),X.write_shift(1,O),X.write_shift(1,W),X.write_shift(1,39);for(var fe=0;fe<L.length;++fe){var pe=L.charCodeAt(fe);X.write_shift(1,pe>=128?95:pe)}return X.write_shift(1,0),X}function D(P,W){var O=k(P);O[1].v=P.read_shift(2);var L=O[1].v>>1;if(O[1].v&1)switch(L&7){case 0:L=(L>>3)*5e3;break;case 1:L=(L>>3)*500;break;case 2:L=(L>>3)/20;break;case 3:L=(L>>3)/200;break;case 4:L=(L>>3)/2e3;break;case 5:L=(L>>3)/2e4;break;case 6:L=(L>>3)/16;break;case 7:L=(L>>3)/64;break}return O[1].v=L,O}function F(P,W){var O=k(P),L=P.read_shift(4),X=P.read_shift(4),fe=P.read_shift(2);if(fe==65535)return L===0&&X===3221225472?(O[1].t="e",O[1].v=15):L===0&&X===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var pe=fe&32768;return fe=(fe&32767)-16446,O[1].v=(1-pe*2)*(X*Math.pow(2,fe+32)+L*Math.pow(2,fe)),O}function U(P,W,O,L){var X=J(14);if(X.write_shift(2,P),X.write_shift(1,O),X.write_shift(1,W),L==0)return X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,65535),X;var fe=0,pe=0,de=0,oe=0;return L<0&&(fe=1,L=-L),pe=Math.log2(L)|0,L/=Math.pow(2,pe-31),oe=L>>>0,oe&2147483648||(L/=2,++pe,oe=L>>>0),L-=oe,oe|=2147483648,oe>>>=0,L*=Math.pow(2,32),de=L>>>0,X.write_shift(4,de),X.write_shift(4,oe),pe+=16383+(fe?32768:0),X.write_shift(2,pe),X}function q(P,W){var O=F(P);return P.l+=W-14,O}function K(P,W){var O=k(P),L=P.read_shift(4);return O[1].v=L>>6,O}function ee(P,W){var O=k(P),L=P.read_shift(8,"f");return O[1].v=L,O}function Te(P,W){var O=ee(P);return P.l+=W-10,O}function ge(P,W){return P[P.l+W-1]==0?P.read_shift(W,"cstr"):""}function Ae(P,W){var O=P[P.l++];O>W-1&&(O=W-1);for(var L="";L.length<O;)L+=String.fromCharCode(P[P.l++]);return L}function Ne(P,W,O){if(!(!O.qpro||W<21)){var L=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var X=P.read_shift(W-21,"cstr");return[L,X]}}function ie(P,W){for(var O={},L=P.l+W;P.l<L;){var X=P.read_shift(2);if(X==14e3){for(O[X]=[0,""],O[X][0]=P.read_shift(2);P[P.l];)O[X][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return O}function he(P,W){var O=J(5+P.length);O.write_shift(2,14e3),O.write_shift(2,W);for(var L=0;L<P.length;++L){var X=P.charCodeAt(L);O[O.l++]=X>127?95:X}return O[O.l++]=0,O}var me={0:{n:"BOF",f:C1},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:T},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ge},222:{n:"SHEETNAMELP",f:Ae},65535:{n:""}},ye={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:M},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:D},25:{n:"FORMULA19",f:q},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ie},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:K},38:{n:"??"},39:{n:"NUMBER27",f:ee},40:{n:"FORMULA28",f:Te},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ge},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:t}}(),zE=/^\s|\s$|[\t\n\r]/;function F1(e,t){if(!t.bookSST)return"";var n=[nt];n[n.length]=te("sst",null,{xmlns:Zi[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(e[r]!=null){var i=e[r],o="<si>";i.r?o+=i.r:(o+="<t",i.t||(i.t=""),i.t.match(zE)&&(o+=' xml:space="preserve"'),o+=">"+ke(i.t)+"</t>"),o+="</si>",n[n.length]=o}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function qE(e){return[e.read_shift(4),e.read_shift(4)]}function $E(e,t){return t||(t=J(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var JE=OT;function YE(e){var t=qt();b(t,159,$E(e));for(var n=0;n<e.length;++n)b(t,19,JE(e[n]));return b(t,160),t.end()}function KE(e){for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function k1(e){var t=0,n,r=KE(e),i=r.length+1,o,s,l,u,f;for(n=Qr(i),n[0]=r.length,o=1;o!=i;++o)n[o]=r[o-1];for(o=i-1;o>=0;--o)s=n[o],l=t&16384?1:0,u=t<<1&32767,f=l|u,t=f^s;return t^52811}var XE=function(){function e(i,o){switch(o.type){case"base64":return t(jn(i),o);case"binary":return t(i,o);case"buffer":return t(Ie&&Buffer.isBuffer(i)?i.toString("binary"):ms(i),o);case"array":return t(va(i),o)}throw new Error("Unrecognized type "+o.type)}function t(i,o){var s=o||{},l=s.dense?[]:{},u=i.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(d,h){Array.isArray(l)&&(l[h]=[]);for(var p=/\\\w+\b/g,m=0,v,g=-1;v=p.exec(d);){switch(v[0]){case"\\cell":var T=d.slice(m,p.lastIndex-v[0].length);if(T[0]==" "&&(T=T.slice(1)),++g,T.length){var _={v:T,t:"s"};Array.isArray(l)?l[h][g]=_:l[De({r:h,c:g})]=_}break}m=p.lastIndex}g>f.e.c&&(f.e.c=g)}),l["!ref"]=tt(f),l}function n(i,o){return ni(e(i,o),o)}function r(i){for(var o=["{\\rtf1\\ansi"],s=He(i["!ref"]),l,u=Array.isArray(i),f=s.s.r;f<=s.e.r;++f){o.push("\\trowd\\trautofit1");for(var d=s.s.c;d<=s.e.c;++d)o.push("\\cellx"+(d+1));for(o.push("\\pard\\intbl"),d=s.s.c;d<=s.e.c;++d){var h=De({r:f,c:d});l=u?(i[f]||[])[d]:i[h],!(!l||l.v==null&&(!l.f||l.F))&&(o.push(" "+(l.w||(er(l),l.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:n,to_sheet:e,from_sheet:r}}();function Bd(e){for(var t=0,n=1;t!=3;++t)n=n*256+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}var bE=6,Kn=bE;function Wl(e){return Math.floor((e+Math.round(128/Kn)/256)*Kn)}function zl(e){return Math.floor((e-5)/Kn*100+.5)/100}function af(e){return Math.round((e*Kn+5)/Kn*256)/256}function Ac(e){e.width?(e.wpx=Wl(e.width),e.wch=zl(e.wpx),e.MDW=Kn):e.wpx?(e.wch=zl(e.wpx),e.width=af(e.wch),e.MDW=Kn):typeof e.wch=="number"&&(e.width=af(e.wch),e.wpx=Wl(e.width),e.MDW=Kn),e.customWidth&&delete e.customWidth}var QE=96,M1=QE;function ql(e){return e*96/M1}function D1(e){return e*M1/96}function ZE(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)e[r]!=null&&(t[t.length]=te("numFmt",null,{numFmtId:r,formatCode:ke(e[r])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=te("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function jE(e){var t=[];return t[t.length]=te("cellXfs",null),e.forEach(function(n){t[t.length]=te("xf",null,n)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=te("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function L1(e,t){var n=[nt,te("styleSheet",null,{xmlns:Zi[0],"xmlns:vt":at.vt})],r;return e.SSF&&(r=ZE(e.SSF))!=null&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=jE(t.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function eS(e,t){var n=e.read_shift(2),r=Rt(e);return[n,r]}function tS(e,t,n){n||(n=J(6+4*t.length)),n.write_shift(2,e),ft(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),r}function nS(e,t,n){var r={};r.sz=e.read_shift(2)/20;var i=zT(e);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var o=e.read_shift(2);switch(o===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(r.underline=s);var l=e.read_shift(1);l>0&&(r.family=l);var u=e.read_shift(1);switch(u>0&&(r.charset=u),e.l++,r.color=WT(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Rt(e),r}function rS(e,t){t||(t=J(25+4*32)),t.write_shift(2,e.sz*20),qT(e,t),t.write_shift(2,e.bold?700:400);var n=0;e.vertAlign=="superscript"?n=1:e.vertAlign=="subscript"&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Gl(e.color,t);var r=0;return r=2,t.write_shift(1,r),ft(e.name,t),t.length>t.l?t.slice(0,t.l):t}var iS=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],su,oS=Un;function Vd(e,t){t||(t=J(4*3+8*7+16*1)),su||(su=pc(iS));var n=su[e.patternType];n==null&&(n=40),t.write_shift(4,n);var r=0;if(n!=40)for(Gl({auto:1},t),Gl({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function sS(e,t){var n=e.l+t,r=e.read_shift(2),i=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:i}}function O1(e,t,n){n||(n=J(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var r=0;return n.write_shift(1,r),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function vo(e,t){return t||(t=J(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var lS=Un;function aS(e,t){return t||(t=J(51)),t.write_shift(1,0),vo(null,t),vo(null,t),vo(null,t),vo(null,t),vo(null,t),t.length>t.l?t.slice(0,t.l):t}function uS(e,t){return t||(t=J(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Vl(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function fS(e,t,n){var r=J(2052);return r.write_shift(4,e),Vl(t,r),Vl(n,r),r.length>r.l?r.slice(0,r.l):r}function cS(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&++n}),n!=0&&(b(e,615,An(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&b(e,44,tS(i,t[i]))}),b(e,616))}}function dS(e){var t=1;b(e,611,An(t)),b(e,43,rS({sz:12,color:{theme:1},name:"Calibri",family:2})),b(e,612)}function hS(e){var t=2;b(e,603,An(t)),b(e,45,Vd({patternType:"none"})),b(e,45,Vd({patternType:"gray125"})),b(e,604)}function pS(e){var t=1;b(e,613,An(t)),b(e,46,aS()),b(e,614)}function mS(e){var t=1;b(e,626,An(t)),b(e,47,O1({numFmtId:0},65535)),b(e,627)}function gS(e,t){b(e,617,An(t.length)),t.forEach(function(n){b(e,47,O1(n,0))}),b(e,618)}function vS(e){var t=1;b(e,619,An(t)),b(e,48,uS({xfId:0,name:"Normal"})),b(e,620)}function xS(e){var t=0;b(e,505,An(t)),b(e,506)}function _S(e){var t=0;b(e,508,fS(t,"TableStyleMedium9","PivotStyleMedium4")),b(e,509)}function yS(e,t){var n=qt();return b(n,278),cS(n,e.SSF),dS(n),hS(n),pS(n),mS(n),gS(n,t.cellXfs),vS(n),xS(n),_S(n),b(n,279),n.end()}function U1(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var n=[nt];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function TS(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Rt(e)}}function ES(e){var t=J(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),ft(e.name,t),t.slice(0,t.l)}function SS(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function wS(e){var t=J(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}function CS(e,t){var n=J(8+2*t.length);return n.write_shift(4,e),ft(t,n),n.slice(0,n.l)}function AS(e){return e.l+=4,e.read_shift(4)!=0}function IS(e,t){var n=J(8);return n.write_shift(4,e),n.write_shift(4,1),n}function RS(){var e=qt();return b(e,332),b(e,334,An(1)),b(e,335,ES({name:"XLDAPR",version:12e4,flags:3496657072})),b(e,336),b(e,339,CS(1,"XLDAPR")),b(e,52),b(e,35,An(514)),b(e,4096,An(0)),b(e,4097,ln(1)),b(e,36),b(e,53),b(e,340),b(e,337,IS(1)),b(e,51,wS([[1,0]])),b(e,338),b(e,333),e.end()}function B1(){var e=[nt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function NS(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=De(n);var r=e.read_shift(1);return r&2&&(t.l="1"),r&8&&(t.a="1"),t}var Ai=1024;function V1(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[te("xml",null,{"xmlns:v":bt.v,"xmlns:o":bt.o,"xmlns:x":bt.x,"xmlns:mv":bt.mv}).replace(/\/>/,">"),te("o:shapelayout",te("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),te("v:shapetype",[te("v:stroke",null,{joinstyle:"miter"}),te("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Ai<e*1e3;)Ai+=1e3;return t.forEach(function(o){var s=ut(o[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var u=l.type=="gradient"?te("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=te("v:fill",u,l),d={on:"t",obscured:"t"};++Ai,i=i.concat(["<v:shape"+ls({id:"_x0000_s"+Ai,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,te("v:shadow",null,d),te("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",vt("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),vt("x:AutoFill","False"),vt("x:Row",String(s.r)),vt("x:Column",String(s.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function G1(e){var t=[nt,te("comments",null,{xmlns:Zi[0]})],n=[];return t.push("<authors>"),e.forEach(function(r){r[1].forEach(function(i){var o=ke(i.a);n.indexOf(o)==-1&&(n.push(o),t.push("<author>"+o+"</author>")),i.T&&i.ID&&n.indexOf("tc="+i.ID)==-1&&(n.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(r){var i=0,o=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=n.indexOf("tc="+r[1][0].ID):r[1].forEach(function(u){u.a&&(i=n.indexOf(ke(u.a))),o.push(u.t||"")}),t.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),o.length<=1)t.push(vt("t",ke(o[0]||"")));else{for(var s=`Comment:
    `+o[0]+`
`,l=1;l<o.length;++l)s+=`Reply:
    `+o[l]+`
`;t.push(vt("t",ke(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function PS(e,t,n){var r=[nt,te("ThreadedComments",null,{xmlns:at.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var o="";(i[1]||[]).forEach(function(s,l){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var u={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};l==0?o=u.id:u.parentId=o,s.ID=u.id,s.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),r.push(te("threadedComment",vt("text",s.t||""),u))})}),r.push("</ThreadedComments>"),r.join("")}function FS(e){var t=[nt,te("personList",null,{xmlns:at.TCMNT,"xmlns:x":Zi[0]}).replace(/[\/]>/,">")];return e.forEach(function(n,r){t.push(te("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:n,providerId:"None"}))}),t.push("</personList>"),t.join("")}function kS(e){var t={};t.iauthor=e.read_shift(4);var n=si(e);return t.rfx=n.s,t.ref=De(n.s),e.l+=16,t}function MS(e,t){return t==null&&(t=J(36)),t.write_shift(4,e[1].iauthor),eo(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var DS=Rt;function LS(e){return ft(e.slice(0,54))}function OS(e){var t=qt(),n=[];return b(t,628),b(t,630),e.forEach(function(r){r[1].forEach(function(i){n.indexOf(i.a)>-1||(n.push(i.a.slice(0,54)),b(t,632,LS(i.a)))})}),b(t,631),b(t,633),e.forEach(function(r){r[1].forEach(function(i){i.iauthor=n.indexOf(i.a);var o={s:ut(r[0]),e:ut(r[0])};b(t,635,MS([o,i])),i.t&&i.t.length>0&&b(t,637,BT(i)),b(t,636),delete i.iauthor})}),b(t,634),b(t,629),t.end()}function US(e,t){t.FullPaths.forEach(function(n,r){if(r!=0){var i=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Le.utils.cfb_add(e,i,t.FileIndex[r].content)}})}var H1=["xlsb","xlsm","xlam","biff8","xla"],BS=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(r,i,o,s){var l=!1,u=!1;o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1)),s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1));var f=o.length>0?parseInt(o,10)|0:0,d=s.length>0?parseInt(s,10)|0:0;return l?d+=t.c:--d,u?f+=t.r:--f,i+(l?"":"$")+It(d)+(u?"":"$")+_t(f)}return function(i,o){return t=o,i.replace(e,n)}}(),Ic=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Rc=function(){return function(t,n){return t.replace(Ic,function(r,i,o,s,l,u){var f=Tc(s)-(o?0:n.c),d=yc(u)-(l?0:n.r),h=d==0?"":l?d+1:"["+d+"]",p=f==0?"":o?f+1:"["+f+"]";return i+"R"+h+"C"+p})}}();function VS(e,t){return e.replace(Ic,function(n,r,i,o,s,l){return r+(i=="$"?i+o:It(Tc(o)+t.c))+(s=="$"?s+l:_t(yc(l)+t.r))})}function GS(e){return e.length!=1}function je(e){e.l+=1}function Ir(e,t){var n=e.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function W1(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return z1(e);n.biff==12&&(r=4)}var i=e.read_shift(r),o=e.read_shift(r),s=Ir(e),l=Ir(e);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:o,c:l[0],cRel:l[1],rRel:l[2]}}}function z1(e){var t=Ir(e),n=Ir(e),r=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:i,cRel:n[1],rRel:n[2]}}}function HS(e,t,n){if(n.biff<8)return z1(e);var r=e.read_shift(n.biff==12?4:2),i=e.read_shift(n.biff==12?4:2),o=Ir(e),s=Ir(e);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function q1(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return WS(e);var r=e.read_shift(n&&n.biff==12?4:2),i=Ir(e);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function WS(e){var t=Ir(e),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}function zS(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function qS(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return $S(e);var i=e.read_shift(r>=12?4:2),o=e.read_shift(2),s=(o&16384)>>14,l=(o&32768)>>15;if(o&=16383,l==1)for(;i>524287;)i-=1048576;if(s==1)for(;o>8191;)o=o-16384;return{r:i,c:o,cRel:s,rRel:l}}function $S(e){var t=e.read_shift(2),n=e.read_shift(1),r=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,r==1&&t>=8192&&(t=t-16384),i==1&&n>=128&&(n=n-256),{r:t,c:n,cRel:i,rRel:r}}function JS(e,t,n){var r=(e[e.l++]&96)>>5,i=W1(e,n.biff>=2&&n.biff<=5?6:8,n);return[r,i]}function YS(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),o=8;if(n)switch(n.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var s=W1(e,o,n);return[r,i,s]}function KS(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function XS(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),o=8;if(n)switch(n.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[r,i]}function bS(e,t,n){var r=(e[e.l++]&96)>>5,i=HS(e,t-1,n);return[r,i]}function QS(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n.biff==2?6:n.biff==12?14:7,[r]}function Gd(e){var t=e[e.l+1]&1,n=1;return e.l+=4,[t,n]}function ZS(e,t,n){e.l+=2;for(var r=e.read_shift(n&&n.biff==2?1:2),i=[],o=0;o<=r;++o)i.push(e.read_shift(n&&n.biff==2?1:2));return i}function jS(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function e2(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function t2(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function n2(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=n&&n.biff==2?3:4,[r]}function $1(e){var t=e.read_shift(1),n=e.read_shift(1);return[t,n]}function r2(e){return e.read_shift(2),$1(e)}function i2(e){return e.read_shift(2),$1(e)}function o2(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=q1(e,0,n);return[r,i]}function s2(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=qS(e,0,n);return[r,i]}function l2(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);n&&n.biff==5&&(e.l+=12);var o=q1(e,0,n);return[r,i,o]}function a2(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(n&&n.biff<=3?1:2);return[aw[i],K1[i],r]}function u2(e,t,n){var r=e[e.l++],i=e.read_shift(1),o=n&&n.biff<=3?[r==88?-1:0,e.read_shift(1)]:f2(e);return[i,(o[0]===0?K1:lw)[o[1]]]}function f2(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function c2(e,t,n){e.l+=n&&n.biff==2?3:4}function d2(e,t,n){if(e.l++,n&&n.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function h2(e){return e.l++,xs[e.read_shift(1)]}function p2(e){return e.l++,e.read_shift(2)}function m2(e){return e.l++,e.read_shift(1)!==0}function g2(e){return e.l++,to(e)}function v2(e,t,n){return e.l++,I1(e,t-1,n)}function x2(e,t){var n=[e.read_shift(1)];if(t==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=lE(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:n[1]=xs[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:n[1]=to(e);break;case 2:n[1]=cE(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function _2(e,t,n){for(var r=e.read_shift(n.biff==12?4:2),i=[],o=0;o!=r;++o)i.push((n.biff==12?si:pE)(e));return i}function y2(e,t,n){var r=0,i=0;n.biff==12?(r=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--i==0&&(i=256));for(var o=0,s=[];o!=r&&(s[o]=[]);++o)for(var l=0;l!=i;++l)s[o][l]=x2(e,n.biff);return s}function T2(e,t,n){var r=e.read_shift(1)>>>5&3,i=!n||n.biff>=8?4:2,o=e.read_shift(i);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,o]}function E2(e,t,n){if(n.biff==5)return S2(e);var r=e.read_shift(1)>>>5&3,i=e.read_shift(2),o=e.read_shift(4);return[r,i,o]}function S2(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}function w2(e,t,n){var r=e.read_shift(1)>>>5&3;e.l+=n&&n.biff==2?3:4;var i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function C2(e,t,n){var r=e.read_shift(1)>>>5&3,i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function A2(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,n.biff==12&&(e.l+=2),[r]}function I2(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),o=4;if(n)switch(n.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[r,i]}var R2=Un,N2=Un,P2=Un;function _s(e,t,n){return e.l+=2,[zS(e)]}function Nc(e){return e.l+=6,[]}var F2=_s,k2=Nc,M2=Nc,D2=_s;function J1(e){return e.l+=2,[C1(e),e.read_shift(2)&1]}var L2=_s,O2=J1,U2=Nc,B2=_s,V2=_s,G2=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function H2(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),i=e.read_shift(2),o=e.read_shift(2),s=G2[n>>2&31];return{ixti:t,coltype:n&3,rt:s,idx:r,c:i,C:o}}function W2(e){return e.l+=2,[e.read_shift(4)]}function z2(e,t,n){return e.l+=5,e.l+=2,e.l+=n.biff==2?1:4,["PTGSHEET"]}function q2(e,t,n){return e.l+=n.biff==2?4:5,["PTGENDSHEET"]}function $2(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function J2(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function Y2(e){return e.l+=4,[0,0]}var Hd={1:{n:"PtgExp",f:d2},2:{n:"PtgTbl",f:P2},3:{n:"PtgAdd",f:je},4:{n:"PtgSub",f:je},5:{n:"PtgMul",f:je},6:{n:"PtgDiv",f:je},7:{n:"PtgPower",f:je},8:{n:"PtgConcat",f:je},9:{n:"PtgLt",f:je},10:{n:"PtgLe",f:je},11:{n:"PtgEq",f:je},12:{n:"PtgGe",f:je},13:{n:"PtgGt",f:je},14:{n:"PtgNe",f:je},15:{n:"PtgIsect",f:je},16:{n:"PtgUnion",f:je},17:{n:"PtgRange",f:je},18:{n:"PtgUplus",f:je},19:{n:"PtgUminus",f:je},20:{n:"PtgPercent",f:je},21:{n:"PtgParen",f:je},22:{n:"PtgMissArg",f:je},23:{n:"PtgStr",f:v2},26:{n:"PtgSheet",f:z2},27:{n:"PtgEndSheet",f:q2},28:{n:"PtgErr",f:h2},29:{n:"PtgBool",f:m2},30:{n:"PtgInt",f:p2},31:{n:"PtgNum",f:g2},32:{n:"PtgArray",f:QS},33:{n:"PtgFunc",f:a2},34:{n:"PtgFuncVar",f:u2},35:{n:"PtgName",f:T2},36:{n:"PtgRef",f:o2},37:{n:"PtgArea",f:JS},38:{n:"PtgMemArea",f:w2},39:{n:"PtgMemErr",f:R2},40:{n:"PtgMemNoMem",f:N2},41:{n:"PtgMemFunc",f:C2},42:{n:"PtgRefErr",f:A2},43:{n:"PtgAreaErr",f:KS},44:{n:"PtgRefN",f:s2},45:{n:"PtgAreaN",f:bS},46:{n:"PtgMemAreaN",f:$2},47:{n:"PtgMemNoMemN",f:J2},57:{n:"PtgNameX",f:E2},58:{n:"PtgRef3d",f:l2},59:{n:"PtgArea3d",f:YS},60:{n:"PtgRefErr3d",f:I2},61:{n:"PtgAreaErr3d",f:XS},255:{}},K2={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},X2={1:{n:"PtgElfLel",f:J1},2:{n:"PtgElfRw",f:B2},3:{n:"PtgElfCol",f:F2},6:{n:"PtgElfRwV",f:V2},7:{n:"PtgElfColV",f:D2},10:{n:"PtgElfRadical",f:L2},11:{n:"PtgElfRadicalS",f:U2},13:{n:"PtgElfColS",f:k2},15:{n:"PtgElfColSV",f:M2},16:{n:"PtgElfRadicalLel",f:O2},25:{n:"PtgList",f:H2},29:{n:"PtgSxName",f:W2},255:{}},b2={0:{n:"PtgAttrNoop",f:Y2},1:{n:"PtgAttrSemi",f:n2},2:{n:"PtgAttrIf",f:e2},4:{n:"PtgAttrChoose",f:ZS},8:{n:"PtgAttrGoto",f:jS},16:{n:"PtgAttrSum",f:c2},32:{n:"PtgAttrBaxcel",f:Gd},33:{n:"PtgAttrBaxcel",f:Gd},64:{n:"PtgAttrSpace",f:r2},65:{n:"PtgAttrSpaceSemi",f:i2},128:{n:"PtgAttrIfError",f:t2},255:{}};function Q2(e,t,n,r){if(r.biff<8)return Un(e,t);for(var i=e.l+t,o=[],s=0;s!==n.length;++s)switch(n[s][0]){case"PtgArray":n[s][1]=y2(e,0,r),o.push(n[s][1]);break;case"PtgMemArea":n[s][2]=_2(e,n[s][1],r),o.push(n[s][2]);break;case"PtgExp":r&&r.biff==12&&(n[s][1][1]=e.read_shift(4),o.push(n[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[s][0]}return t=i-e.l,t!==0&&o.push(Un(e,t)),o}function Z2(e,t,n){for(var r=e.l+t,i,o,s=[];r!=e.l;)t=r-e.l,o=e[e.l],i=Hd[o]||Hd[K2[o]],(o===24||o===25)&&(i=(o===24?X2:b2)[e[e.l+1]]),!i||!i.f?Un(e,t):s.push([i.n,i.f(e,t,n)]);return s}function j2(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],i=[],o=0;o<r.length;++o){var s=r[o];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var ew={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function tw(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Y1(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var i="";if(n.biff>8)switch(e[r[0]][0]){case 357:return i=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 358:return n.SID!=null?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[r[0]][0][3]?(i=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function Wd(e,t,n){var r=Y1(e,t,n);return r=="#REF"?r:tw(r,n)}function Ki(e,t,n,r,i){var o=i&&i.biff||8,s={s:{c:0,r:0}},l=[],u,f,d,h=0,p=0,m,v="";if(!e[0]||!e[0][0])return"";for(var g=-1,T="",_=0,x=e[0].length;_<x;++_){var y=e[0][_];switch(y[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=l.pop(),f=l.pop(),g>=0){switch(e[0][g][1][0]){case 0:T=be(" ",e[0][g][1][1]);break;case 1:T=be("\r",e[0][g][1][1]);break;default:if(T="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}f=f+T,g=-1}l.push(f+ew[y[0]]+u);break;case"PtgIsect":u=l.pop(),f=l.pop(),l.push(f+" "+u);break;case"PtgUnion":u=l.pop(),f=l.pop(),l.push(f+","+u);break;case"PtgRange":u=l.pop(),f=l.pop(),l.push(f+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Oo(y[1][1],s,i),l.push(Uo(d,o));break;case"PtgRefN":d=n?Oo(y[1][1],n,i):y[1][1],l.push(Uo(d,o));break;case"PtgRef3d":h=y[1][1],d=Oo(y[1][2],s,i),v=Wd(r,h,i),l.push(v+"!"+Uo(d,o));break;case"PtgFunc":case"PtgFuncVar":var C=y[1][0],k=y[1][1];C||(C=0),C&=127;var M=C==0?[]:l.slice(-C);l.length-=C,k==="User"&&(k=M.shift()),l.push(k+"("+M.join(",")+")");break;case"PtgBool":l.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(y[1]);break;case"PtgNum":l.push(String(y[1]));break;case"PtgStr":l.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(y[1]);break;case"PtgAreaN":m=Ad(y[1][1],n?{s:n}:s,i),l.push(iu(m,i));break;case"PtgArea":m=Ad(y[1][1],s,i),l.push(iu(m,i));break;case"PtgArea3d":h=y[1][1],m=y[1][2],v=Wd(r,h,i),l.push(v+"!"+iu(m,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=y[1][2];var R=(r.names||[])[p-1]||(r[0]||[])[p],D=R?R.Name:"SH33TJSNAME"+String(p);D&&D.slice(0,6)=="_xlfn."&&!i.xlfn&&(D=D.slice(6)),l.push(D);break;case"PtgNameX":var F=y[1][1];p=y[1][2];var U;if(i.biff<=5)F<0&&(F=-F),r[F]&&(U=r[F][p]);else{var q="";if(((r[F]||[])[0]||[])[0]==14849||(((r[F]||[])[0]||[])[0]==1025?r[F][p]&&r[F][p].itab>0&&(q=r.SheetNames[r[F][p].itab-1]+"!"):q=r.SheetNames[p-1]+"!"),r[F]&&r[F][p])q+=r[F][p].Name;else if(r[0]&&r[0][p])q+=r[0][p].Name;else{var K=(Y1(r,F,i)||"").split(";;");K[p-1]?q=K[p-1]:q+="SH33TJSERRX"}l.push(q);break}U||(U={Name:"SH33TJSERRY"}),l.push(U.Name);break;case"PtgParen":var ee="(",Te=")";if(g>=0){switch(T="",e[0][g][1][0]){case 2:ee=be(" ",e[0][g][1][1])+ee;break;case 3:ee=be("\r",e[0][g][1][1])+ee;break;case 4:Te=be(" ",e[0][g][1][1])+Te;break;case 5:Te=be("\r",e[0][g][1][1])+Te;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}l.push(ee+l.pop()+Te);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:y[1][1],r:y[1][0]};var ge={c:n.c,r:n.r};if(r.sharedf[De(d)]){var Ae=r.sharedf[De(d)];l.push(Ki(Ae,s,ge,r,i))}else{var Ne=!1;for(u=0;u!=r.arrayf.length;++u)if(f=r.arrayf[u],!(d.c<f[0].s.c||d.c>f[0].e.c)&&!(d.r<f[0].s.r||d.r>f[0].e.r)){l.push(Ki(f[1],s,ge,r,i)),Ne=!0;break}Ne||l.push(y[1])}break;case"PtgArray":l.push("{"+j2(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var ie=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&ie.indexOf(e[0][_][0])==-1){y=e[0][g];var he=!0;switch(y[1][0]){case 4:he=!1;case 0:T=be(" ",y[1][1]);break;case 5:he=!1;case 1:T=be("\r",y[1][1]);break;default:if(T="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}l.push((he?T:"")+l.pop()+(he?"":T)),g=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]}function nw(e){if(e==null){var t=J(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Zr(e);return Zr(0)}function rw(e,t,n,r,i){var o=jr(t,n,i),s=nw(e.v),l=J(6),u=33;l.write_shift(2,u),l.write_shift(4,0);for(var f=J(e.bf.length),d=0;d<e.bf.length;++d)f[d]=e.bf[d];var h=gt([o,s,l,f]);return h}function xa(e,t,n){var r=e.read_shift(4),i=Z2(e,r,n),o=e.read_shift(4),s=o>0?Q2(e,o,i,n):null;return[i,s]}var iw=xa,_a=xa,ow=xa,sw=xa,lw={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},K1={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},aw={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function uw(e){var t="of:="+e.replace(Ic,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function fw(e){return e.replace(/\./,"!")}var Bo=typeof Map<"u";function Pc(e,t,n){var r=0,i=e.length;if(n){if(Bo?n.has(t):Object.prototype.hasOwnProperty.call(n,t)){for(var o=Bo?n.get(t):n[t];r<o.length;++r)if(e[o[r]].t===t)return e.Count++,o[r]}}else for(;r<i;++r)if(e[r].t===t)return e.Count++,r;return e[i]={t},e.Count++,e.Unique++,n&&(Bo?(n.has(t)||n.set(t,[]),n.get(t).push(i)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(i))),i}function ya(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(Kn=t.MDW),t.width!=null?n.customWidth=1:t.wpx!=null?r=zl(t.wpx):t.wch!=null&&(r=t.wch),r>-1?(n.width=af(r),n.customWidth=1):t.width!=null&&(n.width=t.width),t.hidden&&(n.hidden=!0),t.level!=null&&(n.outlineLevel=n.level=t.level),n}function X1(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=n[0]),e.right==null&&(e.right=n[1]),e.top==null&&(e.top=n[2]),e.bottom==null&&(e.bottom=n[3]),e.header==null&&(e.header=n[4]),e.footer==null&&(e.footer=n[5])}}function kr(e,t,n){var r=n.revssf[t.z!=null?t.z:"General"],i=60,o=e.length;if(r==null&&n.ssf){for(;i<392;++i)if(n.ssf[i]==null){qg(t.z,i),n.ssf[i]=t.z,n.revssf[t.z]=r=i;break}}for(i=0;i!=o;++i)if(e[i].numFmtId===r)return i;return e[o]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function cw(e,t,n){if(e&&e["!ref"]){var r=He(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}function dw(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+tt(e[n])+'"/>';return t+"</mergeCells>"}function hw(e,t,n,r,i){var o=!1,s={},l=null;if(r.bookType!=="xlsx"&&t.vbaraw){var u=t.SheetNames[n];try{t.Workbook&&(u=t.Workbook.Sheets[n].CodeName||u)}catch{}o=!0,s.codeName=ss(ke(u))}if(e&&e["!outline"]){var f={summaryBelow:1,summaryRight:1};e["!outline"].above&&(f.summaryBelow=0),e["!outline"].left&&(f.summaryRight=0),l=(l||"")+te("outlinePr",null,f)}!o&&!l||(i[i.length]=te("sheetPr",l,s))}var pw=["objects","scenarios","selectLockedCells","selectUnlockedCells"],mw=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function gw(e){var t={sheet:1};return pw.forEach(function(n){e[n]!=null&&e[n]&&(t[n]="1")}),mw.forEach(function(n){e[n]!=null&&!e[n]&&(t[n]="0")}),e.password&&(t.password=k1(e.password).toString(16).toUpperCase()),te("sheetProtection",null,t)}function vw(e){return X1(e),te("pageMargins",null,e)}function xw(e,t){for(var n=["<cols>"],r,i=0;i!=t.length;++i)(r=t[i])&&(n[n.length]=te("col",null,ya(i,r)));return n[n.length]="</cols>",n.join("")}function _w(e,t,n,r){var i=typeof e.ref=="string"?e.ref:tt(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,s=tn(i);s.s.r==s.e.r&&(s.e.r=tn(t["!ref"]).e.r,i=tt(s));for(var l=0;l<o.length;++l){var u=o[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==r){u.Ref="'"+n.SheetNames[r]+"'!"+i;break}}return l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),te("autoFilter",null,{ref:i})}function yw(e,t,n,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),te("sheetViews",te("sheetView",null,i),{})}function Tw(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",o=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=xs[e.v];break;case"d":r&&r.cellDates?i=Ot(e.v,-1).toISOString():(e=Jt(e),e.t="n",i=""+(e.v=$t(Ot(e.v)))),typeof e.z>"u"&&(e.z=Qe[14]);break;default:i=e.v;break}var l=vt("v",ke(i)),u={r:t},f=kr(r.cellXfs,e,r);switch(f!==0&&(u.s=f),e.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){l=vt("v",""+Pc(r.Strings,e.v,r.revStrings)),u.t="s";break}u.t="str";break}if(e.t!=o&&(e.t=o,e.v=s),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=te("f",ke(e.f),d)+(e.v!=null?l:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(u.cm=1),te("c",l,u)}function Ew(e,t,n,r){var i=[],o=[],s=He(e["!ref"]),l="",u,f="",d=[],h=0,p=0,m=e["!rows"],v=Array.isArray(e),g={r:f},T,_=-1;for(p=s.s.c;p<=s.e.c;++p)d[p]=It(p);for(h=s.s.r;h<=s.e.r;++h){for(o=[],f=_t(h),p=s.s.c;p<=s.e.c;++p){u=d[p]+f;var x=v?(e[h]||[])[p]:e[u];x!==void 0&&(l=Tw(x,u,e,t))!=null&&o.push(l)}(o.length>0||m&&m[h])&&(g={r:f},m&&m[h]&&(T=m[h],T.hidden&&(g.hidden=1),_=-1,T.hpx?_=ql(T.hpx):T.hpt&&(_=T.hpt),_>-1&&(g.ht=_,g.customHeight=1),T.level&&(g.outlineLevel=T.level)),i[i.length]=te("row",o.join(""),g))}if(m)for(;h<m.length;++h)m&&m[h]&&(g={r:h+1},T=m[h],T.hidden&&(g.hidden=1),_=-1,T.hpx?_=ql(T.hpx):T.hpt&&(_=T.hpt),_>-1&&(g.ht=_,g.customHeight=1),T.level&&(g.outlineLevel=T.level),i[i.length]=te("row","",g));return i.join("")}function b1(e,t,n,r){var i=[nt,te("worksheet",null,{xmlns:Zi[0],"xmlns:r":at.r})],o=n.SheetNames[e],s=0,l="",u=n.Sheets[o];u==null&&(u={});var f=u["!ref"]||"A1",d=He(f);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),f=tt(d)}r||(r={}),u["!comments"]=[];var h=[];hw(u,n,e,t,i),i[i.length]=te("dimension",null,{ref:f}),i[i.length]=yw(u,t,e,n),t.sheetFormat&&(i[i.length]=te("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(i[i.length]=xw(u,u["!cols"])),i[s=i.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(l=Ew(u,t),l.length>0&&(i[i.length]=l)),i.length>s+1&&(i[i.length]="</sheetData>",i[s]=i[s].replace("/>",">")),u["!protect"]&&(i[i.length]=gw(u["!protect"])),u["!autofilter"]!=null&&(i[i.length]=_w(u["!autofilter"],u,n,e)),u["!merges"]!=null&&u["!merges"].length>0&&(i[i.length]=dw(u["!merges"]));var p=-1,m,v=-1;return u["!links"].length>0&&(i[i.length]="<hyperlinks>",u["!links"].forEach(function(g){g[1].Target&&(m={ref:g[0]},g[1].Target.charAt(0)!="#"&&(v=Fe(r,-1,ke(g[1].Target).replace(/#.*$/,""),we.HLINK),m["r:id"]="rId"+v),(p=g[1].Target.indexOf("#"))>-1&&(m.location=ke(g[1].Target.slice(p+1))),g[1].Tooltip&&(m.tooltip=ke(g[1].Tooltip)),i[i.length]=te("hyperlink",null,m))}),i[i.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(i[i.length]=vw(u["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=vt("ignoredErrors",te("ignoredError",null,{numberStoredAsText:1,sqref:f}))),h.length>0&&(v=Fe(r,-1,"../drawings/drawing"+(e+1)+".xml",we.DRAW),i[i.length]=te("drawing",null,{"r:id":"rId"+v}),u["!drawing"]=h),u["!comments"].length>0&&(v=Fe(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",we.VML),i[i.length]=te("legacyDrawing",null,{"r:id":"rId"+v}),u["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function Sw(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=r,o&7&&(n.level=o&7),o&16&&(n.hidden=!0),o&32&&(n.hpt=i/20),n}function ww(e,t,n){var r=J(145),i=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var o=320;i.hpx?o=ql(i.hpx)*20:i.hpt&&(o=i.hpt*20),r.write_shift(2,o),r.write_shift(1,0);var s=0;i.level&&(s|=i.level),i.hidden&&(s|=16),(i.hpx||i.hpt)&&(s|=32),r.write_shift(1,s),r.write_shift(1,0);var l=0,u=r.l;r.l+=4;for(var f={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var h=-1,p=-1,m=d<<10;m<d+1<<10;++m){f.c=m;var v=Array.isArray(n)?(n[f.r]||[])[f.c]:n[De(f)];v&&(h<0&&(h=m),p=m)}h<0||(++l,r.write_shift(4,h),r.write_shift(4,p))}var g=r.l;return r.l=u,r.write_shift(4,l),r.l=g,r.length>r.l?r.slice(0,r.l):r}function Cw(e,t,n,r){var i=ww(r,n,t);(i.length>17||(t["!rows"]||[])[r])&&b(e,0,i)}var Aw=si,Iw=eo;function Rw(){}function Nw(e,t){var n={},r=e[e.l];return++e.l,n.above=!(r&64),n.left=!(r&128),e.l+=18,n.name=VT(e),n}function Pw(e,t,n){n==null&&(n=J(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var i=1;i<3;++i)n.write_shift(1,0);return Gl({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),c1(e,n),n.slice(0,n.l)}function Fw(e){var t=mn(e);return[t]}function kw(e,t,n){return n==null&&(n=J(8)),ri(t,n)}function Mw(e){var t=ii(e);return[t]}function Dw(e,t,n){return n==null&&(n=J(4)),oi(t,n)}function Lw(e){var t=mn(e),n=e.read_shift(1);return[t,n,"b"]}function Ow(e,t,n){return n==null&&(n=J(9)),ri(t,n),n.write_shift(1,e.v?1:0),n}function Uw(e){var t=ii(e),n=e.read_shift(1);return[t,n,"b"]}function Bw(e,t,n){return n==null&&(n=J(5)),oi(t,n),n.write_shift(1,e.v?1:0),n}function Vw(e){var t=mn(e),n=e.read_shift(1);return[t,n,"e"]}function Gw(e,t,n){return n==null&&(n=J(9)),ri(t,n),n.write_shift(1,e.v),n}function Hw(e){var t=ii(e),n=e.read_shift(1);return[t,n,"e"]}function Ww(e,t,n){return n==null&&(n=J(8)),oi(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}function zw(e){var t=mn(e),n=e.read_shift(4);return[t,n,"s"]}function qw(e,t,n){return n==null&&(n=J(12)),ri(t,n),n.write_shift(4,t.v),n}function $w(e){var t=ii(e),n=e.read_shift(4);return[t,n,"s"]}function Jw(e,t,n){return n==null&&(n=J(8)),oi(t,n),n.write_shift(4,t.v),n}function Yw(e){var t=mn(e),n=to(e);return[t,n,"n"]}function Kw(e,t,n){return n==null&&(n=J(16)),ri(t,n),Zr(e.v,n),n}function Xw(e){var t=ii(e),n=to(e);return[t,n,"n"]}function bw(e,t,n){return n==null&&(n=J(12)),oi(t,n),Zr(e.v,n),n}function Qw(e){var t=mn(e),n=d1(e);return[t,n,"n"]}function Zw(e,t,n){return n==null&&(n=J(12)),ri(t,n),h1(e.v,n),n}function jw(e){var t=ii(e),n=d1(e);return[t,n,"n"]}function eC(e,t,n){return n==null&&(n=J(8)),oi(t,n),h1(e.v,n),n}function tC(e){var t=mn(e),n=Ec(e);return[t,n,"is"]}function nC(e){var t=mn(e),n=Rt(e);return[t,n,"str"]}function rC(e,t,n){return n==null&&(n=J(12+4*e.v.length)),ri(t,n),ft(e.v,n),n.length>n.l?n.slice(0,n.l):n}function iC(e){var t=ii(e),n=Rt(e);return[t,n,"str"]}function oC(e,t,n){return n==null&&(n=J(8+4*e.v.length)),oi(t,n),ft(e.v,n),n.length>n.l?n.slice(0,n.l):n}function sC(e,t,n){var r=e.l+t,i=mn(e);i.r=n["!row"];var o=e.read_shift(1),s=[i,o,"b"];if(n.cellFormula){e.l+=2;var l=_a(e,r-e.l,n);s[3]=Ki(l,null,i,n.supbooks,n)}else e.l=r;return s}function lC(e,t,n){var r=e.l+t,i=mn(e);i.r=n["!row"];var o=e.read_shift(1),s=[i,o,"e"];if(n.cellFormula){e.l+=2;var l=_a(e,r-e.l,n);s[3]=Ki(l,null,i,n.supbooks,n)}else e.l=r;return s}function aC(e,t,n){var r=e.l+t,i=mn(e);i.r=n["!row"];var o=to(e),s=[i,o,"n"];if(n.cellFormula){e.l+=2;var l=_a(e,r-e.l,n);s[3]=Ki(l,null,i,n.supbooks,n)}else e.l=r;return s}function uC(e,t,n){var r=e.l+t,i=mn(e);i.r=n["!row"];var o=Rt(e),s=[i,o,"str"];if(n.cellFormula){e.l+=2;var l=_a(e,r-e.l,n);s[3]=Ki(l,null,i,n.supbooks,n)}else e.l=r;return s}var fC=si,cC=eo;function dC(e,t){return t==null&&(t=J(4)),t.write_shift(4,e),t}function hC(e,t){var n=e.l+t,r=si(e),i=Sc(e),o=Rt(e),s=Rt(e),l=Rt(e);e.l=n;var u={rfx:r,relId:i,loc:o,display:l};return s&&(u.Tooltip=s),u}function pC(e,t){var n=J(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));eo({s:ut(e[0]),e:ut(e[0])},n),wc("rId"+t,n);var r=e[1].Target.indexOf("#"),i=r==-1?"":e[1].Target.slice(r+1);return ft(i||"",n),ft(e[1].Tooltip||"",n),ft("",n),n.slice(0,n.l)}function mC(){}function gC(e,t,n){var r=e.l+t,i=p1(e),o=e.read_shift(1),s=[i];if(s[2]=o,n.cellFormula){var l=iw(e,r-e.l,n);s[1]=l}else e.l=r;return s}function vC(e,t,n){var r=e.l+t,i=si(e),o=[i];if(n.cellFormula){var s=sw(e,r-e.l,n);o[1]=s,e.l=r}else e.l=r;return o}function xC(e,t,n){n==null&&(n=J(18));var r=ya(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,(r.width||10)*256),n.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),n.write_shift(2,i),n}var Q1=["left","right","top","bottom","header","footer"];function _C(e){var t={};return Q1.forEach(function(n){t[n]=to(e)}),t}function yC(e,t){return t==null&&(t=J(6*8)),X1(e),Q1.forEach(function(n){Zr(e[n],t)}),t}function TC(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function EC(e,t,n){n==null&&(n=J(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function SC(e){var t=J(24);return t.write_shift(4,4),t.write_shift(4,1),eo(e,t),t}function wC(e,t){return t==null&&(t=J(16*4+2)),t.write_shift(2,e.password?k1(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?t.write_shift(4,e[n[0]]!=null&&!e[n[0]]?1:0):t.write_shift(4,e[n[0]]!=null&&e[n[0]]?0:1)}),t}function CC(){}function AC(){}function IC(e,t,n,r,i,o,s){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=Jt(t),t.z=t.z||Qe[14],t.v=$t(Ot(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var u={r:n,c:r};switch(u.s=kr(i.cellXfs,t,i),t.l&&o["!links"].push([De(u),t.l]),t.c&&o["!comments"].push([De(u),t.c]),t.t){case"s":case"str":return i.bookSST?(l=Pc(i.Strings,t.v,i.revStrings),u.t="s",u.v=l,s?b(e,18,Jw(t,u)):b(e,7,qw(t,u))):(u.t="str",s?b(e,17,oC(t,u)):b(e,6,rC(t,u))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?b(e,13,eC(t,u)):b(e,2,Zw(t,u)):s?b(e,16,bw(t,u)):b(e,5,Kw(t,u)),!0;case"b":return u.t="b",s?b(e,15,Bw(t,u)):b(e,4,Ow(t,u)),!0;case"e":return u.t="e",s?b(e,14,Ww(t,u)):b(e,3,Gw(t,u)),!0}return s?b(e,12,Dw(t,u)):b(e,1,kw(t,u)),!0}function RC(e,t,n,r){var i=He(t["!ref"]||"A1"),o,s="",l=[];b(e,145);var u=Array.isArray(t),f=i.e.r;t["!rows"]&&(f=Math.max(i.e.r,t["!rows"].length-1));for(var d=i.s.r;d<=f;++d){s=_t(d),Cw(e,t,i,d);var h=!1;if(d<=i.e.r)for(var p=i.s.c;p<=i.e.c;++p){d===i.s.r&&(l[p]=It(p)),o=l[p]+s;var m=u?(t[d]||[])[p]:t[o];if(!m){h=!1;continue}h=IC(e,m,d,p,r,t,h)}}b(e,146)}function NC(e,t){!t||!t["!merges"]||(b(e,177,dC(t["!merges"].length)),t["!merges"].forEach(function(n){b(e,176,cC(n))}),b(e,178))}function PC(e,t){!t||!t["!cols"]||(b(e,390),t["!cols"].forEach(function(n,r){n&&b(e,60,xC(r,n))}),b(e,391))}function FC(e,t){!t||!t["!ref"]||(b(e,648),b(e,649,SC(He(t["!ref"]))),b(e,650))}function kC(e,t,n){t["!links"].forEach(function(r){if(r[1].Target){var i=Fe(n,-1,r[1].Target.replace(/#.*$/,""),we.HLINK);b(e,494,pC(r,i))}}),delete t["!links"]}function MC(e,t,n,r){if(t["!comments"].length>0){var i=Fe(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",we.VML);b(e,551,wc("rId"+i)),t["!legacy"]=i}}function DC(e,t,n,r){if(t["!autofilter"]){var i=t["!autofilter"],o=typeof i.ref=="string"?i.ref:tt(i.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,l=tn(o);l.s.r==l.e.r&&(l.e.r=tn(t["!ref"]).e.r,o=tt(l));for(var u=0;u<s.length;++u){var f=s[u];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==r){f.Ref="'"+n.SheetNames[r]+"'!"+o;break}}u==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+o}),b(e,161,eo(He(o))),b(e,162)}}function LC(e,t,n){b(e,133),b(e,137,EC(t,n)),b(e,138),b(e,134)}function OC(e,t){t["!protect"]&&b(e,535,wC(t["!protect"]))}function UC(e,t,n,r){var i=qt(),o=n.SheetNames[e],s=n.Sheets[o]||{},l=o;try{n&&n.Workbook&&(l=n.Workbook.Sheets[e].CodeName||l)}catch{}var u=He(s["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],b(i,129),(n.vbaraw||s["!outline"])&&b(i,147,Pw(l,s["!outline"])),b(i,148,Iw(u)),LC(i,s,n.Workbook),PC(i,s),RC(i,s,e,t),OC(i,s),DC(i,s,n,e),NC(i,s),kC(i,s,r),s["!margins"]&&b(i,476,yC(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&FC(i,s),MC(i,s,e,r),b(i,130),i.end()}function BC(e,t){e.l+=10;var n=Rt(e);return{name:n}}var VC=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function GC(e){return!e.Workbook||!e.Workbook.WBProps?"false":vT(e.Workbook.WBProps.date1904)?"true":"false"}var HC="][*?/\\".split("");function Z1(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return HC.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}function WC(e,t,n){e.forEach(function(r,i){Z1(r);for(var o=0;o<i;++o)if(r==e[o])throw new Error("Duplicate Sheet Name: "+r);if(n){var s=t&&t[i]&&t[i].CodeName||r;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function zC(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];WC(e.SheetNames,t,!!e.vbaraw);for(var n=0;n<e.SheetNames.length;++n)cw(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}function j1(e){var t=[nt];t[t.length]=te("workbook",null,{xmlns:Zi[0],"xmlns:r":at.r});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(VC.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(r[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=te("workbookPr",null,r);var i=e.Workbook&&e.Workbook.Sheets||[],o=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",o=0;o!=e.SheetNames.length&&!(!i[o]||!i[o].Hidden);++o);o==e.SheetNames.length&&(o=0),t[t.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",o=0;o!=e.SheetNames.length;++o){var s={name:ke(e.SheetNames[o].slice(0,31))};if(s.sheetId=""+(o+1),s["r:id"]="rId"+(o+1),i[o])switch(i[o].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=te("sheet",null,s)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var u={name:l.Name};l.Comment&&(u.comment=l.Comment),l.Sheet!=null&&(u.localSheetId=""+l.Sheet),l.Hidden&&(u.hidden="1"),l.Ref&&(t[t.length]=te("definedName",ke(l.Ref),u))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function qC(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=lf(e),n.name=Rt(e),n}function $C(e,t){return t||(t=J(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),wc(e.strRelID,t),ft(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function JC(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var i=t>8?Rt(e):"";return i.length>0&&(n.CodeName=i),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function YC(e,t){t||(t=J(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),c1(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function KC(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),o=GT(e),s=ow(e,0,n),l=Sc(e);e.l=r;var u={Name:o,Ptg:s};return i<268435455&&(u.Sheet=i),l&&(u.Comment=l),u}function XC(e,t){b(e,143);for(var n=0;n!=t.SheetNames.length;++n){var r=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,i={Hidden:r,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]};b(e,156,$C(i))}b(e,144)}function bC(e,t){t||(t=J(127));for(var n=0;n!=4;++n)t.write_shift(4,0);return ft("SheetJS",t),ft(kl.version,t),ft(kl.version,t),ft("7262",t),t.length>t.l?t.slice(0,t.l):t}function QC(e,t){t||(t=J(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var n=120;return t.write_shift(1,n),t.length>t.l?t.slice(0,t.l):t}function ZC(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var n=t.Workbook.Sheets,r=0,i=-1,o=-1;r<n.length;++r)!n[r]||!n[r].Hidden&&i==-1?i=r:n[r].Hidden==1&&o==-1&&(o=r);o>i||(b(e,135),b(e,158,QC(i)),b(e,136))}}function jC(e,t){var n=qt();return b(n,131),b(n,128,bC()),b(n,153,YC(e.Workbook&&e.Workbook.WBProps||null)),ZC(n,e),XC(n,e),b(n,132),n.end()}function eA(e,t,n){return(t.slice(-4)===".bin"?jC:j1)(e)}function tA(e,t,n,r,i){return(t.slice(-4)===".bin"?UC:b1)(e,n,r,i)}function nA(e,t,n){return(t.slice(-4)===".bin"?yS:L1)(e,n)}function rA(e,t,n){return(t.slice(-4)===".bin"?YE:F1)(e,n)}function iA(e,t,n){return(t.slice(-4)===".bin"?OS:G1)(e)}function oA(e){return(e.slice(-4)===".bin"?RS:B1)()}function sA(e,t){var n=[];return e.Props&&n.push(nE(e.Props,t)),e.Custprops&&n.push(rE(e.Props,e.Custprops)),n.join("")}function lA(){return""}function aA(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(r,i){var o=[];o.push(te("NumberFormat",null,{"ss:Format":ke(Qe[r.numFmtId])}));var s={"ss:ID":"s"+(21+i)};n.push(te("Style",o.join(""),s))}),te("Styles",n.join(""))}function ev(e){return te("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Rc(e.Ref,{r:0,c:0})})}function uA(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var i=t[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||n.push(ev(i)))}return te("Names",n.join(""))}function fA(e,t,n,r){if(!e||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,o=[],s=0;s<i.length;++s){var l=i[s];l.Sheet==n&&(l.Name.match(/^_xlfn\./)||o.push(ev(l)))}return o.join("")}function cA(e,t,n,r){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(te("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(te("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(te("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)i.push(te("Visible",r.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<n&&!(r.Workbook.Sheets[o]&&!r.Workbook.Sheets[o].Hidden);++o);o==n&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(vt("ProtectContents","True")),e["!protect"].objects&&i.push(vt("ProtectObjects","True")),e["!protect"].scenarios&&i.push(vt("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(vt("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(vt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&i.push("<"+s[1]+"/>")})),i.length==0?"":te("WorksheetOptions",i.join(""),{xmlns:bt.x})}function dA(e){return e.map(function(t){var n=gT(t.t||""),r=te("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return te("Comment",r,{"ss:Author":t.a})}).join("")}function hA(e,t,n,r,i,o,s){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+ke(Rc(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var u=ut(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(u.r==s.r?"":"["+(u.r-s.r)+"]")+"C"+(u.c==s.c?"":"["+(u.c-s.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=ke(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=ke(e.l.Tooltip))),n["!merges"])for(var f=n["!merges"],d=0;d!=f.length;++d)f[d].s.c!=s.c||f[d].s.r!=s.r||(f[d].e.c>f[d].s.c&&(l["ss:MergeAcross"]=f[d].e.c-f[d].s.c),f[d].e.r>f[d].s.r&&(l["ss:MergeDown"]=f[d].e.r-f[d].s.r));var h="",p="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":h="Number",p=String(e.v);break;case"b":h="Boolean",p=e.v?"1":"0";break;case"e":h="Error",p=xs[e.v];break;case"d":h="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Qe[14]);break;case"s":h="String",p=mT(e.v||"");break}var m=kr(r.cellXfs,e,r);l["ss:StyleID"]="s"+(21+m),l["ss:Index"]=s.c+1;var v=e.v!=null?p:"",g=e.t=="z"?"":'<Data ss:Type="'+h+'">'+v+"</Data>";return(e.c||[]).length>0&&(g+=dA(e.c)),te("Cell",g,l)}function pA(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=D1(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function mA(e,t,n,r){if(!e["!ref"])return"";var i=He(e["!ref"]),o=e["!merges"]||[],s=0,l=[];e["!cols"]&&e["!cols"].forEach(function(T,_){Ac(T);var x=!!T.width,y=ya(_,T),C={"ss:Index":_+1};x&&(C["ss:Width"]=Wl(y.width)),T.hidden&&(C["ss:Hidden"]="1"),l.push(te("Column",null,C))});for(var u=Array.isArray(e),f=i.s.r;f<=i.e.r;++f){for(var d=[pA(f,(e["!rows"]||[])[f])],h=i.s.c;h<=i.e.c;++h){var p=!1;for(s=0;s!=o.length;++s)if(!(o[s].s.c>h)&&!(o[s].s.r>f)&&!(o[s].e.c<h)&&!(o[s].e.r<f)){(o[s].s.c!=h||o[s].s.r!=f)&&(p=!0);break}if(!p){var m={r:f,c:h},v=De(m),g=u?(e[f]||[])[h]:e[v];d.push(hA(g,v,e,t,n,r,m))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function gA(e,t,n){var r=[],i=n.SheetNames[e],o=n.Sheets[i],s=o?fA(o,t,e,n):"";return s.length>0&&r.push("<Names>"+s+"</Names>"),s=o?mA(o,t,e,n):"",s.length>0&&r.push("<Table>"+s+"</Table>"),r.push(cA(o,t,e,n)),r.join("")}function vA(e,t){t||(t={}),e.SSF||(e.SSF=Jt(Qe)),e.SSF&&(ma(),pa(e.SSF),t.revssf=ga(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],kr(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(sA(e,t)),n.push(lA()),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(te("Worksheet",gA(r,t,e),{"ss:Name":ke(e.SheetNames[r])}));return n[2]=aA(e,t),n[3]=uA(e),nt+te("Workbook",n.join(""),{xmlns:bt.ss,"xmlns:o":bt.o,"xmlns:x":bt.x,"xmlns:ss":bt.ss,"xmlns:dt":bt.dt,"xmlns:html":bt.html})}var lu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function xA(e,t){var n=[],r=[],i=[],o=0,s,l=md(Rd,"n"),u=md(Nd,"n");if(e.Props)for(s=Tt(e.Props),o=0;o<s.length;++o)(Object.prototype.hasOwnProperty.call(l,s[o])?n:Object.prototype.hasOwnProperty.call(u,s[o])?r:i).push([s[o],e.Props[s[o]]]);if(e.Custprops)for(s=Tt(e.Custprops),o=0;o<s.length;++o)Object.prototype.hasOwnProperty.call(e.Props||{},s[o])||(Object.prototype.hasOwnProperty.call(l,s[o])?n:Object.prototype.hasOwnProperty.call(u,s[o])?r:i).push([s[o],e.Custprops[s[o]]]);var f=[];for(o=0;o<i.length;++o)w1.indexOf(i[o][0])>-1||T1.indexOf(i[o][0])>-1||i[o][1]!=null&&f.push(i[o]);r.length&&Le.utils.cfb_add(t,"/SummaryInformation",Dd(r,lu.SI,u,Nd)),(n.length||f.length)&&Le.utils.cfb_add(t,"/DocumentSummaryInformation",Dd(n,lu.DSI,l,Rd,f.length?f:null,lu.UDI))}function _A(e,t){var n=t||{},r=Le.utils.cfb_new({root:"R"}),i="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":i="/Workbook",n.biff=8;break;case"biff5":i="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return Le.utils.cfb_add(r,i,tv(e,n)),n.biff==8&&(e.Props||e.Custprops)&&xA(e,r),n.biff==8&&e.vbaraw&&US(r,Le.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),r}var yA={0:{f:Sw},1:{f:Fw},2:{f:Qw},3:{f:Vw},4:{f:Lw},5:{f:Yw},6:{f:nC},7:{f:zw},8:{f:uC},9:{f:aC},10:{f:sC},11:{f:lC},12:{f:Mw},13:{f:jw},14:{f:Hw},15:{f:Uw},16:{f:Xw},17:{f:iC},18:{f:$w},19:{f:Ec},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:KC},40:{},42:{},43:{f:nS},44:{f:eS},45:{f:oS},46:{f:lS},47:{f:sS},48:{},49:{f:MT},50:{},51:{f:SS},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:DE},62:{f:tC},63:{f:NS},64:{f:CC},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Un,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:TC},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Nw},148:{f:Aw,p:16},151:{f:mC},152:{},153:{f:JC},154:{},155:{},156:{f:qC},157:{},158:{},159:{T:1,f:qE},160:{T:-1},161:{T:1,f:si},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:fC},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:TS},336:{T:-1},337:{f:AS,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:lf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:RE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:gC},427:{f:vC},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:_C},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Rw},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:hC},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:lf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:DS},633:{T:1},634:{T:-1},635:{T:1,f:kS},636:{T:-1},637:{f:UT},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:BC},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:AC},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ne(e,t,n,r){var i=t;if(!isNaN(i)){var o=r||(n||[]).length||0,s=e.next(4);s.write_shift(2,i),s.write_shift(2,o),o>0&&_c(n)&&e.push(n)}}function TA(e,t,n,r){var i=(n||[]).length||0;if(i<=8224)return ne(e,t,n,i);var o=t;if(!isNaN(o)){for(var s=n.parts||[],l=0,u=0,f=0;f+(s[l]||8224)<=8224;)f+=s[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,o),d.write_shift(2,f),e.push(n.slice(u,u+f)),u+=f;u<i;){for(d=e.next(4),d.write_shift(2,60),f=0;f+(s[l]||8224)<=8224;)f+=s[l]||8224,l++;d.write_shift(2,f),e.push(n.slice(u,u+f)),u+=f}}}function ys(e,t,n){return e||(e=J(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function EA(e,t,n,r){var i=J(9);return ys(i,e,t),A1(n,r||"b",i),i}function SA(e,t,n){var r=J(8+2*n.length);return ys(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function wA(e,t,n,r){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?$t(Ot(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?ne(e,2,BE(n,r,i)):ne(e,3,UE(n,r,i));return;case"b":case"e":ne(e,5,EA(n,r,t.v,t.t));return;case"s":case"str":ne(e,4,SA(n,r,(t.v||"").slice(0,255)));return}ne(e,1,ys(null,n,r))}function CA(e,t,n,r){var i=Array.isArray(t),o=He(t["!ref"]||"A1"),s,l="",u=[];if(o.e.c>255||o.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),s=tt(o)}for(var f=o.s.r;f<=o.e.r;++f){l=_t(f);for(var d=o.s.c;d<=o.e.c;++d){f===o.s.r&&(u[d]=It(d)),s=u[d]+l;var h=i?(t[f]||[])[d]:t[s];h&&wA(e,h,f,d)}}}function AA(e,t){for(var n=t||{},r=qt(),i=0,o=0;o<e.SheetNames.length;++o)e.SheetNames[o]==n.sheet&&(i=o);if(i==0&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return ne(r,n.biff==4?1033:n.biff==3?521:9,Cc(e,16,n)),CA(r,e.Sheets[e.SheetNames[i]],i,n),ne(r,10),r.end()}function IA(e,t,n){ne(e,49,yE({sz:12,name:"Arial"},n))}function RA(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&ne(e,1054,SE(i,t[i],n))})}function NA(e,t){var n=J(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),ne(e,2151,n),n=J(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),N1(He(t["!ref"]||"A1"),n),n.write_shift(4,4),ne(e,2152,n)}function PA(e,t){for(var n=0;n<16;++n)ne(e,224,Od({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(r){ne(e,224,Od(r,0,t))})}function FA(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];ne(e,440,FE(r)),r[1].Tooltip&&ne(e,2048,kE(r))}delete t["!links"]}function kA(e,t){if(t){var n=0;t.forEach(function(r,i){++n<=256&&r&&ne(e,125,LE(ya(i,r),i))})}}function MA(e,t,n,r,i){var o=16+kr(i.cellXfs,t,i);if(t.v==null&&!t.bf){ne(e,513,jr(n,r,o));return}if(t.bf)ne(e,6,rw(t,n,r,i,o));else switch(t.t){case"d":case"n":var s=t.t=="d"?$t(Ot(t.v)):t.v;ne(e,515,IE(n,r,s,o));break;case"b":case"e":ne(e,517,AE(n,r,t.v,o,i,t.t));break;case"s":case"str":if(i.bookSST){var l=Pc(i.Strings,t.v,i.revStrings);ne(e,253,TE(n,r,l,o))}else ne(e,516,EE(n,r,(t.v||"").slice(0,255),o,i));break;default:ne(e,513,jr(n,r,o))}}function DA(e,t,n){var r=qt(),i=n.SheetNames[e],o=n.Sheets[i]||{},s=(n||{}).Workbook||{},l=(s.Sheets||[])[e]||{},u=Array.isArray(o),f=t.biff==8,d,h="",p=[],m=He(o["!ref"]||"A1"),v=f?65536:16384;if(m.e.c>255||m.e.r>=v){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,v-1)}ne(r,2057,Cc(n,16,t)),ne(r,13,ln(1)),ne(r,12,ln(100)),ne(r,15,Mt(!0)),ne(r,17,Mt(!1)),ne(r,16,Zr(.001)),ne(r,95,Mt(!0)),ne(r,42,Mt(!1)),ne(r,43,Mt(!1)),ne(r,130,ln(1)),ne(r,128,CE()),ne(r,131,Mt(!1)),ne(r,132,Mt(!1)),f&&kA(r,o["!cols"]),ne(r,512,wE(m,t)),f&&(o["!links"]=[]);for(var g=m.s.r;g<=m.e.r;++g){h=_t(g);for(var T=m.s.c;T<=m.e.c;++T){g===m.s.r&&(p[T]=It(T)),d=p[T]+h;var _=u?(o[g]||[])[T]:o[d];_&&(MA(r,_,g,T,t),f&&_.l&&o["!links"].push([d,_.l]))}}var x=l.CodeName||l.name||i;return f&&ne(r,574,_E((s.Views||[])[0])),f&&(o["!merges"]||[]).length&&ne(r,229,PE(o["!merges"])),f&&FA(r,o),ne(r,442,R1(x)),f&&NA(r,o),ne(r,10),r.end()}function LA(e,t,n){var r=qt(),i=(e||{}).Workbook||{},o=i.Sheets||[],s=i.WBProps||{},l=n.biff==8,u=n.biff==5;if(ne(r,2057,Cc(e,5,n)),n.bookType=="xla"&&ne(r,135),ne(r,225,l?ln(1200):null),ne(r,193,sE(2)),u&&ne(r,191),u&&ne(r,192),ne(r,226),ne(r,92,mE("SheetJS",n)),ne(r,66,ln(l?1200:1252)),l&&ne(r,353,ln(0)),l&&ne(r,448),ne(r,317,OE(e.SheetNames.length)),l&&e.vbaraw&&ne(r,211),l&&e.vbaraw){var f=s.CodeName||"ThisWorkbook";ne(r,442,R1(f))}ne(r,156,ln(17)),ne(r,25,Mt(!1)),ne(r,18,Mt(!1)),ne(r,19,ln(0)),l&&ne(r,431,Mt(!1)),l&&ne(r,444,ln(0)),ne(r,61,xE()),ne(r,64,Mt(!1)),ne(r,141,ln(0)),ne(r,34,Mt(GC(e)=="true")),ne(r,14,Mt(!0)),l&&ne(r,439,Mt(!1)),ne(r,218,ln(0)),IA(r,e,n),RA(r,e.SSF,n),PA(r,n),l&&ne(r,352,Mt(!1));var d=r.end(),h=qt();l&&ne(h,140,ME()),l&&n.Strings&&TA(h,252,vE(n.Strings)),ne(h,10);var p=h.end(),m=qt(),v=0,g=0;for(g=0;g<e.SheetNames.length;++g)v+=(l?12:11)+(l?2:1)*e.SheetNames[g].length;var T=d.length+v+p.length;for(g=0;g<e.SheetNames.length;++g){var _=o[g]||{};ne(m,133,gE({pos:T,hs:_.Hidden||0,dt:0,name:e.SheetNames[g]},n)),T+=t[g].length}var x=m.end();if(v!=x.length)throw new Error("BS8 "+v+" != "+x.length);var y=[];return d.length&&y.push(d),x.length&&y.push(x),p.length&&y.push(p),gt(y)}function OA(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=Jt(Qe)),e&&e.SSF&&(ma(),pa(e.SSF),n.revssf=ga(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,Fc(n),n.cellXfs=[],kr(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)r[r.length]=DA(i,n,e);return r.unshift(LA(e,r,n)),gt(r)}function tv(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(!(!r||!r["!ref"])){var i=tn(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var o=t||{};switch(o.biff||2){case 8:case 5:return OA(e,t);case 4:case 3:case 2:return AA(e,t)}throw new Error("invalid type "+o.bookType+" for BIFF")}function UA(e,t,n,r){for(var i=e["!merges"]||[],o=[],s=t.s.c;s<=t.e.c;++s){for(var l=0,u=0,f=0;f<i.length;++f)if(!(i[f].s.r>n||i[f].s.c>s)&&!(i[f].e.r<n||i[f].e.c<s)){if(i[f].s.r<n||i[f].s.c<s){l=-1;break}l=i[f].e.r-i[f].s.r+1,u=i[f].e.c-i[f].s.c+1;break}if(!(l<0)){var d=De({r:n,c:s}),h=r.dense?(e[n]||[])[s]:e[d],p=h&&h.v!=null&&(h.h||pT(h.w||(er(h),h.w)||""))||"",m={};l>1&&(m.rowspan=l),u>1&&(m.colspan=u),r.editable?p='<span contenteditable="true">'+p+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+h.l.Target+'">'+p+"</a>")),m.id=(r.id||"sjs")+"-"+d,o.push(te("td",p,m))}}var v="<tr>";return v+o.join("")+"</tr>"}var BA='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',VA="</body></html>";function GA(e,t,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function nv(e,t){var n=t||{},r=n.header!=null?n.header:BA,i=n.footer!=null?n.footer:VA,o=[r],s=tn(e["!ref"]);n.dense=Array.isArray(e),o.push(GA(e,s,n));for(var l=s.s.r;l<=s.e.r;++l)o.push(UA(e,s,l,n));return o.push("</table>"+i),o.join("")}function rv(e,t,n){var r=n||{},i=0,o=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var s=typeof r.origin=="string"?ut(r.origin):r.origin;i=s.r,o=s.c}var l=t.getElementsByTagName("tr"),u=Math.min(r.sheetRows||1e7,l.length),f={s:{r:0,c:0},e:{r:i,c:o}};if(e["!ref"]){var d=tn(e["!ref"]);f.s.r=Math.min(f.s.r,d.s.r),f.s.c=Math.min(f.s.c,d.s.c),f.e.r=Math.max(f.e.r,d.e.r),f.e.c=Math.max(f.e.c,d.e.c),i==-1&&(f.e.r=i=d.e.r+1)}var h=[],p=0,m=e["!rows"]||(e["!rows"]=[]),v=0,g=0,T=0,_=0,x=0,y=0;for(e["!cols"]||(e["!cols"]=[]);v<l.length&&g<u;++v){var C=l[v];if(zd(C)){if(r.display)continue;m[g]={hidden:!0}}var k=C.children;for(T=_=0;T<k.length;++T){var M=k[T];if(!(r.display&&zd(M))){var R=M.hasAttribute("data-v")?M.getAttribute("data-v"):M.hasAttribute("v")?M.getAttribute("v"):xT(M.innerHTML),D=M.getAttribute("data-z")||M.getAttribute("z");for(p=0;p<h.length;++p){var F=h[p];F.s.c==_+o&&F.s.r<g+i&&g+i<=F.e.r&&(_=F.e.c+1-o,p=-1)}y=+M.getAttribute("colspan")||1,((x=+M.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:g+i,c:_+o},e:{r:g+i+(x||1)-1,c:_+o+(y||1)-1}});var U={t:"s",v:R},q=M.getAttribute("data-t")||M.getAttribute("t")||"";R!=null&&(R.length==0?U.t=q||"z":r.raw||R.trim().length==0||q=="s"||(R==="TRUE"?U={t:"b",v:!0}:R==="FALSE"?U={t:"b",v:!1}:isNaN(Yn(R))?isNaN(os(R).getDate())||(U={t:"d",v:Ot(R)},r.cellDates||(U={t:"n",v:$t(U.v)}),U.z=r.dateNF||Qe[14]):U={t:"n",v:Yn(R)})),U.z===void 0&&D!=null&&(U.z=D);var K="",ee=M.getElementsByTagName("A");if(ee&&ee.length)for(var Te=0;Te<ee.length&&!(ee[Te].hasAttribute("href")&&(K=ee[Te].getAttribute("href"),K.charAt(0)!="#"));++Te);K&&K.charAt(0)!="#"&&(U.l={Target:K}),r.dense?(e[g+i]||(e[g+i]=[]),e[g+i][_+o]=U):e[De({c:_+o,r:g+i})]=U,f.e.c<_+o&&(f.e.c=_+o),_+=y}}++g}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),f.e.r=Math.max(f.e.r,g-1+i),e["!ref"]=tt(f),g>=u&&(e["!fullref"]=tt((f.e.r=l.length-v+g-1+i,f))),e}function iv(e,t){var n=t||{},r=n.dense?[]:{};return rv(r,e,t)}function HA(e,t){return ni(iv(e,t),t)}function zd(e){var t="",n=WA(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function WA(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var zA=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+ls({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return nt+t}}(),qd=function(){var e=function(o){return ke(o).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,r=function(o,s,l){var u=[];u.push('      <table:table table:name="'+ke(s.SheetNames[l])+`" table:style-name="ta1">
`);var f=0,d=0,h=tn(o["!ref"]||"A1"),p=o["!merges"]||[],m=0,v=Array.isArray(o);if(o["!cols"])for(d=0;d<=h.e.c;++d)u.push("        <table:table-column"+(o["!cols"][d]?' table:style-name="co'+o["!cols"][d].ods+'"':"")+`></table:table-column>
`);var g="",T=o["!rows"]||[];for(f=0;f<h.s.r;++f)g=T[f]?' table:style-name="ro'+T[f].ods+'"':"",u.push("        <table:table-row"+g+`></table:table-row>
`);for(;f<=h.e.r;++f){for(g=T[f]?' table:style-name="ro'+T[f].ods+'"':"",u.push("        <table:table-row"+g+`>
`),d=0;d<h.s.c;++d)u.push(t);for(;d<=h.e.c;++d){var _=!1,x={},y="";for(m=0;m!=p.length;++m)if(!(p[m].s.c>d)&&!(p[m].s.r>f)&&!(p[m].e.c<d)&&!(p[m].e.r<f)){(p[m].s.c!=d||p[m].s.r!=f)&&(_=!0),x["table:number-columns-spanned"]=p[m].e.c-p[m].s.c+1,x["table:number-rows-spanned"]=p[m].e.r-p[m].s.r+1;break}if(_){u.push(n);continue}var C=De({r:f,c:d}),k=v?(o[f]||[])[d]:o[C];if(k&&k.f&&(x["table:formula"]=ke(uw(k.f)),k.F&&k.F.slice(0,C.length)==C)){var M=tn(k.F);x["table:number-matrix-columns-spanned"]=M.e.c-M.s.c+1,x["table:number-matrix-rows-spanned"]=M.e.r-M.s.r+1}if(!k){u.push(t);continue}switch(k.t){case"b":y=k.v?"TRUE":"FALSE",x["office:value-type"]="boolean",x["office:boolean-value"]=k.v?"true":"false";break;case"n":y=k.w||String(k.v||0),x["office:value-type"]="float",x["office:value"]=k.v||0;break;case"s":case"str":y=k.v==null?"":k.v,x["office:value-type"]="string";break;case"d":y=k.w||Ot(k.v).toISOString(),x["office:value-type"]="date",x["office:date-value"]=Ot(k.v).toISOString(),x["table:style-name"]="ce1";break;default:u.push(t);continue}var R=e(y);if(k.l&&k.l.Target){var D=k.l.Target;D=D.charAt(0)=="#"?"#"+fw(D.slice(1)):D,D.charAt(0)!="#"&&!D.match(/^\w+:/)&&(D="../"+D),R=te("text:a",R,{"xlink:href":D.replace(/&/g,"&amp;")})}u.push("          "+te("table:table-cell",te("text:p",R,{}),x)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},i=function(o,s){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var l=0;s.SheetNames.map(function(f){return s.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var d=0;d<f["!cols"].length;++d)if(f["!cols"][d]){var h=f["!cols"][d];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Ac(h),h.ods=l;var p=f["!cols"][d].wpx+"px";o.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),o.push(`  </style:style>
`),++l}}});var u=0;s.SheetNames.map(function(f){return s.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var d=0;d<f["!rows"].length;++d)if(f["!rows"][d]){f["!rows"][d].ods=u;var h=f["!rows"][d].hpx+"px";o.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),o.push(`  </style:style>
`),++u}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(s,l){var u=[nt],f=ls({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=ls({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(u.push("<office:document"+f+d+`>
`),u.push(_1().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+f+`>
`),i(u,s),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var h=0;h!=s.SheetNames.length;++h)u.push(r(s.Sheets[s.SheetNames[h]],s,h));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),l.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}}();function ov(e,t){if(t.bookType=="fods")return qd(e,t);var n=mc(),r="",i=[],o=[];return r="mimetype",xe(n,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",xe(n,r,qd(e,t)),i.push([r,"text/xml"]),o.push([r,"ContentFile"]),r="styles.xml",xe(n,r,zA(e,t)),i.push([r,"text/xml"]),o.push([r,"StylesFile"]),r="meta.xml",xe(n,r,nt+_1()),i.push([r,"text/xml"]),o.push([r,"MetadataFile"]),r="manifest.rdf",xe(n,r,tE(o)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",xe(n,r,jT(i)),n}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function $l(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function qA(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):En(ss(e))}function $A(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}function Rr(e){var t=e.reduce(function(i,o){return i+o.length},0),n=new Uint8Array(t),r=0;return e.forEach(function(i){n.set(i,r),r+=i.length}),n}function JA(e,t,n){var r=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,i=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(r&127)<<1;for(var o=0;i>=1;++o,i/=256)e[t+o]=i&255;e[t+15]|=n>=0?0:128}function as(e,t){var n=t?t[0]:0,r=e[n]&127;e:if(e[n++]>=128&&(r|=(e[n]&127)<<7,e[n++]<128||(r|=(e[n]&127)<<14,e[n++]<128)||(r|=(e[n]&127)<<21,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,28),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,35),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,42),++n,e[n++]<128)))break e;return t&&(t[0]=n),r}function Pe(e){var t=new Uint8Array(7);t[0]=e&127;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383||(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)||(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)||(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)||(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103))break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function Ui(e){var t=0,n=e[t]&127;e:if(e[t++]>=128){if(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128))break e;n|=(e[t]&127)<<28}return n}function rt(e){for(var t=[],n=[0];n[0]<e.length;){var r=n[0],i=as(e,n),o=i&7;i=Math.floor(i/8);var s=0,l;if(i==0)break;switch(o){case 0:{for(var u=n[0];e[n[0]++]>=128;);l=e.slice(u,n[0])}break;case 5:s=4,l=e.slice(n[0],n[0]+s),n[0]+=s;break;case 1:s=8,l=e.slice(n[0],n[0]+s),n[0]+=s;break;case 2:s=as(e,n),l=e.slice(n[0],n[0]+s),n[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(i," at offset ").concat(r))}var f={data:l,type:o};t[i]==null?t[i]=[f]:t[i].push(f)}return t}function dt(e){var t=[];return e.forEach(function(n,r){n.forEach(function(i){i.data&&(t.push(Pe(r*8+i.type)),i.type==2&&t.push(Pe(i.data.length)),t.push(i.data))})}),Rr(t)}function vn(e){for(var t,n=[],r=[0];r[0]<e.length;){var i=as(e,r),o=rt(e.slice(r[0],r[0]+i));r[0]+=i;var s={id:Ui(o[1][0].data),messages:[]};o[2].forEach(function(l){var u=rt(l.data),f=Ui(u[3][0].data);s.messages.push({meta:u,data:e.slice(r[0],r[0]+f)}),r[0]+=f}),(t=o[3])!=null&&t[0]&&(s.merge=Ui(o[3][0].data)>>>0>0),n.push(s)}return n}function ci(e){var t=[];return e.forEach(function(n){var r=[];r[1]=[{data:Pe(n.id),type:0}],r[2]=[],n.merge!=null&&(r[3]=[{data:Pe(+!!n.merge),type:0}]);var i=[];n.messages.forEach(function(s){i.push(s.data),s.meta[3]=[{type:0,data:Pe(s.data.length)}],r[2].push({data:dt(s.meta),type:2})});var o=dt(r);t.push(Pe(o.length)),t.push(o),i.forEach(function(s){return t.push(s)})}),Rr(t)}function YA(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=as(t,n),i=[];n[0]<t.length;){var o=t[n[0]]&3;if(o==0){var s=t[n[0]++]>>2;if(s<60)++s;else{var l=s-59;s=t[n[0]],l>1&&(s|=t[n[0]+1]<<8),l>2&&(s|=t[n[0]+2]<<16),l>3&&(s|=t[n[0]+3]<<24),s>>>=0,s++,n[0]+=l}i.push(t.slice(n[0],n[0]+s)),n[0]+=s;continue}else{var u=0,f=0;if(o==1?(f=(t[n[0]]>>2&7)+4,u=(t[n[0]++]&224)<<3,u|=t[n[0]++]):(f=(t[n[0]++]>>2)+1,o==2?(u=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(u=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),i=[Rr(i)],u==0)throw new Error("Invalid offset 0");if(u>i[0].length)throw new Error("Invalid offset beyond length");if(f>=u)for(i.push(i[0].slice(-u)),f-=u;f>=i[i.length-1].length;)i.push(i[i.length-1]),f-=i[i.length-1].length;i.push(i[0].slice(-u,-u+f))}}var d=Rr(i);if(d.length!=r)throw new Error("Unexpected length: ".concat(d.length," != ").concat(r));return d}function xn(e){for(var t=[],n=0;n<e.length;){var r=e[n++],i=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(YA(r,e.slice(n,n+i))),n+=i}if(n!==e.length)throw new Error("data is not a valid framed stream!");return Rr(t)}function di(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),i=new Uint8Array(4);t.push(i);var o=Pe(r),s=o.length;t.push(o),r<=60?(s++,t.push(new Uint8Array([r-1<<2]))):r<=256?(s+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(s+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(s+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(s+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),s+=r,i[0]=0,i[1]=s&255,i[2]=s>>8&255,i[3]=s>>16&255,n+=r}return Rr(t)}function au(e,t){var n=new Uint8Array(32),r=$l(n),i=12,o=0;switch(n[0]=5,e.t){case"n":n[1]=2,JA(n,i,e.v),o|=1,i+=16;break;case"b":n[1]=6,r.setFloat64(i,e.v?1:0,!0),o|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(i,t.indexOf(e.v),!0),o|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,o,!0),n.slice(0,i)}function uu(e,t){var n=new Uint8Array(32),r=$l(n),i=12,o=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(i,e.v,!0),o|=32,i+=8;break;case"b":n[2]=6,r.setFloat64(i,e.v?1:0,!0),o|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(i,t.indexOf(e.v),!0),o|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,o,!0),n.slice(0,i)}function lr(e){var t=rt(e);return as(t[1][0].data)}function KA(e,t,n){var r,i,o,s;if(!((r=e[6])!=null&&r[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var l=((s=(o=e[8])==null?void 0:o[0])==null?void 0:s.data)&&Ui(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var u=0,f=$l(e[7][0].data),d=0,h=[],p=$l(e[4][0].data),m=0,v=[],g=0;g<t.length;++g){if(t[g]==null){f.setUint16(g*2,65535,!0),p.setUint16(g*2,65535);continue}f.setUint16(g*2,d,!0),p.setUint16(g*2,m,!0);var T,_;switch(typeof t[g]){case"string":T=au({t:"s",v:t[g]},n),_=uu({t:"s",v:t[g]},n);break;case"number":T=au({t:"n",v:t[g]},n),_=uu({t:"n",v:t[g]},n);break;case"boolean":T=au({t:"b",v:t[g]},n),_=uu({t:"b",v:t[g]},n);break;default:throw new Error("Unsupported value "+t[g])}h.push(T),d+=T.length,v.push(_),m+=_.length,++u}for(e[2][0].data=Pe(u);g<e[7][0].data.length/2;++g)f.setUint16(g*2,65535,!0),p.setUint16(g*2,65535,!0);return e[6][0].data=Rr(h),e[3][0].data=Rr(v),u}function XA(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=tn(n["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(tt(r)));var o=Jl(n,{range:r,header:1}),s=["~Sh33tJ5~"];o.forEach(function(W){return W.forEach(function(O){typeof O=="string"&&s.push(O)})});var l={},u=[],f=Le.read(t.numbers,{type:"base64"});f.FileIndex.map(function(W,O){return[W,f.FullPaths[O]]}).forEach(function(W){var O=W[0],L=W[1];if(O.type==2&&O.name.match(/\.iwa/)){var X=O.content,fe=xn(X),pe=vn(fe);pe.forEach(function(de){u.push(de.id),l[de.id]={deps:[],location:L,type:Ui(de.messages[0].meta[1][0].data)}})}}),u.sort(function(W,O){return W-O});var d=u.filter(function(W){return W>1}).map(function(W){return[W,Pe(W)]});f.FileIndex.map(function(W,O){return[W,f.FullPaths[O]]}).forEach(function(W){var O=W[0];if(W[1],!!O.name.match(/\.iwa/)){var L=vn(xn(O.content));L.forEach(function(X){X.messages.forEach(function(fe){d.forEach(function(pe){X.messages.some(function(de){return Ui(de.meta[1][0].data)!=11006&&$A(de.data,pe[1])})&&l[pe[0]].deps.push(X.id)})})})}});for(var h=Le.find(f,l[1].location),p=vn(xn(h.content)),m,v=0;v<p.length;++v){var g=p[v];g.id==1&&(m=g)}var T=lr(rt(m.messages[0].data)[1][0].data);for(h=Le.find(f,l[T].location),p=vn(xn(h.content)),v=0;v<p.length;++v)g=p[v],g.id==T&&(m=g);for(T=lr(rt(m.messages[0].data)[2][0].data),h=Le.find(f,l[T].location),p=vn(xn(h.content)),v=0;v<p.length;++v)g=p[v],g.id==T&&(m=g);for(T=lr(rt(m.messages[0].data)[2][0].data),h=Le.find(f,l[T].location),p=vn(xn(h.content)),v=0;v<p.length;++v)g=p[v],g.id==T&&(m=g);var _=rt(m.messages[0].data);{_[6][0].data=Pe(r.e.r+1),_[7][0].data=Pe(r.e.c+1);var x=lr(_[46][0].data),y=Le.find(f,l[x].location),C=vn(xn(y.content));{for(var k=0;k<C.length&&C[k].id!=x;++k);if(C[k].id!=x)throw"Bad ColumnRowUIDMapArchive";var M=rt(C[k].messages[0].data);M[1]=[],M[2]=[],M[3]=[];for(var R=0;R<=r.e.c;++R){var D=[];D[1]=D[2]=[{type:0,data:Pe(R+420690)}],M[1].push({type:2,data:dt(D)}),M[2].push({type:0,data:Pe(R)}),M[3].push({type:0,data:Pe(R)})}M[4]=[],M[5]=[],M[6]=[];for(var F=0;F<=r.e.r;++F)D=[],D[1]=D[2]=[{type:0,data:Pe(F+726270)}],M[4].push({type:2,data:dt(D)}),M[5].push({type:0,data:Pe(F)}),M[6].push({type:0,data:Pe(F)});C[k].messages[0].data=dt(M)}y.content=di(ci(C)),y.size=y.content.length,delete _[46];var U=rt(_[4][0].data);{U[7][0].data=Pe(r.e.r+1);var q=rt(U[1][0].data),K=lr(q[2][0].data);y=Le.find(f,l[K].location),C=vn(xn(y.content));{if(C[0].id!=K)throw"Bad HeaderStorageBucket";var ee=rt(C[0].messages[0].data);for(F=0;F<o.length;++F){var Te=rt(ee[2][0].data);Te[1][0].data=Pe(F),Te[4][0].data=Pe(o[F].length),ee[2][F]={type:ee[2][0].type,data:dt(Te)}}C[0].messages[0].data=dt(ee)}y.content=di(ci(C)),y.size=y.content.length;var ge=lr(U[2][0].data);y=Le.find(f,l[ge].location),C=vn(xn(y.content));{if(C[0].id!=ge)throw"Bad HeaderStorageBucket";for(ee=rt(C[0].messages[0].data),R=0;R<=r.e.c;++R)Te=rt(ee[2][0].data),Te[1][0].data=Pe(R),Te[4][0].data=Pe(r.e.r+1),ee[2][R]={type:ee[2][0].type,data:dt(Te)};C[0].messages[0].data=dt(ee)}y.content=di(ci(C)),y.size=y.content.length;var Ae=lr(U[4][0].data);(function(){for(var W=Le.find(f,l[Ae].location),O=vn(xn(W.content)),L,X=0;X<O.length;++X){var fe=O[X];fe.id==Ae&&(L=fe)}var pe=rt(L.messages[0].data);{pe[3]=[];var de=[];s.forEach(function(Ee,Pt){de[1]=[{type:0,data:Pe(Pt)}],de[2]=[{type:0,data:Pe(1)}],de[3]=[{type:2,data:qA(Ee)}],pe[3].push({type:2,data:dt(de)})})}L.messages[0].data=dt(pe);var oe=ci(O),Oe=di(oe);W.content=Oe,W.size=W.content.length})();var Ne=rt(U[3][0].data);{var ie=Ne[1][0];delete Ne[2];var he=rt(ie.data);{var me=lr(he[2][0].data);(function(){for(var W=Le.find(f,l[me].location),O=vn(xn(W.content)),L,X=0;X<O.length;++X){var fe=O[X];fe.id==me&&(L=fe)}var pe=rt(L.messages[0].data);{delete pe[6],delete Ne[7];var de=new Uint8Array(pe[5][0].data);pe[5]=[];for(var oe=0,Oe=0;Oe<=r.e.r;++Oe){var Ee=rt(de);oe+=KA(Ee,o[Oe],s),Ee[1][0].data=Pe(Oe),pe[5].push({data:dt(Ee),type:2})}pe[1]=[{type:0,data:Pe(r.e.c+1)}],pe[2]=[{type:0,data:Pe(r.e.r+1)}],pe[3]=[{type:0,data:Pe(oe)}],pe[4]=[{type:0,data:Pe(r.e.r+1)}]}L.messages[0].data=dt(pe);var Pt=ci(O),Re=di(Pt);W.content=Re,W.size=W.content.length})()}ie.data=dt(he)}U[3][0].data=dt(Ne)}_[4][0].data=dt(U)}m.messages[0].data=dt(_);var ye=ci(p),P=di(ye);return h.content=P,h.size=h.content.length,f}function bA(e){return function(n){for(var r=0;r!=e.length;++r){var i=e[r];n[i[0]]===void 0&&(n[i[0]]=i[1]),i[2]==="n"&&(n[i[0]]=Number(n[i[0]]))}}}function Fc(e){bA([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function QA(e,t){return t.bookType=="ods"?ov(e,t):t.bookType=="numbers"?XA(e,t):t.bookType=="xlsb"?ZA(e,t):jA(e,t)}function ZA(e,t){Ai=1024,e&&!e.SSF&&(e.SSF=Jt(Qe)),e&&e.SSF&&(ma(),pa(e.SSF),t.revssf=ga(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Bo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n=t.bookType=="xlsb"?"bin":"xml",r=H1.indexOf(t.bookType)>-1,i=g1();Fc(t=t||{});var o=mc(),s="",l=0;if(t.cellXfs=[],kr(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",xe(o,s,y1(e.Props,t)),i.coreprops.push(s),Fe(t.rels,2,s,we.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&u.push(e.SheetNames[f]);e.Props.SheetNames=u}for(e.Props.Worksheets=e.Props.SheetNames.length,xe(o,s,E1(e.Props)),i.extprops.push(s),Fe(t.rels,3,s,we.EXT_PROPS),e.Custprops!==e.Props&&Tt(e.Custprops||{}).length>0&&(s="docProps/custom.xml",xe(o,s,S1(e.Custprops)),i.custprops.push(s),Fe(t.rels,4,s,we.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:s="xl/worksheets/sheet"+l+"."+n,xe(o,s,tA(l-1,s,t,e,d)),i.sheets.push(s),Fe(t.wbrels,-1,"worksheets/sheet"+l+"."+n,we.WS[0])}if(h){var m=h["!comments"],v=!1,g="";m&&m.length>0&&(g="xl/comments"+l+"."+n,xe(o,g,iA(m,g)),i.comments.push(g),Fe(d,-1,"../comments"+l+"."+n,we.CMNT),v=!0),h["!legacy"]&&v&&xe(o,"xl/drawings/vmlDrawing"+l+".vml",V1(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&xe(o,x1(s),Li(d))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+n,xe(o,s,rA(t.Strings,s,t)),i.strs.push(s),Fe(t.wbrels,-1,"sharedStrings."+n,we.SST)),s="xl/workbook."+n,xe(o,s,eA(e,s)),i.workbooks.push(s),Fe(t.rels,1,s,we.WB),s="xl/theme/theme1.xml",xe(o,s,U1(e.Themes,t)),i.themes.push(s),Fe(t.wbrels,-1,"theme/theme1.xml",we.THEME),s="xl/styles."+n,xe(o,s,nA(e,s,t)),i.styles.push(s),Fe(t.wbrels,-1,"styles."+n,we.STY),e.vbaraw&&r&&(s="xl/vbaProject.bin",xe(o,s,e.vbaraw),i.vba.push(s),Fe(t.wbrels,-1,"vbaProject.bin",we.VBA)),s="xl/metadata."+n,xe(o,s,oA(s)),i.metadata.push(s),Fe(t.wbrels,-1,"metadata."+n,we.XLMETA),xe(o,"[Content_Types].xml",v1(i,t)),xe(o,"_rels/.rels",Li(t.rels)),xe(o,"xl/_rels/workbook."+n+".rels",Li(t.wbrels)),delete t.revssf,delete t.ssf,o}function jA(e,t){Ai=1024,e&&!e.SSF&&(e.SSF=Jt(Qe)),e&&e.SSF&&(ma(),pa(e.SSF),t.revssf=ga(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Bo?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=H1.indexOf(t.bookType)>-1,i=g1();Fc(t=t||{});var o=mc(),s="",l=0;if(t.cellXfs=[],kr(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",xe(o,s,y1(e.Props,t)),i.coreprops.push(s),Fe(t.rels,2,s,we.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],f=0;f<e.SheetNames.length;++f)(e.Workbook.Sheets[f]||{}).Hidden!=2&&u.push(e.SheetNames[f]);e.Props.SheetNames=u}e.Props.Worksheets=e.Props.SheetNames.length,xe(o,s,E1(e.Props)),i.extprops.push(s),Fe(t.rels,3,s,we.EXT_PROPS),e.Custprops!==e.Props&&Tt(e.Custprops||{}).length>0&&(s="docProps/custom.xml",xe(o,s,S1(e.Custprops)),i.custprops.push(s),Fe(t.rels,4,s,we.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var h={"!id":{}},p=e.Sheets[e.SheetNames[l-1]],m=(p||{})["!type"]||"sheet";switch(m){case"chart":default:s="xl/worksheets/sheet"+l+"."+n,xe(o,s,b1(l-1,t,e,h)),i.sheets.push(s),Fe(t.wbrels,-1,"worksheets/sheet"+l+"."+n,we.WS[0])}if(p){var v=p["!comments"],g=!1,T="";if(v&&v.length>0){var _=!1;v.forEach(function(x){x[1].forEach(function(y){y.T==!0&&(_=!0)})}),_&&(T="xl/threadedComments/threadedComment"+l+"."+n,xe(o,T,PS(v,d,t)),i.threadedcomments.push(T),Fe(h,-1,"../threadedComments/threadedComment"+l+"."+n,we.TCMNT)),T="xl/comments"+l+"."+n,xe(o,T,G1(v)),i.comments.push(T),Fe(h,-1,"../comments"+l+"."+n,we.CMNT),g=!0}p["!legacy"]&&g&&xe(o,"xl/drawings/vmlDrawing"+l+".vml",V1(l,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&xe(o,x1(s),Li(h))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+n,xe(o,s,F1(t.Strings,t)),i.strs.push(s),Fe(t.wbrels,-1,"sharedStrings."+n,we.SST)),s="xl/workbook."+n,xe(o,s,j1(e)),i.workbooks.push(s),Fe(t.rels,1,s,we.WB),s="xl/theme/theme1.xml",xe(o,s,U1(e.Themes,t)),i.themes.push(s),Fe(t.wbrels,-1,"theme/theme1.xml",we.THEME),s="xl/styles."+n,xe(o,s,L1(e,t)),i.styles.push(s),Fe(t.wbrels,-1,"styles."+n,we.STY),e.vbaraw&&r&&(s="xl/vbaProject.bin",xe(o,s,e.vbaraw),i.vba.push(s),Fe(t.wbrels,-1,"vbaProject.bin",we.VBA)),s="xl/metadata."+n,xe(o,s,B1()),i.metadata.push(s),Fe(t.wbrels,-1,"metadata."+n,we.XLMETA),d.length>1&&(s="xl/persons/person.xml",xe(o,s,FS(d)),i.people.push(s),Fe(t.wbrels,-1,"persons/person.xml",we.PEOPLE)),xe(o,"[Content_Types].xml",v1(i,t)),xe(o,"_rels/.rels",Li(t.rels)),xe(o,"xl/_rels/workbook."+n+".rels",Li(t.wbrels)),delete t.revssf,delete t.ssf,o}function eI(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=jn(e.slice(0,12));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function sv(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return gs(t.file,Le.write(e,{type:Ie?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Le.write(e,t)}function tI(e,t){var n=Jt(t||{}),r=QA(e,n);return nI(r,n)}function nI(e,t){var n={},r=Ie?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Le.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(ha(i))}return t.password&&typeof encrypt_agile<"u"?sv(encrypt_agile(i,t.password),t):t.type==="file"?gs(t.file,i):t.type=="string"?Do(i):i}function rI(e,t){var n=t||{},r=_A(e,n);return sv(r,n)}function kn(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return is(ss(r));case"binary":return ss(r);case"string":return e;case"file":return gs(t.file,r,"utf8");case"buffer":return Ie?rr(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):kn(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function iI(e,t){switch(t.type){case"base64":return is(e);case"binary":return e;case"string":return e;case"file":return gs(t.file,e,"binary");case"buffer":return Ie?rr(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ys(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return t.type=="base64"?is(n):t.type=="string"?Do(n):n;case"file":return gs(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function lv(e,t){ky(),zC(e);var n=Jt(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var r=lv(e,n);return n.type="array",ha(r)}var i=0;if(n.sheet&&(typeof n.sheet=="number"?i=n.sheet:i=e.SheetNames.indexOf(n.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return kn(vA(e,n),n);case"slk":case"sylk":return kn(GE.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"htm":case"html":return kn(nv(e.Sheets[e.SheetNames[i]],n),n);case"txt":return iI(av(e.Sheets[e.SheetNames[i]],n),n);case"csv":return kn(kc(e.Sheets[e.SheetNames[i]],n),n,"\uFEFF");case"dif":return kn(HE.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"dbf":return Ys(VE.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"prn":return kn(WE.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"rtf":return kn(XE.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"eth":return kn(P1.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"fods":return kn(ov(e,n),n);case"wk1":return Ys(Ud.sheet_to_wk1(e.Sheets[e.SheetNames[i]],n),n);case"wk3":return Ys(Ud.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),Ys(tv(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),rI(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return tI(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function oI(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},n=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(e.bookType=n.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function sI(e,t,n){var r={};return r.type="file",r.file=t,oI(r),lv(e,r)}function lI(e,t,n,r,i,o,s,l){var u=_t(n),f=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),h=!0,p=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:n,enumerable:!1})}catch{p.__rowNum__=n}else p.__rowNum__=n;if(!s||e[n])for(var m=t.s.c;m<=t.e.c;++m){var v=s?e[n][m]:e[r[m]+u];if(v===void 0||v.t===void 0){if(f===void 0)continue;o[m]!=null&&(p[o[m]]=f);continue}var g=v.v;switch(v.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(o[m]!=null){if(g==null)if(v.t=="e"&&g===null)p[o[m]]=null;else if(f!==void 0)p[o[m]]=f;else if(d&&g===null)p[o[m]]=null;else continue;else p[o[m]]=d&&(v.t!=="n"||v.t==="n"&&l.rawNumbers!==!1)?g:er(v,g,l);g!=null&&(h=!1)}}return{row:p,isempty:h}}function Jl(e,t){if(e==null||e["!ref"]==null)return[];var n={t:"n",v:0},r=0,i=1,o=[],s=0,l="",u={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},d=f.range!=null?f.range:e["!ref"];switch(f.header===1?r=1:f.header==="A"?r=2:Array.isArray(f.header)?r=3:f.header==null&&(r=0),typeof d){case"string":u=He(d);break;case"number":u=He(e["!ref"]),u.s.r=d;break;default:u=d}r>0&&(i=0);var h=_t(u.s.r),p=[],m=[],v=0,g=0,T=Array.isArray(e),_=u.s.r,x=0,y={};T&&!e[_]&&(e[_]=[]);var C=f.skipHidden&&e["!cols"]||[],k=f.skipHidden&&e["!rows"]||[];for(x=u.s.c;x<=u.e.c;++x)if(!(C[x]||{}).hidden)switch(p[x]=It(x),n=T?e[_][x]:e[p[x]+h],r){case 1:o[x]=x-u.s.c;break;case 2:o[x]=p[x];break;case 3:o[x]=f.header[x-u.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),l=s=er(n,null,f),g=y[s]||0,!g)y[s]=1;else{do l=s+"_"+g++;while(y[l]);y[s]=g,y[l]=1}o[x]=l}for(_=u.s.r+i;_<=u.e.r;++_)if(!(k[_]||{}).hidden){var M=lI(e,u,_,p,r,o,T,f);(M.isempty===!1||(r===1?f.blankrows!==!1:f.blankrows))&&(m[v++]=M.row)}return m.length=v,m}var $d=/"/g;function aI(e,t,n,r,i,o,s,l){for(var u=!0,f=[],d="",h=_t(n),p=t.s.c;p<=t.e.c;++p)if(r[p]){var m=l.dense?(e[n]||[])[p]:e[r[p]+h];if(m==null)d="";else if(m.v!=null){u=!1,d=""+(l.rawNumbers&&m.t=="n"?m.v:er(m,null,l));for(var v=0,g=0;v!==d.length;++v)if((g=d.charCodeAt(v))===i||g===o||g===34||l.forceQuotes){d='"'+d.replace($d,'""')+'"';break}d=="ID"&&(d='"ID"')}else m.f!=null&&!m.F?(u=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace($d,'""')+'"')):d="";f.push(d)}return l.blankrows===!1&&u?null:f.join(s)}function kc(e,t){var n=[],r=t??{};if(e==null||e["!ref"]==null)return"";var i=He(e["!ref"]),o=r.FS!==void 0?r.FS:",",s=o.charCodeAt(0),l=r.RS!==void 0?r.RS:`
`,u=l.charCodeAt(0),f=new RegExp((o=="|"?"\\|":o)+"+$"),d="",h=[];r.dense=Array.isArray(e);for(var p=r.skipHidden&&e["!cols"]||[],m=r.skipHidden&&e["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(p[v]||{}).hidden||(h[v]=It(v));for(var g=0,T=i.s.r;T<=i.e.r;++T)(m[T]||{}).hidden||(d=aI(e,i,T,h,s,u,o,r),d!=null&&(r.strip&&(d=d.replace(f,"")),(d||r.blankrows!==!1)&&n.push((g++?l:"")+d)));return delete r.dense,n.join("")}function av(e,t){t||(t={}),t.FS="	",t.RS=`
`;var n=kc(e,t);return n}function uI(e){var t="",n,r="";if(e==null||e["!ref"]==null)return[];var i=He(e["!ref"]),o="",s=[],l,u=[],f=Array.isArray(e);for(l=i.s.c;l<=i.e.c;++l)s[l]=It(l);for(var d=i.s.r;d<=i.e.r;++d)for(o=_t(d),l=i.s.c;l<=i.e.c;++l)if(t=s[l]+o,n=f?(e[d]||[])[l]:e[t],r="",n!==void 0){if(n.F!=null){if(t=n.F,!n.f)continue;r=n.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}u[u.length]=t+"="+r}return u}function uv(e,t,n){var r=n||{},i=+!r.skipHeader,o=e||{},s=0,l=0;if(o&&r.origin!=null)if(typeof r.origin=="number")s=r.origin;else{var u=typeof r.origin=="string"?ut(r.origin):r.origin;s=u.r,l=u.c}var f,d={s:{c:0,r:0},e:{c:l,r:s+t.length-1+i}};if(o["!ref"]){var h=He(o["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),s==-1&&(s=h.e.r+1,d.e.r=s+t.length-1+i)}else s==-1&&(s=0,d.e.r=t.length-1+i);var p=r.header||[],m=0;t.forEach(function(g,T){Tt(g).forEach(function(_){(m=p.indexOf(_))==-1&&(p[m=p.length]=_);var x=g[_],y="z",C="",k=De({c:l+m,r:s+T+i});f=us(o,k),x&&typeof x=="object"&&!(x instanceof Date)?o[k]=x:(typeof x=="number"?y="n":typeof x=="boolean"?y="b":typeof x=="string"?y="s":x instanceof Date?(y="d",r.cellDates||(y="n",x=$t(x)),C=r.dateNF||Qe[14]):x===null&&r.nullError&&(y="e",x=0),f?(f.t=y,f.v=x,delete f.w,delete f.R,C&&(f.z=C)):o[k]=f={t:y,v:x},C&&(f.z=C))})}),d.e.c=Math.max(d.e.c,l+p.length-1);var v=_t(s);if(i)for(m=0;m<p.length;++m)o[It(m+l)+v]={t:"s",v:p[m]};return o["!ref"]=tt(d),o}function fI(e,t){return uv(null,e,t)}function us(e,t,n){if(typeof t=="string"){if(Array.isArray(e)){var r=ut(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?us(e,De(t)):us(e,De({r:t,c:n||0}))}function cI(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function dI(){return{SheetNames:[],Sheets:{}}}function hI(e,t,n,r){var i=1;if(!n)for(;i<=65535&&e.SheetNames.indexOf(n="Sheet"+i)!=-1;++i,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var o=n.match(/(^.*?)(\d+)$/);i=o&&+o[2]||0;var s=o&&o[1]||n;for(++i;i<=65535&&e.SheetNames.indexOf(n=s+i)!=-1;++i);}if(Z1(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function pI(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=cI(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n}function mI(e,t){return e.z=t,e}function fv(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}function gI(e,t,n){return fv(e,"#"+t,n)}function vI(e,t,n){e.c||(e.c=[]),e.c.push({t,a:n||"SheetJS"})}function xI(e,t,n,r){for(var i=typeof t!="string"?t:He(t),o=typeof t=="string"?t:tt(t),s=i.s.r;s<=i.e.r;++s)for(var l=i.s.c;l<=i.e.c;++l){var u=us(e,s,l);u.t="n",u.F=o,delete u.v,s==i.s.r&&l==i.s.c&&(u.f=n,r&&(u.D=!0))}return e}var fu={encode_col:It,encode_row:_t,encode_cell:De,encode_range:tt,decode_col:Tc,decode_row:yc,split_cell:kT,decode_cell:ut,decode_range:tn,format_cell:er,sheet_add_aoa:f1,sheet_add_json:uv,sheet_add_dom:rv,aoa_to_sheet:ji,json_to_sheet:fI,table_to_sheet:iv,table_to_book:HA,sheet_to_csv:kc,sheet_to_txt:av,sheet_to_json:Jl,sheet_to_html:nv,sheet_to_formulae:uI,sheet_to_row_object_array:Jl,sheet_get_cell:us,book_new:dI,book_append_sheet:hI,book_set_sheet_visibility:pI,cell_set_number_format:mI,cell_set_hyperlink:fv,cell_set_internal_link:gI,cell_add_comment:vI,sheet_set_array_formula:xI,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const _I=()=>B.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-10 h-10 text-gray-400",children:B.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"})}),yI=()=>B.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:B.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"})}),cv=()=>B.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-6 h-6 text-green-500",children:B.jsx("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12Zm13.36-1.814a.75.75 0 1 0-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 0 0-1.06 1.06l2.25 2.25a.75.75 0 0 0 1.14-.094l3.75-5.25Z",clipRule:"evenodd"})}),TI=()=>B.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-6 h-6 text-red-500",children:B.jsx("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z",clipRule:"evenodd"})}),EI=()=>B.jsxs("svg",{className:"animate-spin h-5 w-5 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[B.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),B.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),SI=()=>B.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:B.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"})}),Jd=e=>{const t=e.type,n=e.name.toLowerCase();return t.startsWith("image/")||t==="application/pdf"||n.endsWith(".pdf")||n.endsWith(".jpg")||n.endsWith(".jpeg")||n.endsWith(".png")},wI=({onFilesSelected:e})=>{const[t,n]=mt.useState(!1),r=mt.useRef(null),i=mt.useCallback(f=>{f.preventDefault(),n(!0)},[]),o=mt.useCallback(f=>{f.preventDefault(),n(!1)},[]),s=mt.useCallback(f=>{f.preventDefault(),n(!1);const d=Array.from(f.dataTransfer.files).filter(Jd);d.length>0&&e(d)},[e]),l=mt.useCallback(f=>{if(f.target.files&&f.target.files.length>0){const d=Array.from(f.target.files).filter(Jd);d.length>0?e(d):alert("No se encontraron archivos PDF o imgenes en la seleccin.")}f.target.value=""},[e]),u=()=>{r.current&&r.current.click()};return B.jsx("div",{className:"space-y-4",children:B.jsxs("div",{onDragOver:i,onDragLeave:o,onDrop:s,className:`
          border-2 border-dashed rounded-xl p-8 text-center transition-colors duration-200
          ${t?"border-blue-500 bg-blue-900/20":"border-slate-600 hover:border-blue-500 bg-slate-800"}
        `,children:[B.jsx("input",{type:"file",multiple:!0,accept:"image/*,application/pdf",onChange:l,className:"hidden",id:"file-upload"}),B.jsx("input",{type:"file",ref:r,onChange:l,className:"hidden",id:"folder-upload",webkitdirectory:"",directory:""}),B.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4",children:[B.jsx(_I,{}),B.jsxs("div",{className:"space-y-1",children:[B.jsx("p",{className:"text-lg font-medium text-slate-200",children:"Arrastra archivos o carpetas aqu"}),B.jsx("p",{className:"text-sm text-slate-400",children:"Soporta PDF, JPG, PNG"})]}),B.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-2",children:[B.jsx("label",{htmlFor:"file-upload",className:"cursor-pointer inline-flex items-center px-4 py-2 border border-slate-600 shadow-sm text-sm font-medium rounded-md text-slate-200 bg-slate-700 hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Seleccionar Archivos"}),B.jsxs("button",{type:"button",onClick:u,className:"cursor-pointer inline-flex items-center px-4 py-2 border border-blue-600 shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[B.jsx("span",{className:"mr-2",children:B.jsx(yI,{})}),"Seleccionar Carpeta"]})]}),B.jsx("p",{className:"text-xs text-slate-500 max-w-xs mx-auto",children:"Tip: Para procesar una carpeta de Google Drive, seleccinala desde tu disco local sincronizado."})]})]})})},Yd=["ALAU","RENDICION","EXTERIOR","NOTA DE CREDITO"],CI=({invoices:e,onUpdate:t,onRemove:n})=>{const[r,i]=mt.useState(new Set),[o,s]=mt.useState(""),[l,u]=mt.useState(""),[f,d]=mt.useState(""),[h,p]=mt.useState("");if(e.length===0)return null;const m=T=>{if(T.target.checked){const _=new Set(e.map((x,y)=>y));i(_)}else i(new Set)},v=T=>{const _=new Set(r);_.has(T)?_.delete(T):_.add(T),i(_)},g=()=>{const T={};o&&(T.receivedDate=o),l&&(T.exchangeRate=parseFloat(l)),f&&(T.purchaseOrder=f),h&&(T.classification=h),Array.from(r).forEach(_=>{t(_,T)})};return B.jsxs("div",{className:"space-y-4",children:[r.size>0&&B.jsx("div",{className:"bg-slate-800 border border-slate-700 p-4 rounded-lg shadow-sm animate-in slide-in-from-top-2",children:B.jsxs("div",{className:"flex flex-col sm:flex-row items-end sm:items-center gap-4",children:[B.jsxs("div",{className:"text-sm font-semibold text-blue-400 whitespace-nowrap",children:["Editando ",r.size," filas:"]}),B.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 w-full",children:[B.jsxs("div",{children:[B.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Clasificacin"}),B.jsxs("select",{className:"block w-full rounded-md border-slate-600 bg-slate-900 text-white py-1.5 text-sm focus:border-blue-500 focus:ring-blue-500",value:h,onChange:T=>p(T.target.value),children:[B.jsx("option",{value:"",children:"- Sin cambio -"}),Yd.map(T=>B.jsx("option",{value:T,children:T},T))]})]}),B.jsxs("div",{children:[B.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"Recibido"}),B.jsx("input",{type:"date",className:"block w-full rounded-md border-slate-600 bg-slate-900 text-white py-1.5 text-sm focus:border-blue-500 focus:ring-blue-500",value:o,onChange:T=>s(T.target.value)})]}),B.jsxs("div",{children:[B.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"TC FC"}),B.jsx("input",{type:"number",placeholder:"Ej: 1100",className:"block w-full rounded-md border-slate-600 bg-slate-900 text-white py-1.5 text-sm placeholder-slate-600 focus:border-blue-500 focus:ring-blue-500",value:l,onChange:T=>u(T.target.value)})]}),B.jsxs("div",{children:[B.jsx("label",{className:"block text-xs text-slate-400 mb-1",children:"OC"}),B.jsx("input",{type:"text",placeholder:"Ej: 4500-...",className:"block w-full rounded-md border-slate-600 bg-slate-900 text-white py-1.5 text-sm placeholder-slate-600 focus:border-blue-500 focus:ring-blue-500",value:f,onChange:T=>d(T.target.value)})]})]}),B.jsx("button",{onClick:g,className:"w-full sm:w-auto px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md hover:bg-blue-500 transition-colors",children:"Aplicar"})]})}),B.jsx("div",{className:"overflow-hidden shadow ring-1 ring-black ring-opacity-20 md:rounded-lg bg-slate-800 border border-slate-700",children:B.jsx("div",{className:"overflow-x-auto",children:B.jsxs("table",{className:"min-w-full divide-y divide-slate-700",children:[B.jsx("thead",{className:"bg-slate-900/50",children:B.jsxs("tr",{children:[B.jsx("th",{scope:"col",className:"py-3 pl-4 pr-3 text-left w-10",children:B.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-600 bg-slate-700 text-blue-500 focus:ring-blue-500 focus:ring-offset-slate-800",onChange:m,checked:e.length>0&&r.size===e.length})}),B.jsx("th",{scope:"col",className:"py-3 px-2 text-left text-xs font-bold text-slate-400 uppercase tracking-wider min-w-[150px]",children:"Nombre del Item"}),B.jsx("th",{scope:"col",className:"px-2 py-3 text-left text-xs font-bold text-slate-400 uppercase tracking-wider min-w-[120px]",children:"Clasificacin"}),B.jsx("th",{scope:"col",className:"px-2 py-3 text-left text-xs font-bold text-slate-400 uppercase tracking-wider min-w-[130px]",children:"Fecha FC"}),B.jsx("th",{scope:"col",className:"px-2 py-3 text-left text-xs font-bold text-slate-400 uppercase tracking-wider min-w-[130px]",children:"Fecha Vto"}),B.jsx("th",{scope:"col",className:"px-2 py-3 text-left text-xs font-bold text-yellow-500 uppercase tracking-wider min-w-[130px] bg-yellow-900/10 border-l border-yellow-900/20",children:"Recibido"}),B.jsx("th",{scope:"col",className:"px-2 py-3 text-left text-xs font-bold text-slate-400 uppercase tracking-wider min-w-[100px]",children:"N Factura"}),B.jsx("th",{scope:"col",className:"px-2 py-3 text-left text-xs font-bold text-slate-400 uppercase tracking-wider min-w-[100px] bg-slate-900/50 border-l border-slate-700",children:"OC"}),B.jsx("th",{scope:"col",className:"px-2 py-3 text-left text-xs font-bold text-slate-400 uppercase tracking-wider min-w-[80px] bg-slate-900/50",children:"TC FC"}),B.jsx("th",{scope:"col",className:"px-2 py-3 text-left text-xs font-bold text-blue-400 uppercase tracking-wider min-w-[100px] bg-blue-900/10 border-l border-blue-900/20",children:"Importe ARS"}),B.jsx("th",{scope:"col",className:"px-2 py-3 text-left text-xs font-bold text-green-400 uppercase tracking-wider min-w-[100px] bg-green-900/10 border-l border-green-900/20",children:"Importe USD"}),B.jsx("th",{scope:"col",className:"px-2 py-3 text-left text-xs font-bold text-slate-400 uppercase tracking-wider min-w-[150px]",children:"PDF"}),B.jsx("th",{scope:"col",className:"relative py-3 pl-3 pr-4 sm:pr-6"})]})}),B.jsx("tbody",{className:"divide-y divide-slate-700 bg-slate-800",children:e.map((T,_)=>{const x=T.currency==="ARS",y=x?T.totalAmount:"",C=x?"":T.totalAmount,k=r.has(_);return B.jsxs("tr",{className:`hover:bg-slate-700/50 transition-colors ${k?"bg-blue-900/20":""}`,children:[B.jsx("td",{className:"pl-4 pr-3 py-2",children:B.jsx("input",{type:"checkbox",className:"h-4 w-4 rounded border-slate-600 bg-slate-700 text-blue-500 focus:ring-blue-500 focus:ring-offset-slate-800",checked:k,onChange:()=>v(_)})}),B.jsx("td",{className:"px-2 py-2",children:B.jsx("input",{type:"text",className:"block w-full rounded-md border-slate-600 bg-slate-900 text-white py-1.5 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm sm:leading-6",value:T.vendor||"",onChange:M=>t(_,{vendor:M.target.value})})}),B.jsx("td",{className:"px-2 py-2",children:B.jsx("select",{className:"block w-full rounded-md border-slate-600 bg-slate-900 text-white py-1.5 pl-3 pr-8 focus:border-blue-500 focus:ring-blue-500 sm:text-sm sm:leading-6",value:T.classification||"ALAU",onChange:M=>t(_,{classification:M.target.value}),children:Yd.map(M=>B.jsx("option",{value:M,children:M},M))})}),B.jsx("td",{className:"px-2 py-2",children:B.jsx("input",{type:"date",className:"block w-full rounded-md border-slate-600 bg-slate-900 text-white py-1.5 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm sm:leading-6",value:T.date||"",onChange:M=>t(_,{date:M.target.value})})}),B.jsx("td",{className:"px-2 py-2",children:B.jsx("input",{type:"date",className:"block w-full rounded-md border-slate-600 bg-slate-900 text-white py-1.5 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm sm:leading-6",value:T.dueDate||"",onChange:M=>t(_,{dueDate:M.target.value})})}),B.jsx("td",{className:"px-2 py-2 bg-yellow-900/10 border-l border-yellow-900/20",children:B.jsx("input",{type:"date",className:"block w-full rounded-md border-slate-600 bg-slate-900 text-white py-1.5 shadow-sm focus:border-yellow-500 focus:ring-yellow-500 sm:text-sm sm:leading-6",value:T.receivedDate||"",onChange:M=>t(_,{receivedDate:M.target.value})})}),B.jsx("td",{className:"px-2 py-2",children:B.jsx("input",{type:"text",className:"block w-full rounded-md border-slate-600 bg-slate-900 text-white py-1.5 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm sm:leading-6",value:T.invoiceNumber||"",onChange:M=>t(_,{invoiceNumber:M.target.value})})}),B.jsx("td",{className:"px-2 py-2 bg-slate-900/30 border-l border-slate-700",children:B.jsx("input",{type:"text",className:"block w-full rounded-md border-slate-600 bg-slate-900 text-white py-1.5 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm sm:leading-6",value:T.purchaseOrder||"",onChange:M=>t(_,{purchaseOrder:M.target.value})})}),B.jsx("td",{className:"px-2 py-2 bg-slate-900/30",children:B.jsx("input",{type:"number",placeholder:"-",className:"block w-full rounded-md border-slate-600 bg-slate-900 text-white py-1.5 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm sm:leading-6 text-right placeholder-slate-600",value:T.exchangeRate||"",onChange:M=>t(_,{exchangeRate:parseFloat(M.target.value)})})}),B.jsx("td",{className:"px-2 py-2 bg-blue-900/10 border-l border-blue-900/20",children:B.jsx("input",{type:"number",placeholder:"0.00",className:"block w-full rounded-md border-slate-600 bg-slate-900 text-white py-1.5 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm sm:leading-6 text-right placeholder-slate-600",value:y||"",onChange:M=>{const R=parseFloat(M.target.value);t(_,{totalAmount:isNaN(R)?0:R,currency:"ARS"})}})}),B.jsx("td",{className:"px-2 py-2 bg-green-900/10 border-l border-green-900/20",children:B.jsx("input",{type:"number",placeholder:"0.00",className:"block w-full rounded-md border-slate-600 bg-slate-900 text-white py-1.5 shadow-sm focus:border-green-500 focus:ring-green-500 sm:text-sm sm:leading-6 text-right placeholder-slate-600",value:C||"",onChange:M=>{const R=parseFloat(M.target.value);t(_,{totalAmount:isNaN(R)?0:R,currency:"USD"})}})}),B.jsx("td",{className:"px-3 py-4 text-xs text-slate-400 max-w-[150px] truncate",title:T.fileName,children:T.fileName}),B.jsx("td",{className:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6",children:B.jsx("button",{onClick:()=>n(_),className:"text-slate-400 hover:text-red-500 transition-colors p-1",title:"Eliminar fila",children:B.jsx(SI,{})})})]},`${T.fileName}-${_}`)})})]})})})]})};var Dt=(e=>(e.PENDING="PENDING",e.PROCESSING="PROCESSING",e.COMPLETED="COMPLETED",e.ERROR="ERROR",e))(Dt||{});const AI=({invoices:e})=>B.jsx("div",{className:"max-h-[400px] overflow-y-auto divide-y divide-slate-700",children:e.map((t,n)=>B.jsxs("div",{className:"px-6 py-3 flex items-center justify-between hover:bg-slate-700/50 transition-colors",children:[B.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[B.jsxs("div",{className:"flex-shrink-0",children:[t.status===Dt.PROCESSING&&B.jsx(EI,{}),t.status===Dt.COMPLETED&&B.jsx(cv,{}),t.status===Dt.ERROR&&B.jsx(TI,{}),t.status===Dt.PENDING&&B.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-slate-600"})]}),B.jsxs("div",{className:"flex flex-col min-w-0",children:[B.jsx("span",{className:"text-sm font-medium text-slate-200 truncate pr-4",title:t.fileName,children:t.fileName}),t.status===Dt.ERROR&&B.jsx("span",{className:"text-xs text-red-400",children:"Error al leer"})]})]}),B.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase tracking-wider",children:t.status===Dt.COMPLETED?"OK":t.status===Dt.PROCESSING?"Leyendo...":t.status===Dt.ERROR?"Fallo":"Pendiente"})]},n))});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let II,RI;function NI(){return{geminiUrl:II,vertexUrl:RI}}function PI(e,t,n,r){var i,o;if(!(e!=null&&e.baseUrl)){const s=NI();return t?(i=s.vertexUrl)!==null&&i!==void 0?i:n:(o=s.geminiUrl)!==null&&o!==void 0?o:r}return e.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ir{}function se(e,t){const n=/\{([^}]+)\}/g;return e.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(t,i)){const o=t[i];return o!=null?String(o):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function c(e,t,n){for(let o=0;o<t.length-1;o++){const s=t[o];if(s.endsWith("[]")){const l=s.slice(0,-2);if(!(l in e))if(Array.isArray(n))e[l]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${s}`);if(Array.isArray(e[l])){const u=e[l];if(Array.isArray(n))for(let f=0;f<u.length;f++){const d=u[f];c(d,t.slice(o+1),n[f])}else for(const f of u)c(f,t.slice(o+1),n)}return}else if(s.endsWith("[0]")){const l=s.slice(0,-3);l in e||(e[l]=[{}]);const u=e[l];c(u[0],t.slice(o+1),n);return}(!e[s]||typeof e[s]!="object")&&(e[s]={}),e=e[s]}const r=t[t.length-1],i=e[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(e,n):e[r]=n}function a(e,t,n=void 0){try{if(t.length===1&&t[0]==="_self")return e;for(let r=0;r<t.length;r++){if(typeof e!="object"||e===null)return n;const i=t[r];if(i.endsWith("[]")){const o=i.slice(0,-2);if(o in e){const s=e[o];return Array.isArray(s)?s.map(l=>a(l,t.slice(r+1),n)):n}else return n}else e=e[i]}return e}catch(r){if(r instanceof TypeError)return n;throw r}}function FI(e,t){for(const[n,r]of Object.entries(t)){const i=n.split("."),o=r.split("."),s=new Set;let l=-1;for(let u=0;u<i.length;u++)if(i[u]==="*"){l=u;break}if(l!==-1&&o.length>l)for(let u=l;u<o.length;u++){const f=o[u];f!=="*"&&!f.endsWith("[]")&&!f.endsWith("[0]")&&s.add(f)}uf(e,i,o,0,s)}}function uf(e,t,n,r,i){if(r>=t.length||typeof e!="object"||e===null)return;const o=t[r];if(o.endsWith("[]")){const s=o.slice(0,-2),l=e;if(s in l&&Array.isArray(l[s]))for(const u of l[s])uf(u,t,n,r+1,i)}else if(o==="*"){if(typeof e=="object"&&e!==null&&!Array.isArray(e)){const s=e,l=Object.keys(s).filter(f=>!f.startsWith("_")&&!i.has(f)),u={};for(const f of l)u[f]=s[f];for(const[f,d]of Object.entries(u)){const h=[];for(const p of n.slice(r))p==="*"?h.push(f):h.push(p);c(s,h,d)}for(const f of l)delete s[f]}}else{const s=e;o in s&&uf(s[o],t,n,r+1,i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Mc(e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function kI(e){const t={},n=a(e,["operationName"]);n!=null&&c(t,["operationName"],n);const r=a(e,["resourceName"]);return r!=null&&c(t,["_url","resourceName"],r),t}function MI(e){const t={},n=a(e,["name"]);n!=null&&c(t,["name"],n);const r=a(e,["metadata"]);r!=null&&c(t,["metadata"],r);const i=a(e,["done"]);i!=null&&c(t,["done"],i);const o=a(e,["error"]);o!=null&&c(t,["error"],o);const s=a(e,["response","generateVideoResponse"]);return s!=null&&c(t,["response"],LI(s)),t}function DI(e){const t={},n=a(e,["name"]);n!=null&&c(t,["name"],n);const r=a(e,["metadata"]);r!=null&&c(t,["metadata"],r);const i=a(e,["done"]);i!=null&&c(t,["done"],i);const o=a(e,["error"]);o!=null&&c(t,["error"],o);const s=a(e,["response"]);return s!=null&&c(t,["response"],OI(s)),t}function LI(e){const t={},n=a(e,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>UI(s))),c(t,["generatedVideos"],o)}const r=a(e,["raiMediaFilteredCount"]);r!=null&&c(t,["raiMediaFilteredCount"],r);const i=a(e,["raiMediaFilteredReasons"]);return i!=null&&c(t,["raiMediaFilteredReasons"],i),t}function OI(e){const t={},n=a(e,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>BI(s))),c(t,["generatedVideos"],o)}const r=a(e,["raiMediaFilteredCount"]);r!=null&&c(t,["raiMediaFilteredCount"],r);const i=a(e,["raiMediaFilteredReasons"]);return i!=null&&c(t,["raiMediaFilteredReasons"],i),t}function UI(e){const t={},n=a(e,["video"]);return n!=null&&c(t,["video"],qI(n)),t}function BI(e){const t={},n=a(e,["_self"]);return n!=null&&c(t,["video"],$I(n)),t}function VI(e){const t={},n=a(e,["operationName"]);return n!=null&&c(t,["_url","operationName"],n),t}function GI(e){const t={},n=a(e,["operationName"]);return n!=null&&c(t,["_url","operationName"],n),t}function HI(e){const t={},n=a(e,["name"]);n!=null&&c(t,["name"],n);const r=a(e,["metadata"]);r!=null&&c(t,["metadata"],r);const i=a(e,["done"]);i!=null&&c(t,["done"],i);const o=a(e,["error"]);o!=null&&c(t,["error"],o);const s=a(e,["response"]);return s!=null&&c(t,["response"],WI(s)),t}function WI(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["parent"]);r!=null&&c(t,["parent"],r);const i=a(e,["documentName"]);return i!=null&&c(t,["documentName"],i),t}function dv(e){const t={},n=a(e,["name"]);n!=null&&c(t,["name"],n);const r=a(e,["metadata"]);r!=null&&c(t,["metadata"],r);const i=a(e,["done"]);i!=null&&c(t,["done"],i);const o=a(e,["error"]);o!=null&&c(t,["error"],o);const s=a(e,["response"]);return s!=null&&c(t,["response"],zI(s)),t}function zI(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["parent"]);r!=null&&c(t,["parent"],r);const i=a(e,["documentName"]);return i!=null&&c(t,["documentName"],i),t}function qI(e){const t={},n=a(e,["uri"]);n!=null&&c(t,["uri"],n);const r=a(e,["encodedVideo"]);r!=null&&c(t,["videoBytes"],Mc(r));const i=a(e,["encoding"]);return i!=null&&c(t,["mimeType"],i),t}function $I(e){const t={},n=a(e,["gcsUri"]);n!=null&&c(t,["uri"],n);const r=a(e,["bytesBase64Encoded"]);r!=null&&c(t,["videoBytes"],Mc(r));const i=a(e,["mimeType"]);return i!=null&&c(t,["mimeType"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Kd;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Kd||(Kd={}));var Xd;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(Xd||(Xd={}));var bd;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(bd||(bd={}));var it;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(it||(it={}));var Qd;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(Qd||(Qd={}));var Zd;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(Zd||(Zd={}));var jd;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(jd||(jd={}));var eh;(function(e){e.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",e.HTTP_IN_QUERY="HTTP_IN_QUERY",e.HTTP_IN_HEADER="HTTP_IN_HEADER",e.HTTP_IN_PATH="HTTP_IN_PATH",e.HTTP_IN_BODY="HTTP_IN_BODY",e.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(eh||(eh={}));var th;(function(e){e.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",e.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",e.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",e.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(th||(th={}));var nh;(function(e){e.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",e.LOW="LOW",e.HIGH="HIGH"})(nh||(nh={}));var rh;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(rh||(rh={}));var ih;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(ih||(ih={}));var oh;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(oh||(oh={}));var sh;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",e.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",e.NO_IMAGE="NO_IMAGE"})(sh||(sh={}));var lh;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(lh||(lh={}));var ah;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(ah||(ah={}));var uh;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(uh||(uh={}));var fh;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY",e.MODEL_ARMOR="MODEL_ARMOR",e.JAILBREAK="JAILBREAK"})(fh||(fh={}));var ch;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(ch||(ch={}));var Yl;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(Yl||(Yl={}));var dh;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(dh||(dh={}));var hh;(function(e){e.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",e.TUNING_MODE_FULL="TUNING_MODE_FULL",e.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(hh||(hh={}));var ph;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(ph||(ph={}));var ff;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(ff||(ff={}));var mh;(function(e){e.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",e.TUNING_TASK_I2V="TUNING_TASK_I2V",e.TUNING_TASK_T2V="TUNING_TASK_T2V",e.TUNING_TASK_R2V="TUNING_TASK_R2V"})(mh||(mh={}));var gh;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(gh||(gh={}));var vh;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(vh||(vh={}));var xh;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(xh||(xh={}));var _h;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(_h||(_h={}));var yh;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(yh||(yh={}));var Th;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE",e.VALIDATED="VALIDATED"})(Th||(Th={}));var Eh;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(Eh||(Eh={}));var Sh;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(Sh||(Sh={}));var wh;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"})(wh||(wh={}));var Ch;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Ch||(Ch={}));var Ah;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Ah||(Ah={}));var Ih;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Ih||(Ih={}));var Rh;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Rh||(Rh={}));var Nh;(function(e){e.FOREGROUND="FOREGROUND",e.BACKGROUND="BACKGROUND",e.PROMPT="PROMPT",e.SEMANTIC="SEMANTIC",e.INTERACTIVE="INTERACTIVE"})(Nh||(Nh={}));var Ph;(function(e){e.ASSET="ASSET",e.STYLE="STYLE"})(Ph||(Ph={}));var Fh;(function(e){e.INSERT="INSERT",e.REMOVE="REMOVE",e.REMOVE_STATIC="REMOVE_STATIC",e.OUTPAINT="OUTPAINT"})(Fh||(Fh={}));var kh;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(kh||(kh={}));var Mh;(function(e){e.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",e.PREFERENCE_TUNING="PREFERENCE_TUNING"})(Mh||(Mh={}));var Dh;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.STATE_PENDING="STATE_PENDING",e.STATE_ACTIVE="STATE_ACTIVE",e.STATE_FAILED="STATE_FAILED"})(Dh||(Dh={}));var Lh;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(Lh||(Lh={}));var Oh;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(Oh||(Oh={}));var Uh;(function(e){e.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.RESPONSE_REJECTED="RESPONSE_REJECTED",e.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Uh||(Uh={}));var Bh;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(Bh||(Bh={}));var Vh;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Vh||(Vh={}));var Gh;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Gh||(Gh={}));var Hh;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(Hh||(Hh={}));var Wh;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Wh||(Wh={}));var zh;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(zh||(zh={}));var qh;(function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"})(qh||(qh={}));var Ii;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})(Ii||(Ii={}));class cf{constructor(t){const n={};for(const r of t.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=t}json(){return this.responseInternal.json()}}class xo{get text(){var t,n,r,i,o,s,l,u;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let f="",d=!1;const h=[];for(const p of(u=(l=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||l===void 0?void 0:l.parts)!==null&&u!==void 0?u:[]){for(const[m,v]of Object.entries(p))m!=="text"&&m!=="thought"&&m!=="thoughtSignature"&&(v!==null||v!==void 0)&&h.push(m);if(typeof p.text=="string"){if(typeof p.thought=="boolean"&&p.thought)continue;d=!0,f+=p.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),d?f:void 0}get data(){var t,n,r,i,o,s,l,u;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let f="";const d=[];for(const h of(u=(l=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||l===void 0?void 0:l.parts)!==null&&u!==void 0?u:[]){for(const[p,m]of Object.entries(h))p!=="inlineData"&&(m!==null||m!==void 0)&&d.push(p);h.inlineData&&typeof h.inlineData.data=="string"&&(f+=atob(h.inlineData.data))}return d.length>0&&console.warn(`there are non-data parts ${d} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),f.length>0?btoa(f):void 0}get functionCalls(){var t,n,r,i,o,s,l,u;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const f=(u=(l=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||l===void 0?void 0:l.parts)===null||u===void 0?void 0:u.filter(d=>d.functionCall).map(d=>d.functionCall).filter(d=>d!==void 0);if((f==null?void 0:f.length)!==0)return f}get executableCode(){var t,n,r,i,o,s,l,u,f;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const d=(u=(l=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||l===void 0?void 0:l.parts)===null||u===void 0?void 0:u.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(f=d==null?void 0:d[0])===null||f===void 0?void 0:f.code}get codeExecutionResult(){var t,n,r,i,o,s,l,u,f;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const d=(u=(l=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||l===void 0?void 0:l.parts)===null||u===void 0?void 0:u.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(f=d==null?void 0:d[0])===null||f===void 0?void 0:f.output}}class $h{}class Jh{}class JI{}class YI{}class KI{}class XI{}class Yh{}class Kh{}class Xh{}class bI{}class Kl{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const r=new Kl;let i;const o=t;return n?i=DI(o):i=MI(o),Object.assign(r,i),r}}class bh{}class Qh{}class Zh{}class QI{}class ZI{}class jI{}class Dc{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const r=new Dc,o=HI(t);return Object.assign(r,o),r}}class eR{}class tR{}class nR{}class jh{}class rR{get text(){var t,n,r;let i="",o=!1;const s=[];for(const l of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[u,f]of Object.entries(l))u!=="text"&&u!=="thought"&&f!==null&&s.push(u);if(typeof l.text=="string"){if(typeof l.thought=="boolean"&&l.thought)continue;o=!0,i+=l.text}}return s.length>0&&console.warn(`there are non-text parts ${s} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?i:void 0}get data(){var t,n,r;let i="";const o=[];for(const s of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,u]of Object.entries(s))l!=="inlineData"&&u!==null&&o.push(l);s.inlineData&&typeof s.inlineData.data=="string"&&(i+=atob(s.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class iR{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Lc{_fromAPIResponse({apiResponse:t,_isVertexAI:n}){const r=new Lc,o=dv(t);return Object.assign(r,o),r}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ce(e,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(t.includes("..")||t.includes("?")||t.includes("&"))throw new Error("invalid model parameter");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const n=t.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function hv(e,t){const n=Ce(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function pv(e){return Array.isArray(e)?e.map(t=>Xl(t)):[Xl(e)]}function Xl(e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function mv(e){const t=Xl(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function gv(e){const t=Xl(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function ep(e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function vv(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>ep(t)):[ep(e)]}function df(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function tp(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function np(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function At(e){if(e==null)throw new Error("ContentUnion is required");return df(e)?e:{role:"user",parts:vv(e)}}function Oc(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(n=>{const r=At(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const n=At(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(t)?t.map(n=>At(n)):[At(t)]}function dn(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(tp(e)||np(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[At(e)]}const t=[],n=[],r=df(e[0]);for(const i of e){const o=df(i);if(o!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)t.push(i);else{if(tp(i)||np(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||t.push({role:"user",parts:vv(n)}),t}function oR(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(r=>r!=="null");if(n.length===1)t.type=Object.values(it).includes(n[0].toUpperCase())?n[0].toUpperCase():it.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const r of n)t.anyOf.push({type:Object.values(it).includes(r.toUpperCase())?r.toUpperCase():it.TYPE_UNSPECIFIED})}}function Bi(e){const t={},n=["items"],r=["anyOf"],i=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const o=e.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(t.nullable=!0,e=o[1]):o[1].type==="null"&&(t.nullable=!0,e=o[0])),e.type instanceof Array&&oR(e.type,t);for(const[s,l]of Object.entries(e))if(l!=null)if(s=="type"){if(l==="null")throw new Error("type: null can not be the only possible type for the field.");if(l instanceof Array)continue;t.type=Object.values(it).includes(l.toUpperCase())?l.toUpperCase():it.TYPE_UNSPECIFIED}else if(n.includes(s))t[s]=Bi(l);else if(r.includes(s)){const u=[];for(const f of l){if(f.type=="null"){t.nullable=!0;continue}u.push(Bi(f))}t[s]=u}else if(i.includes(s)){const u={};for(const[f,d]of Object.entries(l))u[f]=Bi(d);t[s]=u}else{if(s==="additionalProperties")continue;t[s]=l}return t}function Uc(e){return Bi(e)}function Bc(e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function Vc(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function no(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=Bi(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=Bi(t.response));return e}function ro(e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function sR(e,t,n,r=1){const i=!t.startsWith(`${n}/`)&&t.split("/").length===r;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:i?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:i?`${n}/${t}`:t}function or(e,t){if(typeof t!="string")throw new Error("name must be a string");return sR(e,t,"cachedContents")}function xv(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Mr(e){return Mc(e)}function lR(e){return e!=null&&typeof e=="object"&&"name"in e}function aR(e){return e!=null&&typeof e=="object"&&"video"in e}function uR(e){return e!=null&&typeof e=="object"&&"uri"in e}function _v(e){var t;let n;if(lR(e)&&(n=e.name),!(uR(e)&&(n=e.uri,n===void 0))&&!(aR(e)&&(n=(t=e.video)===null||t===void 0?void 0:t.uri,n===void 0))){if(typeof e=="string"&&(n=e),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function yv(e,t){let n;return e.isVertexAI()?n=t?"publishers/google/models":"models":n=t?"models":"tunedModels",n}function Tv(e){for(const t of["models","tunedModels","publisherModels"])if(fR(e,t))return e[t];return[]}function fR(e,t){return e!==null&&typeof e=="object"&&t in e}function cR(e,t={}){const n=e,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),t.behavior&&(r.behavior=t.behavior),{functionDeclarations:[r]}}function dR(e,t={}){const n=[],r=new Set;for(const i of e){const o=i.name;if(r.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);r.add(o);const s=cR(i,t);s.functionDeclarations&&n.push(...s.functionDeclarations)}return{functionDeclarations:n}}function Ev(e,t){let n;if(typeof t=="string")if(e.isVertexAI())if(t.startsWith("gs://"))n={format:"jsonl",gcsUri:[t]};else if(t.startsWith("bq://"))n={format:"bigquery",bigqueryUri:t};else throw new Error(`Unsupported string source for Vertex AI: ${t}`);else if(t.startsWith("files/"))n={fileName:t};else throw new Error(`Unsupported string source for Gemini API: ${t}`);else if(Array.isArray(t)){if(e.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:t}}else n=t;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(e.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function hR(e){if(typeof e!="string")return e;const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function Sv(e){if(typeof e!="object"||e===null)return{};const t=e,n=t.inlinedResponses;if(typeof n!="object"||n===null)return e;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return e;let o=!1;for(const s of i){if(typeof s!="object"||s===null)continue;const u=s.response;if(typeof u!="object"||u===null)continue;if(u.embedding!==void 0){o=!0;break}}return o&&(t.inlinedEmbedContentResponses=t.inlinedResponses,delete t.inlinedResponses),e}function io(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function wv(e){const t=e;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pR(e){const t={},n=a(e,["responsesFile"]);n!=null&&c(t,["fileName"],n);const r=a(e,["inlinedResponses","inlinedResponses"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>KR(s))),c(t,["inlinedResponses"],o)}const i=a(e,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),c(t,["inlinedEmbedContentResponses"],o)}return t}function mR(e){const t={},n=a(e,["predictionsFormat"]);n!=null&&c(t,["format"],n);const r=a(e,["gcsDestination","outputUriPrefix"]);r!=null&&c(t,["gcsUri"],r);const i=a(e,["bigqueryDestination","outputUri"]);return i!=null&&c(t,["bigqueryUri"],i),t}function gR(e){const t={},n=a(e,["format"]);n!=null&&c(t,["predictionsFormat"],n);const r=a(e,["gcsUri"]);r!=null&&c(t,["gcsDestination","outputUriPrefix"],r);const i=a(e,["bigqueryUri"]);if(i!=null&&c(t,["bigqueryDestination","outputUri"],i),a(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(a(e,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(a(e,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return t}function sl(e){const t={},n=a(e,["name"]);n!=null&&c(t,["name"],n);const r=a(e,["metadata","displayName"]);r!=null&&c(t,["displayName"],r);const i=a(e,["metadata","state"]);i!=null&&c(t,["state"],wv(i));const o=a(e,["metadata","createTime"]);o!=null&&c(t,["createTime"],o);const s=a(e,["metadata","endTime"]);s!=null&&c(t,["endTime"],s);const l=a(e,["metadata","updateTime"]);l!=null&&c(t,["updateTime"],l);const u=a(e,["metadata","model"]);u!=null&&c(t,["model"],u);const f=a(e,["metadata","output"]);return f!=null&&c(t,["dest"],pR(Sv(f))),t}function hf(e){const t={},n=a(e,["name"]);n!=null&&c(t,["name"],n);const r=a(e,["displayName"]);r!=null&&c(t,["displayName"],r);const i=a(e,["state"]);i!=null&&c(t,["state"],wv(i));const o=a(e,["error"]);o!=null&&c(t,["error"],o);const s=a(e,["createTime"]);s!=null&&c(t,["createTime"],s);const l=a(e,["startTime"]);l!=null&&c(t,["startTime"],l);const u=a(e,["endTime"]);u!=null&&c(t,["endTime"],u);const f=a(e,["updateTime"]);f!=null&&c(t,["updateTime"],f);const d=a(e,["model"]);d!=null&&c(t,["model"],d);const h=a(e,["inputConfig"]);h!=null&&c(t,["src"],vR(h));const p=a(e,["outputConfig"]);p!=null&&c(t,["dest"],mR(Sv(p)));const m=a(e,["completionStats"]);return m!=null&&c(t,["completionStats"],m),t}function vR(e){const t={},n=a(e,["instancesFormat"]);n!=null&&c(t,["format"],n);const r=a(e,["gcsSource","uris"]);r!=null&&c(t,["gcsUri"],r);const i=a(e,["bigquerySource","inputUri"]);return i!=null&&c(t,["bigqueryUri"],i),t}function xR(e,t){const n={};if(a(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(a(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(a(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=a(t,["fileName"]);r!=null&&c(n,["fileName"],r);const i=a(t,["inlinedRequests"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>YR(e,s))),c(n,["requests","requests"],o)}return n}function _R(e){const t={},n=a(e,["format"]);n!=null&&c(t,["instancesFormat"],n);const r=a(e,["gcsUri"]);r!=null&&c(t,["gcsSource","uris"],r);const i=a(e,["bigqueryUri"]);if(i!=null&&c(t,["bigquerySource","inputUri"],i),a(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(a(e,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function yR(e){const t={},n=a(e,["data"]);if(n!=null&&c(t,["data"],n),a(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=a(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function TR(e,t){const n={},r=a(t,["name"]);return r!=null&&c(n,["_url","name"],io(e,r)),n}function ER(e,t){const n={},r=a(t,["name"]);return r!=null&&c(n,["_url","name"],io(e,r)),n}function SR(e){const t={},n=a(e,["content"]);n!=null&&c(t,["content"],n);const r=a(e,["citationMetadata"]);r!=null&&c(t,["citationMetadata"],wR(r));const i=a(e,["tokenCount"]);i!=null&&c(t,["tokenCount"],i);const o=a(e,["finishReason"]);o!=null&&c(t,["finishReason"],o);const s=a(e,["avgLogprobs"]);s!=null&&c(t,["avgLogprobs"],s);const l=a(e,["groundingMetadata"]);l!=null&&c(t,["groundingMetadata"],l);const u=a(e,["index"]);u!=null&&c(t,["index"],u);const f=a(e,["logprobsResult"]);f!=null&&c(t,["logprobsResult"],f);const d=a(e,["safetyRatings"]);if(d!=null){let p=d;Array.isArray(p)&&(p=p.map(m=>m)),c(t,["safetyRatings"],p)}const h=a(e,["urlContextMetadata"]);return h!=null&&c(t,["urlContextMetadata"],h),t}function wR(e){const t={},n=a(e,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),c(t,["citations"],r)}return t}function Cv(e){const t={},n=a(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>tN(o))),c(t,["parts"],i)}const r=a(e,["role"]);return r!=null&&c(t,["role"],r),t}function CR(e,t){const n={},r=a(e,["displayName"]);if(t!==void 0&&r!=null&&c(t,["batch","displayName"],r),a(e,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function AR(e,t){const n={},r=a(e,["displayName"]);t!==void 0&&r!=null&&c(t,["displayName"],r);const i=a(e,["dest"]);return t!==void 0&&i!=null&&c(t,["outputConfig"],gR(hR(i))),n}function rp(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["_url","model"],Ce(e,r));const i=a(t,["src"]);i!=null&&c(n,["batch","inputConfig"],xR(e,Ev(e,i)));const o=a(t,["config"]);return o!=null&&CR(o,n),n}function IR(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["model"],Ce(e,r));const i=a(t,["src"]);i!=null&&c(n,["inputConfig"],_R(Ev(e,i)));const o=a(t,["config"]);return o!=null&&AR(o,n),n}function RR(e,t){const n={},r=a(e,["displayName"]);return t!==void 0&&r!=null&&c(t,["batch","displayName"],r),n}function NR(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["_url","model"],Ce(e,r));const i=a(t,["src"]);i!=null&&c(n,["batch","inputConfig"],OR(e,i));const o=a(t,["config"]);return o!=null&&RR(o,n),n}function PR(e,t){const n={},r=a(t,["name"]);return r!=null&&c(n,["_url","name"],io(e,r)),n}function FR(e,t){const n={},r=a(t,["name"]);return r!=null&&c(n,["_url","name"],io(e,r)),n}function kR(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["name"]);r!=null&&c(t,["name"],r);const i=a(e,["done"]);i!=null&&c(t,["done"],i);const o=a(e,["error"]);return o!=null&&c(t,["error"],o),t}function MR(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["name"]);r!=null&&c(t,["name"],r);const i=a(e,["done"]);i!=null&&c(t,["done"],i);const o=a(e,["error"]);return o!=null&&c(t,["error"],o),t}function DR(e,t){const n={},r=a(t,["contents"]);if(r!=null){let o=Oc(e,r);Array.isArray(o)&&(o=o.map(s=>s)),c(n,["requests[]","request","content"],o)}const i=a(t,["config"]);return i!=null&&(c(n,["_self"],LR(i,n)),FI(n,{"requests[].*":"requests[].request.*"})),n}function LR(e,t){const n={},r=a(e,["taskType"]);t!==void 0&&r!=null&&c(t,["requests[]","taskType"],r);const i=a(e,["title"]);t!==void 0&&i!=null&&c(t,["requests[]","title"],i);const o=a(e,["outputDimensionality"]);if(t!==void 0&&o!=null&&c(t,["requests[]","outputDimensionality"],o),a(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(a(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function OR(e,t){const n={},r=a(t,["fileName"]);r!=null&&c(n,["file_name"],r);const i=a(t,["inlinedRequests"]);return i!=null&&c(n,["requests"],DR(e,i)),n}function UR(e){const t={};if(a(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=a(e,["fileUri"]);n!=null&&c(t,["fileUri"],n);const r=a(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function BR(e){const t={},n=a(e,["id"]);n!=null&&c(t,["id"],n);const r=a(e,["args"]);r!=null&&c(t,["args"],r);const i=a(e,["name"]);if(i!=null&&c(t,["name"],i),a(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(a(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function VR(e){const t={},n=a(e,["mode"]);n!=null&&c(t,["mode"],n);const r=a(e,["allowedFunctionNames"]);if(r!=null&&c(t,["allowedFunctionNames"],r),a(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function GR(e,t,n){const r={},i=a(t,["systemInstruction"]);n!==void 0&&i!=null&&c(n,["systemInstruction"],Cv(At(i)));const o=a(t,["temperature"]);o!=null&&c(r,["temperature"],o);const s=a(t,["topP"]);s!=null&&c(r,["topP"],s);const l=a(t,["topK"]);l!=null&&c(r,["topK"],l);const u=a(t,["candidateCount"]);u!=null&&c(r,["candidateCount"],u);const f=a(t,["maxOutputTokens"]);f!=null&&c(r,["maxOutputTokens"],f);const d=a(t,["stopSequences"]);d!=null&&c(r,["stopSequences"],d);const h=a(t,["responseLogprobs"]);h!=null&&c(r,["responseLogprobs"],h);const p=a(t,["logprobs"]);p!=null&&c(r,["logprobs"],p);const m=a(t,["presencePenalty"]);m!=null&&c(r,["presencePenalty"],m);const v=a(t,["frequencyPenalty"]);v!=null&&c(r,["frequencyPenalty"],v);const g=a(t,["seed"]);g!=null&&c(r,["seed"],g);const T=a(t,["responseMimeType"]);T!=null&&c(r,["responseMimeType"],T);const _=a(t,["responseSchema"]);_!=null&&c(r,["responseSchema"],Uc(_));const x=a(t,["responseJsonSchema"]);if(x!=null&&c(r,["responseJsonSchema"],x),a(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(a(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const y=a(t,["safetySettings"]);if(n!==void 0&&y!=null){let K=y;Array.isArray(K)&&(K=K.map(ee=>nN(ee))),c(n,["safetySettings"],K)}const C=a(t,["tools"]);if(n!==void 0&&C!=null){let K=ro(C);Array.isArray(K)&&(K=K.map(ee=>iN(no(ee)))),c(n,["tools"],K)}const k=a(t,["toolConfig"]);if(n!==void 0&&k!=null&&c(n,["toolConfig"],rN(k)),a(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=a(t,["cachedContent"]);n!==void 0&&M!=null&&c(n,["cachedContent"],or(e,M));const R=a(t,["responseModalities"]);R!=null&&c(r,["responseModalities"],R);const D=a(t,["mediaResolution"]);D!=null&&c(r,["mediaResolution"],D);const F=a(t,["speechConfig"]);if(F!=null&&c(r,["speechConfig"],Bc(F)),a(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const U=a(t,["thinkingConfig"]);U!=null&&c(r,["thinkingConfig"],U);const q=a(t,["imageConfig"]);return q!=null&&c(r,["imageConfig"],JR(q)),r}function HR(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(f=>SR(f))),c(t,["candidates"],u)}const i=a(e,["modelVersion"]);i!=null&&c(t,["modelVersion"],i);const o=a(e,["promptFeedback"]);o!=null&&c(t,["promptFeedback"],o);const s=a(e,["responseId"]);s!=null&&c(t,["responseId"],s);const l=a(e,["usageMetadata"]);return l!=null&&c(t,["usageMetadata"],l),t}function WR(e,t){const n={},r=a(t,["name"]);return r!=null&&c(n,["_url","name"],io(e,r)),n}function zR(e,t){const n={},r=a(t,["name"]);return r!=null&&c(n,["_url","name"],io(e,r)),n}function qR(e){const t={};if(a(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=a(e,["enableWidget"]);return n!=null&&c(t,["enableWidget"],n),t}function $R(e){const t={};if(a(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(a(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=a(e,["timeRangeFilter"]);return n!=null&&c(t,["timeRangeFilter"],n),t}function JR(e){const t={},n=a(e,["aspectRatio"]);n!=null&&c(t,["aspectRatio"],n);const r=a(e,["imageSize"]);if(r!=null&&c(t,["imageSize"],r),a(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(a(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function YR(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["request","model"],Ce(e,r));const i=a(t,["contents"]);if(i!=null){let l=dn(i);Array.isArray(l)&&(l=l.map(u=>Cv(u))),c(n,["request","contents"],l)}const o=a(t,["metadata"]);o!=null&&c(n,["metadata"],o);const s=a(t,["config"]);return s!=null&&c(n,["request","generationConfig"],GR(e,s,a(n,["request"],{}))),n}function KR(e){const t={},n=a(e,["response"]);n!=null&&c(t,["response"],HR(n));const r=a(e,["error"]);return r!=null&&c(t,["error"],r),t}function XR(e,t){const n={},r=a(e,["pageSize"]);t!==void 0&&r!=null&&c(t,["_query","pageSize"],r);const i=a(e,["pageToken"]);if(t!==void 0&&i!=null&&c(t,["_query","pageToken"],i),a(e,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function bR(e,t){const n={},r=a(e,["pageSize"]);t!==void 0&&r!=null&&c(t,["_query","pageSize"],r);const i=a(e,["pageToken"]);t!==void 0&&i!=null&&c(t,["_query","pageToken"],i);const o=a(e,["filter"]);return t!==void 0&&o!=null&&c(t,["_query","filter"],o),n}function QR(e){const t={},n=a(e,["config"]);return n!=null&&XR(n,t),t}function ZR(e){const t={},n=a(e,["config"]);return n!=null&&bR(n,t),t}function jR(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=a(e,["operations"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>sl(s))),c(t,["batchJobs"],o)}return t}function eN(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=a(e,["batchPredictionJobs"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>hf(s))),c(t,["batchJobs"],o)}return t}function tN(e){const t={},n=a(e,["mediaResolution"]);n!=null&&c(t,["mediaResolution"],n);const r=a(e,["codeExecutionResult"]);r!=null&&c(t,["codeExecutionResult"],r);const i=a(e,["executableCode"]);i!=null&&c(t,["executableCode"],i);const o=a(e,["fileData"]);o!=null&&c(t,["fileData"],UR(o));const s=a(e,["functionCall"]);s!=null&&c(t,["functionCall"],BR(s));const l=a(e,["functionResponse"]);l!=null&&c(t,["functionResponse"],l);const u=a(e,["inlineData"]);u!=null&&c(t,["inlineData"],yR(u));const f=a(e,["text"]);f!=null&&c(t,["text"],f);const d=a(e,["thought"]);d!=null&&c(t,["thought"],d);const h=a(e,["thoughtSignature"]);h!=null&&c(t,["thoughtSignature"],h);const p=a(e,["videoMetadata"]);return p!=null&&c(t,["videoMetadata"],p),t}function nN(e){const t={},n=a(e,["category"]);if(n!=null&&c(t,["category"],n),a(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=a(e,["threshold"]);return r!=null&&c(t,["threshold"],r),t}function rN(e){const t={},n=a(e,["functionCallingConfig"]);n!=null&&c(t,["functionCallingConfig"],VR(n));const r=a(e,["retrievalConfig"]);return r!=null&&c(t,["retrievalConfig"],r),t}function iN(e){const t={},n=a(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>h)),c(t,["functionDeclarations"],d)}if(a(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=a(e,["googleSearchRetrieval"]);r!=null&&c(t,["googleSearchRetrieval"],r);const i=a(e,["computerUse"]);i!=null&&c(t,["computerUse"],i);const o=a(e,["fileSearch"]);o!=null&&c(t,["fileSearch"],o);const s=a(e,["codeExecution"]);if(s!=null&&c(t,["codeExecution"],s),a(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=a(e,["googleMaps"]);l!=null&&c(t,["googleMaps"],qR(l));const u=a(e,["googleSearch"]);u!=null&&c(t,["googleSearch"],$R(u));const f=a(e,["urlContext"]);return f!=null&&c(t,["urlContext"],f),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var tr;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents",e.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",e.PAGED_ITEM_DOCUMENTS="documents"})(tr||(tr={}));class li{constructor(t,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(t,r,i)}init(t,n,r){var i,o;this.nameInternal=t,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let s={config:{}};!r||Object.keys(r).length===0?s={config:{}}:typeof r=="object"?s=Object.assign({},r):s=r,s.config&&(s.config.pageToken=n.nextPageToken),this.paramsInternal=s,this.pageInternalSize=(o=(i=s.config)===null||i===void 0?void 0:i.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class oN extends ir{constructor(t){super(),this.apiClient=t,this.create=async n=>(this.apiClient.isVertexAI()&&(n.config=this.formatDestination(n.src,n.config)),this.createInternal(n)),this.createEmbeddings=async n=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(n)},this.list=async(n={})=>new li(tr.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}createInlinedGenerateContentRequest(t){const n=rp(this.apiClient,t),r=n._url,i=se("{model}:batchGenerateContent",r),l=n.batch.inputConfig.requests,u=l.requests,f=[];for(const d of u){const h=Object.assign({},d);if(h.systemInstruction){const p=h.systemInstruction;delete h.systemInstruction;const m=h.request;m.systemInstruction=p,h.request=m}f.push(h)}return l.requests=f,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(t){if(typeof t=="string")return t.startsWith("gs://")?t:void 0;if(!Array.isArray(t)&&t.gcsUri&&t.gcsUri.length>0)return t.gcsUri[0]}getBigqueryUri(t){if(typeof t=="string")return t.startsWith("bq://")?t:void 0;if(!Array.isArray(t))return t.bigqueryUri}formatDestination(t,n){const r=n?Object.assign({},n):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const o=this.getGcsUri(t),s=this.getBigqueryUri(t);if(o)o.endsWith(".jsonl")?r.dest=`${o.slice(0,-6)}/dest`:r.dest=`${o}_dest_${i}`;else if(s)r.dest=`${s}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=IR(this.apiClient,t);return l=se("batchPredictionJobs",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),s.then(d=>hf(d))}else{const f=rp(this.apiClient,t);return l=se("{model}:batchGenerateContent",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),s.then(d=>sl(d))}}async createEmbeddingsInternal(t){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=NR(this.apiClient,t);return o=se("{model}:asyncBatchEmbedContent",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>sl(u))}}async get(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=zR(this.apiClient,t);return l=se("batchPredictionJobs/{name}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),s.then(d=>hf(d))}else{const f=WR(this.apiClient,t);return l=se("batches/{name}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),s.then(d=>sl(d))}}async cancel(t){var n,r,i,o;let s="",l={};if(this.apiClient.isVertexAI()){const u=ER(this.apiClient,t);s=se("batchPredictionJobs/{name}:cancel",u._url),l=u._query,delete u._url,delete u._query,await this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}else{const u=TR(this.apiClient,t);s=se("batches/{name}:cancel",u._url),l=u._query,delete u._url,delete u._query,await this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=ZR(t);return l=se("batchPredictionJobs",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=eN(d),p=new jh;return Object.assign(p,h),p})}else{const f=QR(t);return l=se("batches",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=jR(d),p=new jh;return Object.assign(p,h),p})}}async delete(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=FR(this.apiClient,t);return l=se("batchPredictionJobs/{name}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>MR(d))}else{const f=PR(this.apiClient,t);return l=se("batches/{name}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>kR(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sN(e){const t={},n=a(e,["data"]);if(n!=null&&c(t,["data"],n),a(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=a(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function ip(e){const t={},n=a(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>NN(o))),c(t,["parts"],i)}const r=a(e,["role"]);return r!=null&&c(t,["role"],r),t}function lN(e,t){const n={},r=a(e,["ttl"]);t!==void 0&&r!=null&&c(t,["ttl"],r);const i=a(e,["expireTime"]);t!==void 0&&i!=null&&c(t,["expireTime"],i);const o=a(e,["displayName"]);t!==void 0&&o!=null&&c(t,["displayName"],o);const s=a(e,["contents"]);if(t!==void 0&&s!=null){let d=dn(s);Array.isArray(d)&&(d=d.map(h=>ip(h))),c(t,["contents"],d)}const l=a(e,["systemInstruction"]);t!==void 0&&l!=null&&c(t,["systemInstruction"],ip(At(l)));const u=a(e,["tools"]);if(t!==void 0&&u!=null){let d=u;Array.isArray(d)&&(d=d.map(h=>FN(h))),c(t,["tools"],d)}const f=a(e,["toolConfig"]);if(t!==void 0&&f!=null&&c(t,["toolConfig"],PN(f)),a(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function aN(e,t){const n={},r=a(e,["ttl"]);t!==void 0&&r!=null&&c(t,["ttl"],r);const i=a(e,["expireTime"]);t!==void 0&&i!=null&&c(t,["expireTime"],i);const o=a(e,["displayName"]);t!==void 0&&o!=null&&c(t,["displayName"],o);const s=a(e,["contents"]);if(t!==void 0&&s!=null){let h=dn(s);Array.isArray(h)&&(h=h.map(p=>p)),c(t,["contents"],h)}const l=a(e,["systemInstruction"]);t!==void 0&&l!=null&&c(t,["systemInstruction"],At(l));const u=a(e,["tools"]);if(t!==void 0&&u!=null){let h=u;Array.isArray(h)&&(h=h.map(p=>kN(p))),c(t,["tools"],h)}const f=a(e,["toolConfig"]);t!==void 0&&f!=null&&c(t,["toolConfig"],f);const d=a(e,["kmsKeyName"]);return t!==void 0&&d!=null&&c(t,["encryption_spec","kmsKeyName"],d),n}function uN(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["model"],hv(e,r));const i=a(t,["config"]);return i!=null&&lN(i,n),n}function fN(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["model"],hv(e,r));const i=a(t,["config"]);return i!=null&&aN(i,n),n}function cN(e,t){const n={},r=a(t,["name"]);return r!=null&&c(n,["_url","name"],or(e,r)),n}function dN(e,t){const n={},r=a(t,["name"]);return r!=null&&c(n,["_url","name"],or(e,r)),n}function hN(e){const t={},n=a(e,["sdkHttpResponse"]);return n!=null&&c(t,["sdkHttpResponse"],n),t}function pN(e){const t={},n=a(e,["sdkHttpResponse"]);return n!=null&&c(t,["sdkHttpResponse"],n),t}function mN(e){const t={};if(a(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=a(e,["fileUri"]);n!=null&&c(t,["fileUri"],n);const r=a(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function gN(e){const t={},n=a(e,["id"]);n!=null&&c(t,["id"],n);const r=a(e,["args"]);r!=null&&c(t,["args"],r);const i=a(e,["name"]);if(i!=null&&c(t,["name"],i),a(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(a(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function vN(e){const t={},n=a(e,["mode"]);n!=null&&c(t,["mode"],n);const r=a(e,["allowedFunctionNames"]);if(r!=null&&c(t,["allowedFunctionNames"],r),a(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function xN(e){const t={};if(a(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=a(e,["description"]);n!=null&&c(t,["description"],n);const r=a(e,["name"]);r!=null&&c(t,["name"],r);const i=a(e,["parameters"]);i!=null&&c(t,["parameters"],i);const o=a(e,["parametersJsonSchema"]);o!=null&&c(t,["parametersJsonSchema"],o);const s=a(e,["response"]);s!=null&&c(t,["response"],s);const l=a(e,["responseJsonSchema"]);return l!=null&&c(t,["responseJsonSchema"],l),t}function _N(e,t){const n={},r=a(t,["name"]);return r!=null&&c(n,["_url","name"],or(e,r)),n}function yN(e,t){const n={},r=a(t,["name"]);return r!=null&&c(n,["_url","name"],or(e,r)),n}function TN(e){const t={};if(a(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=a(e,["enableWidget"]);return n!=null&&c(t,["enableWidget"],n),t}function EN(e){const t={};if(a(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(a(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=a(e,["timeRangeFilter"]);return n!=null&&c(t,["timeRangeFilter"],n),t}function SN(e,t){const n={},r=a(e,["pageSize"]);t!==void 0&&r!=null&&c(t,["_query","pageSize"],r);const i=a(e,["pageToken"]);return t!==void 0&&i!=null&&c(t,["_query","pageToken"],i),n}function wN(e,t){const n={},r=a(e,["pageSize"]);t!==void 0&&r!=null&&c(t,["_query","pageSize"],r);const i=a(e,["pageToken"]);return t!==void 0&&i!=null&&c(t,["_query","pageToken"],i),n}function CN(e){const t={},n=a(e,["config"]);return n!=null&&SN(n,t),t}function AN(e){const t={},n=a(e,["config"]);return n!=null&&wN(n,t),t}function IN(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=a(e,["cachedContents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),c(t,["cachedContents"],o)}return t}function RN(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=a(e,["cachedContents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),c(t,["cachedContents"],o)}return t}function NN(e){const t={},n=a(e,["mediaResolution"]);n!=null&&c(t,["mediaResolution"],n);const r=a(e,["codeExecutionResult"]);r!=null&&c(t,["codeExecutionResult"],r);const i=a(e,["executableCode"]);i!=null&&c(t,["executableCode"],i);const o=a(e,["fileData"]);o!=null&&c(t,["fileData"],mN(o));const s=a(e,["functionCall"]);s!=null&&c(t,["functionCall"],gN(s));const l=a(e,["functionResponse"]);l!=null&&c(t,["functionResponse"],l);const u=a(e,["inlineData"]);u!=null&&c(t,["inlineData"],sN(u));const f=a(e,["text"]);f!=null&&c(t,["text"],f);const d=a(e,["thought"]);d!=null&&c(t,["thought"],d);const h=a(e,["thoughtSignature"]);h!=null&&c(t,["thoughtSignature"],h);const p=a(e,["videoMetadata"]);return p!=null&&c(t,["videoMetadata"],p),t}function PN(e){const t={},n=a(e,["functionCallingConfig"]);n!=null&&c(t,["functionCallingConfig"],vN(n));const r=a(e,["retrievalConfig"]);return r!=null&&c(t,["retrievalConfig"],r),t}function FN(e){const t={},n=a(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>h)),c(t,["functionDeclarations"],d)}if(a(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=a(e,["googleSearchRetrieval"]);r!=null&&c(t,["googleSearchRetrieval"],r);const i=a(e,["computerUse"]);i!=null&&c(t,["computerUse"],i);const o=a(e,["fileSearch"]);o!=null&&c(t,["fileSearch"],o);const s=a(e,["codeExecution"]);if(s!=null&&c(t,["codeExecution"],s),a(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=a(e,["googleMaps"]);l!=null&&c(t,["googleMaps"],TN(l));const u=a(e,["googleSearch"]);u!=null&&c(t,["googleSearch"],EN(u));const f=a(e,["urlContext"]);return f!=null&&c(t,["urlContext"],f),t}function kN(e){const t={},n=a(e,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>xN(p))),c(t,["functionDeclarations"],h)}const r=a(e,["retrieval"]);r!=null&&c(t,["retrieval"],r);const i=a(e,["googleSearchRetrieval"]);i!=null&&c(t,["googleSearchRetrieval"],i);const o=a(e,["computerUse"]);if(o!=null&&c(t,["computerUse"],o),a(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=a(e,["codeExecution"]);s!=null&&c(t,["codeExecution"],s);const l=a(e,["enterpriseWebSearch"]);l!=null&&c(t,["enterpriseWebSearch"],l);const u=a(e,["googleMaps"]);u!=null&&c(t,["googleMaps"],u);const f=a(e,["googleSearch"]);f!=null&&c(t,["googleSearch"],f);const d=a(e,["urlContext"]);return d!=null&&c(t,["urlContext"],d),t}function MN(e,t){const n={},r=a(e,["ttl"]);t!==void 0&&r!=null&&c(t,["ttl"],r);const i=a(e,["expireTime"]);return t!==void 0&&i!=null&&c(t,["expireTime"],i),n}function DN(e,t){const n={},r=a(e,["ttl"]);t!==void 0&&r!=null&&c(t,["ttl"],r);const i=a(e,["expireTime"]);return t!==void 0&&i!=null&&c(t,["expireTime"],i),n}function LN(e,t){const n={},r=a(t,["name"]);r!=null&&c(n,["_url","name"],or(e,r));const i=a(t,["config"]);return i!=null&&MN(i,n),n}function ON(e,t){const n={},r=a(t,["name"]);r!=null&&c(n,["_url","name"],or(e,r));const i=a(t,["config"]);return i!=null&&DN(i,n),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class UN extends ir{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new li(tr.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=fN(this.apiClient,t);return l=se("cachedContents",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),s.then(d=>d)}else{const f=uN(this.apiClient,t);return l=se("cachedContents",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),s.then(d=>d)}}async get(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=yN(this.apiClient,t);return l=se("{name}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),s.then(d=>d)}else{const f=_N(this.apiClient,t);return l=se("{name}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),s.then(d=>d)}}async delete(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=dN(this.apiClient,t);return l=se("{name}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=pN(d),p=new Qh;return Object.assign(p,h),p})}else{const f=cN(this.apiClient,t);return l=se("{name}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=hN(d),p=new Qh;return Object.assign(p,h),p})}}async update(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=ON(this.apiClient,t);return l=se("{name}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),s.then(d=>d)}else{const f=LN(this.apiClient,t);return l=se("{name}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),s.then(d=>d)}}async listInternal(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=AN(t);return l=se("cachedContents",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=RN(d),p=new Zh;return Object.assign(p,h),p})}else{const f=CN(t);return l=se("cachedContents",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=IN(d),p=new Zh;return Object.assign(p,h),p})}}}function op(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ve(e){return this instanceof Ve?(this.v=e,this):new Ve(e)}function Vi(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(m){return function(v){return Promise.resolve(v).then(m,h)}}function l(m,v){r[m]&&(i[m]=function(g){return new Promise(function(T,_){o.push([m,g,T,_])>1||u(m,g)})},v&&(i[m]=v(i[m])))}function u(m,v){try{f(r[m](v))}catch(g){p(o[0][3],g)}}function f(m){m.value instanceof Ve?Promise.resolve(m.value.v).then(d,h):p(o[0][2],m)}function d(m){u("next",m)}function h(m){u("throw",m)}function p(m,v){m(v),o.shift(),o.length&&u(o[0][0],o[0][1])}}function Vo(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof op=="function"?op(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=e[o]&&function(s){return new Promise(function(l,u){s=e[o](s),i(l,u,s.done,s.value)})}}function i(o,s,l,u){Promise.resolve(u).then(function(f){o({value:f,done:l})},s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function BN(e){var t;if(e.candidates==null||e.candidates.length===0)return!1;const n=(t=e.candidates[0])===null||t===void 0?void 0:t.content;return n===void 0?!1:Av(n)}function Av(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const t of e.parts)if(t===void 0||Object.keys(t).length===0)return!1;return!0}function VN(e){if(e.length!==0){for(const t of e)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function sp(e){if(e===void 0||e.length===0)return[];const t=[],n=e.length;let r=0;for(;r<n;)if(e[r].role==="user")t.push(e[r]),r++;else{const i=[];let o=!0;for(;r<n&&e[r].role==="model";)i.push(e[r]),o&&!Av(e[r])&&(o=!1),r++;o?t.push(...i):t.pop()}return t}class GN{constructor(t,n){this.modelsModule=t,this.apiClient=n}create(t){return new HN(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class HN{constructor(t,n,r,i={},o=[]){this.apiClient=t,this.modelsModule=n,this.model=r,this.config=i,this.history=o,this.sendPromise=Promise.resolve(),VN(o)}async sendMessage(t){var n;await this.sendPromise;const r=At(t.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var o,s,l;const u=await i,f=(s=(o=u.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content,d=u.automaticFunctionCallingHistory,h=this.getHistory(!0).length;let p=[];d!=null&&(p=(l=d.slice(h))!==null&&l!==void 0?l:[]);const m=f?[f]:[];this.recordHistory(r,m,p)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(t){var n;await this.sendPromise;const r=At(t.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const o=await i;return this.processStreamResponse(o,r)}getHistory(t=!1){const n=t?sp(this.history):this.history;return structuredClone(n)}processStreamResponse(t,n){var r,i;return Vi(this,arguments,function*(){var s,l,u,f;const d=[];try{for(var h=!0,p=Vo(t),m;m=yield Ve(p.next()),s=m.done,!s;h=!0){f=m.value,h=!1;const v=f;if(BN(v)){const g=(i=(r=v.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;g!==void 0&&d.push(g)}yield yield Ve(v)}}catch(v){l={error:v}}finally{try{!h&&!s&&(u=p.return)&&(yield Ve(u.call(p)))}finally{if(l)throw l.error}}this.recordHistory(n,d)})}recordHistory(t,n,r){let i=[];n.length>0&&n.every(o=>o.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...sp(r)):this.history.push(t),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ta extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,Ta.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function WN(e){const t={},n=a(e,["file"]);return n!=null&&c(t,["file"],n),t}function zN(e){const t={},n=a(e,["sdkHttpResponse"]);return n!=null&&c(t,["sdkHttpResponse"],n),t}function qN(e){const t={},n=a(e,["name"]);return n!=null&&c(t,["_url","file"],_v(n)),t}function $N(e){const t={},n=a(e,["sdkHttpResponse"]);return n!=null&&c(t,["sdkHttpResponse"],n),t}function JN(e){const t={},n=a(e,["name"]);return n!=null&&c(t,["_url","file"],_v(n)),t}function YN(e,t){const n={},r=a(e,["pageSize"]);t!==void 0&&r!=null&&c(t,["_query","pageSize"],r);const i=a(e,["pageToken"]);return t!==void 0&&i!=null&&c(t,["_query","pageToken"],i),n}function KN(e){const t={},n=a(e,["config"]);return n!=null&&YN(n,t),t}function XN(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=a(e,["files"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),c(t,["files"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class bN extends ir{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new li(tr.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(n=>n)}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=KN(t);return o=se("files",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),i.then(u=>{const f=XN(u),d=new eR;return Object.assign(d,f),d})}}async createInternal(t){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=WN(t);return o=se("upload/v1beta/files",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const f=zN(u),d=new tR;return Object.assign(d,f),d})}}async get(t){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=JN(t);return o=se("files/{file}",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}async delete(t){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=qN(t);return o=se("files/{file}",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),i.then(u=>{const f=$N(u),d=new nR;return Object.assign(d,f),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ll(e){const t={},n=a(e,["data"]);if(n!=null&&c(t,["data"],n),a(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=a(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function QN(e){const t={},n=a(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>h4(o))),c(t,["parts"],i)}const r=a(e,["role"]);return r!=null&&c(t,["role"],r),t}function ZN(e){const t={};if(a(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=a(e,["fileUri"]);n!=null&&c(t,["fileUri"],n);const r=a(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function jN(e){const t={},n=a(e,["id"]);n!=null&&c(t,["id"],n);const r=a(e,["args"]);r!=null&&c(t,["args"],r);const i=a(e,["name"]);if(i!=null&&c(t,["name"],i),a(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(a(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function e4(e){const t={};if(a(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=a(e,["description"]);n!=null&&c(t,["description"],n);const r=a(e,["name"]);r!=null&&c(t,["name"],r);const i=a(e,["parameters"]);i!=null&&c(t,["parameters"],i);const o=a(e,["parametersJsonSchema"]);o!=null&&c(t,["parametersJsonSchema"],o);const s=a(e,["response"]);s!=null&&c(t,["response"],s);const l=a(e,["responseJsonSchema"]);return l!=null&&c(t,["responseJsonSchema"],l),t}function t4(e){const t={},n=a(e,["modelSelectionConfig"]);n!=null&&c(t,["modelConfig"],n);const r=a(e,["responseJsonSchema"]);r!=null&&c(t,["responseJsonSchema"],r);const i=a(e,["audioTimestamp"]);i!=null&&c(t,["audioTimestamp"],i);const o=a(e,["candidateCount"]);o!=null&&c(t,["candidateCount"],o);const s=a(e,["enableAffectiveDialog"]);s!=null&&c(t,["enableAffectiveDialog"],s);const l=a(e,["frequencyPenalty"]);l!=null&&c(t,["frequencyPenalty"],l);const u=a(e,["logprobs"]);u!=null&&c(t,["logprobs"],u);const f=a(e,["maxOutputTokens"]);f!=null&&c(t,["maxOutputTokens"],f);const d=a(e,["mediaResolution"]);d!=null&&c(t,["mediaResolution"],d);const h=a(e,["presencePenalty"]);h!=null&&c(t,["presencePenalty"],h);const p=a(e,["responseLogprobs"]);p!=null&&c(t,["responseLogprobs"],p);const m=a(e,["responseMimeType"]);m!=null&&c(t,["responseMimeType"],m);const v=a(e,["responseModalities"]);v!=null&&c(t,["responseModalities"],v);const g=a(e,["responseSchema"]);g!=null&&c(t,["responseSchema"],g);const T=a(e,["routingConfig"]);T!=null&&c(t,["routingConfig"],T);const _=a(e,["seed"]);_!=null&&c(t,["seed"],_);const x=a(e,["speechConfig"]);x!=null&&c(t,["speechConfig"],Iv(x));const y=a(e,["stopSequences"]);y!=null&&c(t,["stopSequences"],y);const C=a(e,["temperature"]);C!=null&&c(t,["temperature"],C);const k=a(e,["thinkingConfig"]);k!=null&&c(t,["thinkingConfig"],k);const M=a(e,["topK"]);M!=null&&c(t,["topK"],M);const R=a(e,["topP"]);if(R!=null&&c(t,["topP"],R),a(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function n4(e){const t={};if(a(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=a(e,["enableWidget"]);return n!=null&&c(t,["enableWidget"],n),t}function r4(e){const t={};if(a(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(a(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=a(e,["timeRangeFilter"]);return n!=null&&c(t,["timeRangeFilter"],n),t}function i4(e,t){const n={},r=a(e,["generationConfig"]);t!==void 0&&r!=null&&c(t,["setup","generationConfig"],r);const i=a(e,["responseModalities"]);t!==void 0&&i!=null&&c(t,["setup","generationConfig","responseModalities"],i);const o=a(e,["temperature"]);t!==void 0&&o!=null&&c(t,["setup","generationConfig","temperature"],o);const s=a(e,["topP"]);t!==void 0&&s!=null&&c(t,["setup","generationConfig","topP"],s);const l=a(e,["topK"]);t!==void 0&&l!=null&&c(t,["setup","generationConfig","topK"],l);const u=a(e,["maxOutputTokens"]);t!==void 0&&u!=null&&c(t,["setup","generationConfig","maxOutputTokens"],u);const f=a(e,["mediaResolution"]);t!==void 0&&f!=null&&c(t,["setup","generationConfig","mediaResolution"],f);const d=a(e,["seed"]);t!==void 0&&d!=null&&c(t,["setup","generationConfig","seed"],d);const h=a(e,["speechConfig"]);t!==void 0&&h!=null&&c(t,["setup","generationConfig","speechConfig"],Vc(h));const p=a(e,["thinkingConfig"]);t!==void 0&&p!=null&&c(t,["setup","generationConfig","thinkingConfig"],p);const m=a(e,["enableAffectiveDialog"]);t!==void 0&&m!=null&&c(t,["setup","generationConfig","enableAffectiveDialog"],m);const v=a(e,["systemInstruction"]);t!==void 0&&v!=null&&c(t,["setup","systemInstruction"],QN(At(v)));const g=a(e,["tools"]);if(t!==void 0&&g!=null){let M=ro(g);Array.isArray(M)&&(M=M.map(R=>m4(no(R)))),c(t,["setup","tools"],M)}const T=a(e,["sessionResumption"]);t!==void 0&&T!=null&&c(t,["setup","sessionResumption"],p4(T));const _=a(e,["inputAudioTranscription"]);t!==void 0&&_!=null&&c(t,["setup","inputAudioTranscription"],_);const x=a(e,["outputAudioTranscription"]);t!==void 0&&x!=null&&c(t,["setup","outputAudioTranscription"],x);const y=a(e,["realtimeInputConfig"]);t!==void 0&&y!=null&&c(t,["setup","realtimeInputConfig"],y);const C=a(e,["contextWindowCompression"]);t!==void 0&&C!=null&&c(t,["setup","contextWindowCompression"],C);const k=a(e,["proactivity"]);return t!==void 0&&k!=null&&c(t,["setup","proactivity"],k),n}function o4(e,t){const n={},r=a(e,["generationConfig"]);t!==void 0&&r!=null&&c(t,["setup","generationConfig"],t4(r));const i=a(e,["responseModalities"]);t!==void 0&&i!=null&&c(t,["setup","generationConfig","responseModalities"],i);const o=a(e,["temperature"]);t!==void 0&&o!=null&&c(t,["setup","generationConfig","temperature"],o);const s=a(e,["topP"]);t!==void 0&&s!=null&&c(t,["setup","generationConfig","topP"],s);const l=a(e,["topK"]);t!==void 0&&l!=null&&c(t,["setup","generationConfig","topK"],l);const u=a(e,["maxOutputTokens"]);t!==void 0&&u!=null&&c(t,["setup","generationConfig","maxOutputTokens"],u);const f=a(e,["mediaResolution"]);t!==void 0&&f!=null&&c(t,["setup","generationConfig","mediaResolution"],f);const d=a(e,["seed"]);t!==void 0&&d!=null&&c(t,["setup","generationConfig","seed"],d);const h=a(e,["speechConfig"]);t!==void 0&&h!=null&&c(t,["setup","generationConfig","speechConfig"],Iv(Vc(h)));const p=a(e,["thinkingConfig"]);t!==void 0&&p!=null&&c(t,["setup","generationConfig","thinkingConfig"],p);const m=a(e,["enableAffectiveDialog"]);t!==void 0&&m!=null&&c(t,["setup","generationConfig","enableAffectiveDialog"],m);const v=a(e,["systemInstruction"]);t!==void 0&&v!=null&&c(t,["setup","systemInstruction"],At(v));const g=a(e,["tools"]);if(t!==void 0&&g!=null){let M=ro(g);Array.isArray(M)&&(M=M.map(R=>g4(no(R)))),c(t,["setup","tools"],M)}const T=a(e,["sessionResumption"]);t!==void 0&&T!=null&&c(t,["setup","sessionResumption"],T);const _=a(e,["inputAudioTranscription"]);t!==void 0&&_!=null&&c(t,["setup","inputAudioTranscription"],_);const x=a(e,["outputAudioTranscription"]);t!==void 0&&x!=null&&c(t,["setup","outputAudioTranscription"],x);const y=a(e,["realtimeInputConfig"]);t!==void 0&&y!=null&&c(t,["setup","realtimeInputConfig"],y);const C=a(e,["contextWindowCompression"]);t!==void 0&&C!=null&&c(t,["setup","contextWindowCompression"],C);const k=a(e,["proactivity"]);return t!==void 0&&k!=null&&c(t,["setup","proactivity"],k),n}function s4(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["setup","model"],Ce(e,r));const i=a(t,["config"]);return i!=null&&c(n,["config"],i4(i,n)),n}function l4(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["setup","model"],Ce(e,r));const i=a(t,["config"]);return i!=null&&c(n,["config"],o4(i,n)),n}function a4(e){const t={},n=a(e,["musicGenerationConfig"]);return n!=null&&c(t,["musicGenerationConfig"],n),t}function u4(e){const t={},n=a(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),c(t,["weightedPrompts"],r)}return t}function f4(e){const t={},n=a(e,["media"]);if(n!=null){let f=pv(n);Array.isArray(f)&&(f=f.map(d=>ll(d))),c(t,["mediaChunks"],f)}const r=a(e,["audio"]);r!=null&&c(t,["audio"],ll(gv(r)));const i=a(e,["audioStreamEnd"]);i!=null&&c(t,["audioStreamEnd"],i);const o=a(e,["video"]);o!=null&&c(t,["video"],ll(mv(o)));const s=a(e,["text"]);s!=null&&c(t,["text"],s);const l=a(e,["activityStart"]);l!=null&&c(t,["activityStart"],l);const u=a(e,["activityEnd"]);return u!=null&&c(t,["activityEnd"],u),t}function c4(e){const t={},n=a(e,["media"]);if(n!=null){let f=pv(n);Array.isArray(f)&&(f=f.map(d=>d)),c(t,["mediaChunks"],f)}const r=a(e,["audio"]);r!=null&&c(t,["audio"],gv(r));const i=a(e,["audioStreamEnd"]);i!=null&&c(t,["audioStreamEnd"],i);const o=a(e,["video"]);o!=null&&c(t,["video"],mv(o));const s=a(e,["text"]);s!=null&&c(t,["text"],s);const l=a(e,["activityStart"]);l!=null&&c(t,["activityStart"],l);const u=a(e,["activityEnd"]);return u!=null&&c(t,["activityEnd"],u),t}function d4(e){const t={},n=a(e,["setupComplete"]);n!=null&&c(t,["setupComplete"],n);const r=a(e,["serverContent"]);r!=null&&c(t,["serverContent"],r);const i=a(e,["toolCall"]);i!=null&&c(t,["toolCall"],i);const o=a(e,["toolCallCancellation"]);o!=null&&c(t,["toolCallCancellation"],o);const s=a(e,["usageMetadata"]);s!=null&&c(t,["usageMetadata"],v4(s));const l=a(e,["goAway"]);l!=null&&c(t,["goAway"],l);const u=a(e,["sessionResumptionUpdate"]);return u!=null&&c(t,["sessionResumptionUpdate"],u),t}function h4(e){const t={},n=a(e,["mediaResolution"]);n!=null&&c(t,["mediaResolution"],n);const r=a(e,["codeExecutionResult"]);r!=null&&c(t,["codeExecutionResult"],r);const i=a(e,["executableCode"]);i!=null&&c(t,["executableCode"],i);const o=a(e,["fileData"]);o!=null&&c(t,["fileData"],ZN(o));const s=a(e,["functionCall"]);s!=null&&c(t,["functionCall"],jN(s));const l=a(e,["functionResponse"]);l!=null&&c(t,["functionResponse"],l);const u=a(e,["inlineData"]);u!=null&&c(t,["inlineData"],ll(u));const f=a(e,["text"]);f!=null&&c(t,["text"],f);const d=a(e,["thought"]);d!=null&&c(t,["thought"],d);const h=a(e,["thoughtSignature"]);h!=null&&c(t,["thoughtSignature"],h);const p=a(e,["videoMetadata"]);return p!=null&&c(t,["videoMetadata"],p),t}function p4(e){const t={},n=a(e,["handle"]);if(n!=null&&c(t,["handle"],n),a(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function Iv(e){const t={},n=a(e,["languageCode"]);n!=null&&c(t,["languageCode"],n);const r=a(e,["voiceConfig"]);if(r!=null&&c(t,["voiceConfig"],r),a(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return t}function m4(e){const t={},n=a(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>h)),c(t,["functionDeclarations"],d)}if(a(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=a(e,["googleSearchRetrieval"]);r!=null&&c(t,["googleSearchRetrieval"],r);const i=a(e,["computerUse"]);i!=null&&c(t,["computerUse"],i);const o=a(e,["fileSearch"]);o!=null&&c(t,["fileSearch"],o);const s=a(e,["codeExecution"]);if(s!=null&&c(t,["codeExecution"],s),a(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=a(e,["googleMaps"]);l!=null&&c(t,["googleMaps"],n4(l));const u=a(e,["googleSearch"]);u!=null&&c(t,["googleSearch"],r4(u));const f=a(e,["urlContext"]);return f!=null&&c(t,["urlContext"],f),t}function g4(e){const t={},n=a(e,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>e4(p))),c(t,["functionDeclarations"],h)}const r=a(e,["retrieval"]);r!=null&&c(t,["retrieval"],r);const i=a(e,["googleSearchRetrieval"]);i!=null&&c(t,["googleSearchRetrieval"],i);const o=a(e,["computerUse"]);if(o!=null&&c(t,["computerUse"],o),a(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=a(e,["codeExecution"]);s!=null&&c(t,["codeExecution"],s);const l=a(e,["enterpriseWebSearch"]);l!=null&&c(t,["enterpriseWebSearch"],l);const u=a(e,["googleMaps"]);u!=null&&c(t,["googleMaps"],u);const f=a(e,["googleSearch"]);f!=null&&c(t,["googleSearch"],f);const d=a(e,["urlContext"]);return d!=null&&c(t,["urlContext"],d),t}function v4(e){const t={},n=a(e,["promptTokenCount"]);n!=null&&c(t,["promptTokenCount"],n);const r=a(e,["cachedContentTokenCount"]);r!=null&&c(t,["cachedContentTokenCount"],r);const i=a(e,["candidatesTokenCount"]);i!=null&&c(t,["responseTokenCount"],i);const o=a(e,["toolUsePromptTokenCount"]);o!=null&&c(t,["toolUsePromptTokenCount"],o);const s=a(e,["thoughtsTokenCount"]);s!=null&&c(t,["thoughtsTokenCount"],s);const l=a(e,["totalTokenCount"]);l!=null&&c(t,["totalTokenCount"],l);const u=a(e,["promptTokensDetails"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(v=>v)),c(t,["promptTokensDetails"],m)}const f=a(e,["cacheTokensDetails"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(v=>v)),c(t,["cacheTokensDetails"],m)}const d=a(e,["candidatesTokensDetails"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(v=>v)),c(t,["responseTokensDetails"],m)}const h=a(e,["toolUsePromptTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(v=>v)),c(t,["toolUsePromptTokensDetails"],m)}const p=a(e,["trafficType"]);return p!=null&&c(t,["trafficType"],p),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function x4(e){const t={},n=a(e,["data"]);if(n!=null&&c(t,["data"],n),a(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=a(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function _4(e){const t={},n=a(e,["content"]);n!=null&&c(t,["content"],n);const r=a(e,["citationMetadata"]);r!=null&&c(t,["citationMetadata"],y4(r));const i=a(e,["tokenCount"]);i!=null&&c(t,["tokenCount"],i);const o=a(e,["finishReason"]);o!=null&&c(t,["finishReason"],o);const s=a(e,["avgLogprobs"]);s!=null&&c(t,["avgLogprobs"],s);const l=a(e,["groundingMetadata"]);l!=null&&c(t,["groundingMetadata"],l);const u=a(e,["index"]);u!=null&&c(t,["index"],u);const f=a(e,["logprobsResult"]);f!=null&&c(t,["logprobsResult"],f);const d=a(e,["safetyRatings"]);if(d!=null){let p=d;Array.isArray(p)&&(p=p.map(m=>m)),c(t,["safetyRatings"],p)}const h=a(e,["urlContextMetadata"]);return h!=null&&c(t,["urlContextMetadata"],h),t}function y4(e){const t={},n=a(e,["citationSources"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>i)),c(t,["citations"],r)}return t}function T4(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["_url","model"],Ce(e,r));const i=a(t,["contents"]);if(i!=null){let o=dn(i);Array.isArray(o)&&(o=o.map(s=>s)),c(n,["contents"],o)}return n}function E4(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["tokensInfo"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>o)),c(t,["tokensInfo"],i)}return t}function S4(e){const t={},n=a(e,["values"]);n!=null&&c(t,["values"],n);const r=a(e,["statistics"]);return r!=null&&c(t,["statistics"],w4(r)),t}function w4(e){const t={},n=a(e,["truncated"]);n!=null&&c(t,["truncated"],n);const r=a(e,["token_count"]);return r!=null&&c(t,["tokenCount"],r),t}function Ea(e){const t={},n=a(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>MP(o))),c(t,["parts"],i)}const r=a(e,["role"]);return r!=null&&c(t,["role"],r),t}function C4(e){const t={},n=a(e,["controlType"]);n!=null&&c(t,["controlType"],n);const r=a(e,["enableControlImageComputation"]);return r!=null&&c(t,["computeControl"],r),t}function A4(e){const t={};if(a(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(a(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(a(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function I4(e,t){const n={},r=a(e,["systemInstruction"]);t!==void 0&&r!=null&&c(t,["systemInstruction"],At(r));const i=a(e,["tools"]);if(t!==void 0&&i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>kv(l))),c(t,["tools"],s)}const o=a(e,["generationConfig"]);return t!==void 0&&o!=null&&c(t,["generationConfig"],xP(o)),n}function R4(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["_url","model"],Ce(e,r));const i=a(t,["contents"]);if(i!=null){let s=dn(i);Array.isArray(s)&&(s=s.map(l=>Ea(l))),c(n,["contents"],s)}const o=a(t,["config"]);return o!=null&&A4(o),n}function N4(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["_url","model"],Ce(e,r));const i=a(t,["contents"]);if(i!=null){let s=dn(i);Array.isArray(s)&&(s=s.map(l=>l)),c(n,["contents"],s)}const o=a(t,["config"]);return o!=null&&I4(o,n),n}function P4(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["totalTokens"]);r!=null&&c(t,["totalTokens"],r);const i=a(e,["cachedContentTokenCount"]);return i!=null&&c(t,["cachedContentTokenCount"],i),t}function F4(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["totalTokens"]);return r!=null&&c(t,["totalTokens"],r),t}function k4(e,t){const n={},r=a(t,["model"]);return r!=null&&c(n,["_url","name"],Ce(e,r)),n}function M4(e,t){const n={},r=a(t,["model"]);return r!=null&&c(n,["_url","name"],Ce(e,r)),n}function D4(e){const t={},n=a(e,["sdkHttpResponse"]);return n!=null&&c(t,["sdkHttpResponse"],n),t}function L4(e){const t={},n=a(e,["sdkHttpResponse"]);return n!=null&&c(t,["sdkHttpResponse"],n),t}function O4(e,t){const n={},r=a(e,["outputGcsUri"]);t!==void 0&&r!=null&&c(t,["parameters","storageUri"],r);const i=a(e,["negativePrompt"]);t!==void 0&&i!=null&&c(t,["parameters","negativePrompt"],i);const o=a(e,["numberOfImages"]);t!==void 0&&o!=null&&c(t,["parameters","sampleCount"],o);const s=a(e,["aspectRatio"]);t!==void 0&&s!=null&&c(t,["parameters","aspectRatio"],s);const l=a(e,["guidanceScale"]);t!==void 0&&l!=null&&c(t,["parameters","guidanceScale"],l);const u=a(e,["seed"]);t!==void 0&&u!=null&&c(t,["parameters","seed"],u);const f=a(e,["safetyFilterLevel"]);t!==void 0&&f!=null&&c(t,["parameters","safetySetting"],f);const d=a(e,["personGeneration"]);t!==void 0&&d!=null&&c(t,["parameters","personGeneration"],d);const h=a(e,["includeSafetyAttributes"]);t!==void 0&&h!=null&&c(t,["parameters","includeSafetyAttributes"],h);const p=a(e,["includeRaiReason"]);t!==void 0&&p!=null&&c(t,["parameters","includeRaiReason"],p);const m=a(e,["language"]);t!==void 0&&m!=null&&c(t,["parameters","language"],m);const v=a(e,["outputMimeType"]);t!==void 0&&v!=null&&c(t,["parameters","outputOptions","mimeType"],v);const g=a(e,["outputCompressionQuality"]);t!==void 0&&g!=null&&c(t,["parameters","outputOptions","compressionQuality"],g);const T=a(e,["addWatermark"]);t!==void 0&&T!=null&&c(t,["parameters","addWatermark"],T);const _=a(e,["labels"]);t!==void 0&&_!=null&&c(t,["labels"],_);const x=a(e,["editMode"]);t!==void 0&&x!=null&&c(t,["parameters","editMode"],x);const y=a(e,["baseSteps"]);return t!==void 0&&y!=null&&c(t,["parameters","editConfig","baseSteps"],y),n}function U4(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["_url","model"],Ce(e,r));const i=a(t,["prompt"]);i!=null&&c(n,["instances[0]","prompt"],i);const o=a(t,["referenceImages"]);if(o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>VP(u))),c(n,["instances[0]","referenceImages"],l)}const s=a(t,["config"]);return s!=null&&O4(s,n),n}function B4(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Sa(o))),c(t,["generatedImages"],i)}return t}function V4(e,t){const n={},r=a(e,["taskType"]);t!==void 0&&r!=null&&c(t,["requests[]","taskType"],r);const i=a(e,["title"]);t!==void 0&&i!=null&&c(t,["requests[]","title"],i);const o=a(e,["outputDimensionality"]);if(t!==void 0&&o!=null&&c(t,["requests[]","outputDimensionality"],o),a(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(a(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function G4(e,t){const n={},r=a(e,["taskType"]);t!==void 0&&r!=null&&c(t,["instances[]","task_type"],r);const i=a(e,["title"]);t!==void 0&&i!=null&&c(t,["instances[]","title"],i);const o=a(e,["outputDimensionality"]);t!==void 0&&o!=null&&c(t,["parameters","outputDimensionality"],o);const s=a(e,["mimeType"]);t!==void 0&&s!=null&&c(t,["instances[]","mimeType"],s);const l=a(e,["autoTruncate"]);return t!==void 0&&l!=null&&c(t,["parameters","autoTruncate"],l),n}function H4(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["_url","model"],Ce(e,r));const i=a(t,["contents"]);if(i!=null){let l=Oc(e,i);Array.isArray(l)&&(l=l.map(u=>u)),c(n,["requests[]","content"],l)}const o=a(t,["config"]);o!=null&&V4(o,n);const s=a(t,["model"]);return s!==void 0&&c(n,["requests[]","model"],Ce(e,s)),n}function W4(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["_url","model"],Ce(e,r));const i=a(t,["contents"]);if(i!=null){let s=Oc(e,i);Array.isArray(s)&&(s=s.map(l=>l)),c(n,["instances[]","content"],s)}const o=a(t,["config"]);return o!=null&&G4(o,n),n}function z4(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>s)),c(t,["embeddings"],o)}const i=a(e,["metadata"]);return i!=null&&c(t,["metadata"],i),t}function q4(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["predictions[]","embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>S4(s))),c(t,["embeddings"],o)}const i=a(e,["metadata"]);return i!=null&&c(t,["metadata"],i),t}function $4(e){const t={},n=a(e,["endpoint"]);n!=null&&c(t,["name"],n);const r=a(e,["deployedModelId"]);return r!=null&&c(t,["deployedModelId"],r),t}function J4(e){const t={};if(a(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=a(e,["fileUri"]);n!=null&&c(t,["fileUri"],n);const r=a(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function Y4(e){const t={},n=a(e,["id"]);n!=null&&c(t,["id"],n);const r=a(e,["args"]);r!=null&&c(t,["args"],r);const i=a(e,["name"]);if(i!=null&&c(t,["name"],i),a(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(a(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function K4(e){const t={},n=a(e,["mode"]);n!=null&&c(t,["mode"],n);const r=a(e,["allowedFunctionNames"]);if(r!=null&&c(t,["allowedFunctionNames"],r),a(e,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function X4(e){const t={};if(a(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=a(e,["description"]);n!=null&&c(t,["description"],n);const r=a(e,["name"]);r!=null&&c(t,["name"],r);const i=a(e,["parameters"]);i!=null&&c(t,["parameters"],i);const o=a(e,["parametersJsonSchema"]);o!=null&&c(t,["parametersJsonSchema"],o);const s=a(e,["response"]);s!=null&&c(t,["response"],s);const l=a(e,["responseJsonSchema"]);return l!=null&&c(t,["responseJsonSchema"],l),t}function b4(e,t,n){const r={},i=a(t,["systemInstruction"]);n!==void 0&&i!=null&&c(n,["systemInstruction"],Ea(At(i)));const o=a(t,["temperature"]);o!=null&&c(r,["temperature"],o);const s=a(t,["topP"]);s!=null&&c(r,["topP"],s);const l=a(t,["topK"]);l!=null&&c(r,["topK"],l);const u=a(t,["candidateCount"]);u!=null&&c(r,["candidateCount"],u);const f=a(t,["maxOutputTokens"]);f!=null&&c(r,["maxOutputTokens"],f);const d=a(t,["stopSequences"]);d!=null&&c(r,["stopSequences"],d);const h=a(t,["responseLogprobs"]);h!=null&&c(r,["responseLogprobs"],h);const p=a(t,["logprobs"]);p!=null&&c(r,["logprobs"],p);const m=a(t,["presencePenalty"]);m!=null&&c(r,["presencePenalty"],m);const v=a(t,["frequencyPenalty"]);v!=null&&c(r,["frequencyPenalty"],v);const g=a(t,["seed"]);g!=null&&c(r,["seed"],g);const T=a(t,["responseMimeType"]);T!=null&&c(r,["responseMimeType"],T);const _=a(t,["responseSchema"]);_!=null&&c(r,["responseSchema"],Uc(_));const x=a(t,["responseJsonSchema"]);if(x!=null&&c(r,["responseJsonSchema"],x),a(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(a(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const y=a(t,["safetySettings"]);if(n!==void 0&&y!=null){let K=y;Array.isArray(K)&&(K=K.map(ee=>GP(ee))),c(n,["safetySettings"],K)}const C=a(t,["tools"]);if(n!==void 0&&C!=null){let K=ro(C);Array.isArray(K)&&(K=K.map(ee=>YP(no(ee)))),c(n,["tools"],K)}const k=a(t,["toolConfig"]);if(n!==void 0&&k!=null&&c(n,["toolConfig"],JP(k)),a(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const M=a(t,["cachedContent"]);n!==void 0&&M!=null&&c(n,["cachedContent"],or(e,M));const R=a(t,["responseModalities"]);R!=null&&c(r,["responseModalities"],R);const D=a(t,["mediaResolution"]);D!=null&&c(r,["mediaResolution"],D);const F=a(t,["speechConfig"]);if(F!=null&&c(r,["speechConfig"],Bc(F)),a(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const U=a(t,["thinkingConfig"]);U!=null&&c(r,["thinkingConfig"],U);const q=a(t,["imageConfig"]);return q!=null&&c(r,["imageConfig"],SP(q)),r}function Q4(e,t,n){const r={},i=a(t,["systemInstruction"]);n!==void 0&&i!=null&&c(n,["systemInstruction"],At(i));const o=a(t,["temperature"]);o!=null&&c(r,["temperature"],o);const s=a(t,["topP"]);s!=null&&c(r,["topP"],s);const l=a(t,["topK"]);l!=null&&c(r,["topK"],l);const u=a(t,["candidateCount"]);u!=null&&c(r,["candidateCount"],u);const f=a(t,["maxOutputTokens"]);f!=null&&c(r,["maxOutputTokens"],f);const d=a(t,["stopSequences"]);d!=null&&c(r,["stopSequences"],d);const h=a(t,["responseLogprobs"]);h!=null&&c(r,["responseLogprobs"],h);const p=a(t,["logprobs"]);p!=null&&c(r,["logprobs"],p);const m=a(t,["presencePenalty"]);m!=null&&c(r,["presencePenalty"],m);const v=a(t,["frequencyPenalty"]);v!=null&&c(r,["frequencyPenalty"],v);const g=a(t,["seed"]);g!=null&&c(r,["seed"],g);const T=a(t,["responseMimeType"]);T!=null&&c(r,["responseMimeType"],T);const _=a(t,["responseSchema"]);_!=null&&c(r,["responseSchema"],Uc(_));const x=a(t,["responseJsonSchema"]);x!=null&&c(r,["responseJsonSchema"],x);const y=a(t,["routingConfig"]);y!=null&&c(r,["routingConfig"],y);const C=a(t,["modelSelectionConfig"]);C!=null&&c(r,["modelConfig"],C);const k=a(t,["safetySettings"]);if(n!==void 0&&k!=null){let Ae=k;Array.isArray(Ae)&&(Ae=Ae.map(Ne=>Ne)),c(n,["safetySettings"],Ae)}const M=a(t,["tools"]);if(n!==void 0&&M!=null){let Ae=ro(M);Array.isArray(Ae)&&(Ae=Ae.map(Ne=>kv(no(Ne)))),c(n,["tools"],Ae)}const R=a(t,["toolConfig"]);n!==void 0&&R!=null&&c(n,["toolConfig"],R);const D=a(t,["labels"]);n!==void 0&&D!=null&&c(n,["labels"],D);const F=a(t,["cachedContent"]);n!==void 0&&F!=null&&c(n,["cachedContent"],or(e,F));const U=a(t,["responseModalities"]);U!=null&&c(r,["responseModalities"],U);const q=a(t,["mediaResolution"]);q!=null&&c(r,["mediaResolution"],q);const K=a(t,["speechConfig"]);K!=null&&c(r,["speechConfig"],Fv(Bc(K)));const ee=a(t,["audioTimestamp"]);ee!=null&&c(r,["audioTimestamp"],ee);const Te=a(t,["thinkingConfig"]);Te!=null&&c(r,["thinkingConfig"],Te);const ge=a(t,["imageConfig"]);return ge!=null&&c(r,["imageConfig"],wP(ge)),r}function lp(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["_url","model"],Ce(e,r));const i=a(t,["contents"]);if(i!=null){let s=dn(i);Array.isArray(s)&&(s=s.map(l=>Ea(l))),c(n,["contents"],s)}const o=a(t,["config"]);return o!=null&&c(n,["generationConfig"],b4(e,o,n)),n}function ap(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["_url","model"],Ce(e,r));const i=a(t,["contents"]);if(i!=null){let s=dn(i);Array.isArray(s)&&(s=s.map(l=>l)),c(n,["contents"],s)}const o=a(t,["config"]);return o!=null&&c(n,["generationConfig"],Q4(e,o,n)),n}function up(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(f=>_4(f))),c(t,["candidates"],u)}const i=a(e,["modelVersion"]);i!=null&&c(t,["modelVersion"],i);const o=a(e,["promptFeedback"]);o!=null&&c(t,["promptFeedback"],o);const s=a(e,["responseId"]);s!=null&&c(t,["responseId"],s);const l=a(e,["usageMetadata"]);return l!=null&&c(t,["usageMetadata"],l),t}function fp(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["candidates"]);if(r!=null){let f=r;Array.isArray(f)&&(f=f.map(d=>d)),c(t,["candidates"],f)}const i=a(e,["createTime"]);i!=null&&c(t,["createTime"],i);const o=a(e,["modelVersion"]);o!=null&&c(t,["modelVersion"],o);const s=a(e,["promptFeedback"]);s!=null&&c(t,["promptFeedback"],s);const l=a(e,["responseId"]);l!=null&&c(t,["responseId"],l);const u=a(e,["usageMetadata"]);return u!=null&&c(t,["usageMetadata"],u),t}function Z4(e,t){const n={};if(a(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(a(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=a(e,["numberOfImages"]);t!==void 0&&r!=null&&c(t,["parameters","sampleCount"],r);const i=a(e,["aspectRatio"]);t!==void 0&&i!=null&&c(t,["parameters","aspectRatio"],i);const o=a(e,["guidanceScale"]);if(t!==void 0&&o!=null&&c(t,["parameters","guidanceScale"],o),a(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=a(e,["safetyFilterLevel"]);t!==void 0&&s!=null&&c(t,["parameters","safetySetting"],s);const l=a(e,["personGeneration"]);t!==void 0&&l!=null&&c(t,["parameters","personGeneration"],l);const u=a(e,["includeSafetyAttributes"]);t!==void 0&&u!=null&&c(t,["parameters","includeSafetyAttributes"],u);const f=a(e,["includeRaiReason"]);t!==void 0&&f!=null&&c(t,["parameters","includeRaiReason"],f);const d=a(e,["language"]);t!==void 0&&d!=null&&c(t,["parameters","language"],d);const h=a(e,["outputMimeType"]);t!==void 0&&h!=null&&c(t,["parameters","outputOptions","mimeType"],h);const p=a(e,["outputCompressionQuality"]);if(t!==void 0&&p!=null&&c(t,["parameters","outputOptions","compressionQuality"],p),a(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(a(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const m=a(e,["imageSize"]);if(t!==void 0&&m!=null&&c(t,["parameters","sampleImageSize"],m),a(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function j4(e,t){const n={},r=a(e,["outputGcsUri"]);t!==void 0&&r!=null&&c(t,["parameters","storageUri"],r);const i=a(e,["negativePrompt"]);t!==void 0&&i!=null&&c(t,["parameters","negativePrompt"],i);const o=a(e,["numberOfImages"]);t!==void 0&&o!=null&&c(t,["parameters","sampleCount"],o);const s=a(e,["aspectRatio"]);t!==void 0&&s!=null&&c(t,["parameters","aspectRatio"],s);const l=a(e,["guidanceScale"]);t!==void 0&&l!=null&&c(t,["parameters","guidanceScale"],l);const u=a(e,["seed"]);t!==void 0&&u!=null&&c(t,["parameters","seed"],u);const f=a(e,["safetyFilterLevel"]);t!==void 0&&f!=null&&c(t,["parameters","safetySetting"],f);const d=a(e,["personGeneration"]);t!==void 0&&d!=null&&c(t,["parameters","personGeneration"],d);const h=a(e,["includeSafetyAttributes"]);t!==void 0&&h!=null&&c(t,["parameters","includeSafetyAttributes"],h);const p=a(e,["includeRaiReason"]);t!==void 0&&p!=null&&c(t,["parameters","includeRaiReason"],p);const m=a(e,["language"]);t!==void 0&&m!=null&&c(t,["parameters","language"],m);const v=a(e,["outputMimeType"]);t!==void 0&&v!=null&&c(t,["parameters","outputOptions","mimeType"],v);const g=a(e,["outputCompressionQuality"]);t!==void 0&&g!=null&&c(t,["parameters","outputOptions","compressionQuality"],g);const T=a(e,["addWatermark"]);t!==void 0&&T!=null&&c(t,["parameters","addWatermark"],T);const _=a(e,["labels"]);t!==void 0&&_!=null&&c(t,["labels"],_);const x=a(e,["imageSize"]);t!==void 0&&x!=null&&c(t,["parameters","sampleImageSize"],x);const y=a(e,["enhancePrompt"]);return t!==void 0&&y!=null&&c(t,["parameters","enhancePrompt"],y),n}function eP(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["_url","model"],Ce(e,r));const i=a(t,["prompt"]);i!=null&&c(n,["instances[0]","prompt"],i);const o=a(t,["config"]);return o!=null&&Z4(o,n),n}function tP(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["_url","model"],Ce(e,r));const i=a(t,["prompt"]);i!=null&&c(n,["instances[0]","prompt"],i);const o=a(t,["config"]);return o!=null&&j4(o,n),n}function nP(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>pP(s))),c(t,["generatedImages"],o)}const i=a(e,["positivePromptSafetyAttributes"]);return i!=null&&c(t,["positivePromptSafetyAttributes"],Nv(i)),t}function rP(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>Sa(s))),c(t,["generatedImages"],o)}const i=a(e,["positivePromptSafetyAttributes"]);return i!=null&&c(t,["positivePromptSafetyAttributes"],Pv(i)),t}function iP(e,t){const n={},r=a(e,["numberOfVideos"]);if(t!==void 0&&r!=null&&c(t,["parameters","sampleCount"],r),a(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(a(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=a(e,["durationSeconds"]);if(t!==void 0&&i!=null&&c(t,["parameters","durationSeconds"],i),a(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=a(e,["aspectRatio"]);t!==void 0&&o!=null&&c(t,["parameters","aspectRatio"],o);const s=a(e,["resolution"]);t!==void 0&&s!=null&&c(t,["parameters","resolution"],s);const l=a(e,["personGeneration"]);if(t!==void 0&&l!=null&&c(t,["parameters","personGeneration"],l),a(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const u=a(e,["negativePrompt"]);t!==void 0&&u!=null&&c(t,["parameters","negativePrompt"],u);const f=a(e,["enhancePrompt"]);if(t!==void 0&&f!=null&&c(t,["parameters","enhancePrompt"],f),a(e,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const d=a(e,["lastFrame"]);t!==void 0&&d!=null&&c(t,["instances[0]","lastFrame"],wa(d));const h=a(e,["referenceImages"]);if(t!==void 0&&h!=null){let p=h;Array.isArray(p)&&(p=p.map(m=>sF(m))),c(t,["instances[0]","referenceImages"],p)}if(a(e,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(a(e,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function oP(e,t){const n={},r=a(e,["numberOfVideos"]);t!==void 0&&r!=null&&c(t,["parameters","sampleCount"],r);const i=a(e,["outputGcsUri"]);t!==void 0&&i!=null&&c(t,["parameters","storageUri"],i);const o=a(e,["fps"]);t!==void 0&&o!=null&&c(t,["parameters","fps"],o);const s=a(e,["durationSeconds"]);t!==void 0&&s!=null&&c(t,["parameters","durationSeconds"],s);const l=a(e,["seed"]);t!==void 0&&l!=null&&c(t,["parameters","seed"],l);const u=a(e,["aspectRatio"]);t!==void 0&&u!=null&&c(t,["parameters","aspectRatio"],u);const f=a(e,["resolution"]);t!==void 0&&f!=null&&c(t,["parameters","resolution"],f);const d=a(e,["personGeneration"]);t!==void 0&&d!=null&&c(t,["parameters","personGeneration"],d);const h=a(e,["pubsubTopic"]);t!==void 0&&h!=null&&c(t,["parameters","pubsubTopic"],h);const p=a(e,["negativePrompt"]);t!==void 0&&p!=null&&c(t,["parameters","negativePrompt"],p);const m=a(e,["enhancePrompt"]);t!==void 0&&m!=null&&c(t,["parameters","enhancePrompt"],m);const v=a(e,["generateAudio"]);t!==void 0&&v!=null&&c(t,["parameters","generateAudio"],v);const g=a(e,["lastFrame"]);t!==void 0&&g!=null&&c(t,["instances[0]","lastFrame"],Rn(g));const T=a(e,["referenceImages"]);if(t!==void 0&&T!=null){let y=T;Array.isArray(y)&&(y=y.map(C=>lF(C))),c(t,["instances[0]","referenceImages"],y)}const _=a(e,["mask"]);t!==void 0&&_!=null&&c(t,["instances[0]","mask"],oF(_));const x=a(e,["compressionQuality"]);return t!==void 0&&x!=null&&c(t,["parameters","compressionQuality"],x),n}function sP(e){const t={},n=a(e,["name"]);n!=null&&c(t,["name"],n);const r=a(e,["metadata"]);r!=null&&c(t,["metadata"],r);const i=a(e,["done"]);i!=null&&c(t,["done"],i);const o=a(e,["error"]);o!=null&&c(t,["error"],o);const s=a(e,["response","generateVideoResponse"]);return s!=null&&c(t,["response"],fP(s)),t}function lP(e){const t={},n=a(e,["name"]);n!=null&&c(t,["name"],n);const r=a(e,["metadata"]);r!=null&&c(t,["metadata"],r);const i=a(e,["done"]);i!=null&&c(t,["done"],i);const o=a(e,["error"]);o!=null&&c(t,["error"],o);const s=a(e,["response"]);return s!=null&&c(t,["response"],cP(s)),t}function aP(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["_url","model"],Ce(e,r));const i=a(t,["prompt"]);i!=null&&c(n,["instances[0]","prompt"],i);const o=a(t,["image"]);o!=null&&c(n,["instances[0]","image"],wa(o));const s=a(t,["video"]);s!=null&&c(n,["instances[0]","video"],Mv(s));const l=a(t,["source"]);l!=null&&dP(l,n);const u=a(t,["config"]);return u!=null&&iP(u,n),n}function uP(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["_url","model"],Ce(e,r));const i=a(t,["prompt"]);i!=null&&c(n,["instances[0]","prompt"],i);const o=a(t,["image"]);o!=null&&c(n,["instances[0]","image"],Rn(o));const s=a(t,["video"]);s!=null&&c(n,["instances[0]","video"],Dv(s));const l=a(t,["source"]);l!=null&&hP(l,n);const u=a(t,["config"]);return u!=null&&oP(u,n),n}function fP(e){const t={},n=a(e,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>gP(s))),c(t,["generatedVideos"],o)}const r=a(e,["raiMediaFilteredCount"]);r!=null&&c(t,["raiMediaFilteredCount"],r);const i=a(e,["raiMediaFilteredReasons"]);return i!=null&&c(t,["raiMediaFilteredReasons"],i),t}function cP(e){const t={},n=a(e,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>vP(s))),c(t,["generatedVideos"],o)}const r=a(e,["raiMediaFilteredCount"]);r!=null&&c(t,["raiMediaFilteredCount"],r);const i=a(e,["raiMediaFilteredReasons"]);return i!=null&&c(t,["raiMediaFilteredReasons"],i),t}function dP(e,t){const n={},r=a(e,["prompt"]);t!==void 0&&r!=null&&c(t,["instances[0]","prompt"],r);const i=a(e,["image"]);t!==void 0&&i!=null&&c(t,["instances[0]","image"],wa(i));const o=a(e,["video"]);return t!==void 0&&o!=null&&c(t,["instances[0]","video"],Mv(o)),n}function hP(e,t){const n={},r=a(e,["prompt"]);t!==void 0&&r!=null&&c(t,["instances[0]","prompt"],r);const i=a(e,["image"]);t!==void 0&&i!=null&&c(t,["instances[0]","image"],Rn(i));const o=a(e,["video"]);return t!==void 0&&o!=null&&c(t,["instances[0]","video"],Dv(o)),n}function pP(e){const t={},n=a(e,["_self"]);n!=null&&c(t,["image"],CP(n));const r=a(e,["raiFilteredReason"]);r!=null&&c(t,["raiFilteredReason"],r);const i=a(e,["_self"]);return i!=null&&c(t,["safetyAttributes"],Nv(i)),t}function Sa(e){const t={},n=a(e,["_self"]);n!=null&&c(t,["image"],Rv(n));const r=a(e,["raiFilteredReason"]);r!=null&&c(t,["raiFilteredReason"],r);const i=a(e,["_self"]);i!=null&&c(t,["safetyAttributes"],Pv(i));const o=a(e,["prompt"]);return o!=null&&c(t,["enhancedPrompt"],o),t}function mP(e){const t={},n=a(e,["_self"]);n!=null&&c(t,["mask"],Rv(n));const r=a(e,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>o)),c(t,["labels"],i)}return t}function gP(e){const t={},n=a(e,["video"]);return n!=null&&c(t,["video"],rF(n)),t}function vP(e){const t={},n=a(e,["_self"]);return n!=null&&c(t,["video"],iF(n)),t}function xP(e){const t={},n=a(e,["modelSelectionConfig"]);n!=null&&c(t,["modelConfig"],n);const r=a(e,["responseJsonSchema"]);r!=null&&c(t,["responseJsonSchema"],r);const i=a(e,["audioTimestamp"]);i!=null&&c(t,["audioTimestamp"],i);const o=a(e,["candidateCount"]);o!=null&&c(t,["candidateCount"],o);const s=a(e,["enableAffectiveDialog"]);s!=null&&c(t,["enableAffectiveDialog"],s);const l=a(e,["frequencyPenalty"]);l!=null&&c(t,["frequencyPenalty"],l);const u=a(e,["logprobs"]);u!=null&&c(t,["logprobs"],u);const f=a(e,["maxOutputTokens"]);f!=null&&c(t,["maxOutputTokens"],f);const d=a(e,["mediaResolution"]);d!=null&&c(t,["mediaResolution"],d);const h=a(e,["presencePenalty"]);h!=null&&c(t,["presencePenalty"],h);const p=a(e,["responseLogprobs"]);p!=null&&c(t,["responseLogprobs"],p);const m=a(e,["responseMimeType"]);m!=null&&c(t,["responseMimeType"],m);const v=a(e,["responseModalities"]);v!=null&&c(t,["responseModalities"],v);const g=a(e,["responseSchema"]);g!=null&&c(t,["responseSchema"],g);const T=a(e,["routingConfig"]);T!=null&&c(t,["routingConfig"],T);const _=a(e,["seed"]);_!=null&&c(t,["seed"],_);const x=a(e,["speechConfig"]);x!=null&&c(t,["speechConfig"],Fv(x));const y=a(e,["stopSequences"]);y!=null&&c(t,["stopSequences"],y);const C=a(e,["temperature"]);C!=null&&c(t,["temperature"],C);const k=a(e,["thinkingConfig"]);k!=null&&c(t,["thinkingConfig"],k);const M=a(e,["topK"]);M!=null&&c(t,["topK"],M);const R=a(e,["topP"]);if(R!=null&&c(t,["topP"],R),a(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function _P(e,t){const n={},r=a(t,["model"]);return r!=null&&c(n,["_url","name"],Ce(e,r)),n}function yP(e,t){const n={},r=a(t,["model"]);return r!=null&&c(n,["_url","name"],Ce(e,r)),n}function TP(e){const t={};if(a(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=a(e,["enableWidget"]);return n!=null&&c(t,["enableWidget"],n),t}function EP(e){const t={};if(a(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(a(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=a(e,["timeRangeFilter"]);return n!=null&&c(t,["timeRangeFilter"],n),t}function SP(e){const t={},n=a(e,["aspectRatio"]);n!=null&&c(t,["aspectRatio"],n);const r=a(e,["imageSize"]);if(r!=null&&c(t,["imageSize"],r),a(e,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(a(e,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function wP(e){const t={},n=a(e,["aspectRatio"]);n!=null&&c(t,["aspectRatio"],n);const r=a(e,["imageSize"]);r!=null&&c(t,["imageSize"],r);const i=a(e,["outputMimeType"]);i!=null&&c(t,["imageOutputOptions","mimeType"],i);const o=a(e,["outputCompressionQuality"]);return o!=null&&c(t,["imageOutputOptions","compressionQuality"],o),t}function CP(e){const t={},n=a(e,["bytesBase64Encoded"]);n!=null&&c(t,["imageBytes"],Mr(n));const r=a(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function Rv(e){const t={},n=a(e,["gcsUri"]);n!=null&&c(t,["gcsUri"],n);const r=a(e,["bytesBase64Encoded"]);r!=null&&c(t,["imageBytes"],Mr(r));const i=a(e,["mimeType"]);return i!=null&&c(t,["mimeType"],i),t}function wa(e){const t={};if(a(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=a(e,["imageBytes"]);n!=null&&c(t,["bytesBase64Encoded"],Mr(n));const r=a(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function Rn(e){const t={},n=a(e,["gcsUri"]);n!=null&&c(t,["gcsUri"],n);const r=a(e,["imageBytes"]);r!=null&&c(t,["bytesBase64Encoded"],Mr(r));const i=a(e,["mimeType"]);return i!=null&&c(t,["mimeType"],i),t}function AP(e,t,n){const r={},i=a(t,["pageSize"]);n!==void 0&&i!=null&&c(n,["_query","pageSize"],i);const o=a(t,["pageToken"]);n!==void 0&&o!=null&&c(n,["_query","pageToken"],o);const s=a(t,["filter"]);n!==void 0&&s!=null&&c(n,["_query","filter"],s);const l=a(t,["queryBase"]);return n!==void 0&&l!=null&&c(n,["_url","models_url"],yv(e,l)),r}function IP(e,t,n){const r={},i=a(t,["pageSize"]);n!==void 0&&i!=null&&c(n,["_query","pageSize"],i);const o=a(t,["pageToken"]);n!==void 0&&o!=null&&c(n,["_query","pageToken"],o);const s=a(t,["filter"]);n!==void 0&&s!=null&&c(n,["_query","filter"],s);const l=a(t,["queryBase"]);return n!==void 0&&l!=null&&c(n,["_url","models_url"],yv(e,l)),r}function RP(e,t){const n={},r=a(t,["config"]);return r!=null&&AP(e,r,n),n}function NP(e,t){const n={},r=a(t,["config"]);return r!=null&&IP(e,r,n),n}function PP(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=a(e,["_self"]);if(i!=null){let o=Tv(i);Array.isArray(o)&&(o=o.map(s=>pf(s))),c(t,["models"],o)}return t}function FP(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=a(e,["_self"]);if(i!=null){let o=Tv(i);Array.isArray(o)&&(o=o.map(s=>mf(s))),c(t,["models"],o)}return t}function kP(e){const t={},n=a(e,["maskMode"]);n!=null&&c(t,["maskMode"],n);const r=a(e,["segmentationClasses"]);r!=null&&c(t,["maskClasses"],r);const i=a(e,["maskDilation"]);return i!=null&&c(t,["dilation"],i),t}function pf(e){const t={},n=a(e,["name"]);n!=null&&c(t,["name"],n);const r=a(e,["displayName"]);r!=null&&c(t,["displayName"],r);const i=a(e,["description"]);i!=null&&c(t,["description"],i);const o=a(e,["version"]);o!=null&&c(t,["version"],o);const s=a(e,["_self"]);s!=null&&c(t,["tunedModelInfo"],KP(s));const l=a(e,["inputTokenLimit"]);l!=null&&c(t,["inputTokenLimit"],l);const u=a(e,["outputTokenLimit"]);u!=null&&c(t,["outputTokenLimit"],u);const f=a(e,["supportedGenerationMethods"]);f!=null&&c(t,["supportedActions"],f);const d=a(e,["temperature"]);d!=null&&c(t,["temperature"],d);const h=a(e,["maxTemperature"]);h!=null&&c(t,["maxTemperature"],h);const p=a(e,["topP"]);p!=null&&c(t,["topP"],p);const m=a(e,["topK"]);m!=null&&c(t,["topK"],m);const v=a(e,["thinking"]);return v!=null&&c(t,["thinking"],v),t}function mf(e){const t={},n=a(e,["name"]);n!=null&&c(t,["name"],n);const r=a(e,["displayName"]);r!=null&&c(t,["displayName"],r);const i=a(e,["description"]);i!=null&&c(t,["description"],i);const o=a(e,["versionId"]);o!=null&&c(t,["version"],o);const s=a(e,["deployedModels"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(p=>$4(p))),c(t,["endpoints"],h)}const l=a(e,["labels"]);l!=null&&c(t,["labels"],l);const u=a(e,["_self"]);u!=null&&c(t,["tunedModelInfo"],XP(u));const f=a(e,["defaultCheckpointId"]);f!=null&&c(t,["defaultCheckpointId"],f);const d=a(e,["checkpoints"]);if(d!=null){let h=d;Array.isArray(h)&&(h=h.map(p=>p)),c(t,["checkpoints"],h)}return t}function MP(e){const t={},n=a(e,["mediaResolution"]);n!=null&&c(t,["mediaResolution"],n);const r=a(e,["codeExecutionResult"]);r!=null&&c(t,["codeExecutionResult"],r);const i=a(e,["executableCode"]);i!=null&&c(t,["executableCode"],i);const o=a(e,["fileData"]);o!=null&&c(t,["fileData"],J4(o));const s=a(e,["functionCall"]);s!=null&&c(t,["functionCall"],Y4(s));const l=a(e,["functionResponse"]);l!=null&&c(t,["functionResponse"],l);const u=a(e,["inlineData"]);u!=null&&c(t,["inlineData"],x4(u));const f=a(e,["text"]);f!=null&&c(t,["text"],f);const d=a(e,["thought"]);d!=null&&c(t,["thought"],d);const h=a(e,["thoughtSignature"]);h!=null&&c(t,["thoughtSignature"],h);const p=a(e,["videoMetadata"]);return p!=null&&c(t,["videoMetadata"],p),t}function DP(e){const t={},n=a(e,["productImage"]);return n!=null&&c(t,["image"],Rn(n)),t}function LP(e,t){const n={},r=a(e,["numberOfImages"]);t!==void 0&&r!=null&&c(t,["parameters","sampleCount"],r);const i=a(e,["baseSteps"]);t!==void 0&&i!=null&&c(t,["parameters","baseSteps"],i);const o=a(e,["outputGcsUri"]);t!==void 0&&o!=null&&c(t,["parameters","storageUri"],o);const s=a(e,["seed"]);t!==void 0&&s!=null&&c(t,["parameters","seed"],s);const l=a(e,["safetyFilterLevel"]);t!==void 0&&l!=null&&c(t,["parameters","safetySetting"],l);const u=a(e,["personGeneration"]);t!==void 0&&u!=null&&c(t,["parameters","personGeneration"],u);const f=a(e,["addWatermark"]);t!==void 0&&f!=null&&c(t,["parameters","addWatermark"],f);const d=a(e,["outputMimeType"]);t!==void 0&&d!=null&&c(t,["parameters","outputOptions","mimeType"],d);const h=a(e,["outputCompressionQuality"]);t!==void 0&&h!=null&&c(t,["parameters","outputOptions","compressionQuality"],h);const p=a(e,["enhancePrompt"]);t!==void 0&&p!=null&&c(t,["parameters","enhancePrompt"],p);const m=a(e,["labels"]);return t!==void 0&&m!=null&&c(t,["labels"],m),n}function OP(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["_url","model"],Ce(e,r));const i=a(t,["source"]);i!=null&&BP(i,n);const o=a(t,["config"]);return o!=null&&LP(o,n),n}function UP(e){const t={},n=a(e,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Sa(i))),c(t,["generatedImages"],r)}return t}function BP(e,t){const n={},r=a(e,["prompt"]);t!==void 0&&r!=null&&c(t,["instances[0]","prompt"],r);const i=a(e,["personImage"]);t!==void 0&&i!=null&&c(t,["instances[0]","personImage","image"],Rn(i));const o=a(e,["productImages"]);if(t!==void 0&&o!=null){let s=o;Array.isArray(s)&&(s=s.map(l=>DP(l))),c(t,["instances[0]","productImages"],s)}return n}function VP(e){const t={},n=a(e,["referenceImage"]);n!=null&&c(t,["referenceImage"],Rn(n));const r=a(e,["referenceId"]);r!=null&&c(t,["referenceId"],r);const i=a(e,["referenceType"]);i!=null&&c(t,["referenceType"],i);const o=a(e,["maskImageConfig"]);o!=null&&c(t,["maskImageConfig"],kP(o));const s=a(e,["controlImageConfig"]);s!=null&&c(t,["controlImageConfig"],C4(s));const l=a(e,["styleImageConfig"]);l!=null&&c(t,["styleImageConfig"],l);const u=a(e,["subjectImageConfig"]);return u!=null&&c(t,["subjectImageConfig"],u),t}function Nv(e){const t={},n=a(e,["safetyAttributes","categories"]);n!=null&&c(t,["categories"],n);const r=a(e,["safetyAttributes","scores"]);r!=null&&c(t,["scores"],r);const i=a(e,["contentType"]);return i!=null&&c(t,["contentType"],i),t}function Pv(e){const t={},n=a(e,["safetyAttributes","categories"]);n!=null&&c(t,["categories"],n);const r=a(e,["safetyAttributes","scores"]);r!=null&&c(t,["scores"],r);const i=a(e,["contentType"]);return i!=null&&c(t,["contentType"],i),t}function GP(e){const t={},n=a(e,["category"]);if(n!=null&&c(t,["category"],n),a(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=a(e,["threshold"]);return r!=null&&c(t,["threshold"],r),t}function HP(e){const t={},n=a(e,["image"]);return n!=null&&c(t,["image"],Rn(n)),t}function WP(e,t){const n={},r=a(e,["mode"]);t!==void 0&&r!=null&&c(t,["parameters","mode"],r);const i=a(e,["maxPredictions"]);t!==void 0&&i!=null&&c(t,["parameters","maxPredictions"],i);const o=a(e,["confidenceThreshold"]);t!==void 0&&o!=null&&c(t,["parameters","confidenceThreshold"],o);const s=a(e,["maskDilation"]);t!==void 0&&s!=null&&c(t,["parameters","maskDilation"],s);const l=a(e,["binaryColorThreshold"]);t!==void 0&&l!=null&&c(t,["parameters","binaryColorThreshold"],l);const u=a(e,["labels"]);return t!==void 0&&u!=null&&c(t,["labels"],u),n}function zP(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["_url","model"],Ce(e,r));const i=a(t,["source"]);i!=null&&$P(i,n);const o=a(t,["config"]);return o!=null&&WP(o,n),n}function qP(e){const t={},n=a(e,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>mP(i))),c(t,["generatedMasks"],r)}return t}function $P(e,t){const n={},r=a(e,["prompt"]);t!==void 0&&r!=null&&c(t,["instances[0]","prompt"],r);const i=a(e,["image"]);t!==void 0&&i!=null&&c(t,["instances[0]","image"],Rn(i));const o=a(e,["scribbleImage"]);return t!==void 0&&o!=null&&c(t,["instances[0]","scribble"],HP(o)),n}function Fv(e){const t={},n=a(e,["languageCode"]);n!=null&&c(t,["languageCode"],n);const r=a(e,["voiceConfig"]);if(r!=null&&c(t,["voiceConfig"],r),a(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return t}function JP(e){const t={},n=a(e,["functionCallingConfig"]);n!=null&&c(t,["functionCallingConfig"],K4(n));const r=a(e,["retrievalConfig"]);return r!=null&&c(t,["retrievalConfig"],r),t}function YP(e){const t={},n=a(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>h)),c(t,["functionDeclarations"],d)}if(a(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=a(e,["googleSearchRetrieval"]);r!=null&&c(t,["googleSearchRetrieval"],r);const i=a(e,["computerUse"]);i!=null&&c(t,["computerUse"],i);const o=a(e,["fileSearch"]);o!=null&&c(t,["fileSearch"],o);const s=a(e,["codeExecution"]);if(s!=null&&c(t,["codeExecution"],s),a(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=a(e,["googleMaps"]);l!=null&&c(t,["googleMaps"],TP(l));const u=a(e,["googleSearch"]);u!=null&&c(t,["googleSearch"],EP(u));const f=a(e,["urlContext"]);return f!=null&&c(t,["urlContext"],f),t}function kv(e){const t={},n=a(e,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>X4(p))),c(t,["functionDeclarations"],h)}const r=a(e,["retrieval"]);r!=null&&c(t,["retrieval"],r);const i=a(e,["googleSearchRetrieval"]);i!=null&&c(t,["googleSearchRetrieval"],i);const o=a(e,["computerUse"]);if(o!=null&&c(t,["computerUse"],o),a(e,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const s=a(e,["codeExecution"]);s!=null&&c(t,["codeExecution"],s);const l=a(e,["enterpriseWebSearch"]);l!=null&&c(t,["enterpriseWebSearch"],l);const u=a(e,["googleMaps"]);u!=null&&c(t,["googleMaps"],u);const f=a(e,["googleSearch"]);f!=null&&c(t,["googleSearch"],f);const d=a(e,["urlContext"]);return d!=null&&c(t,["urlContext"],d),t}function KP(e){const t={},n=a(e,["baseModel"]);n!=null&&c(t,["baseModel"],n);const r=a(e,["createTime"]);r!=null&&c(t,["createTime"],r);const i=a(e,["updateTime"]);return i!=null&&c(t,["updateTime"],i),t}function XP(e){const t={},n=a(e,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&c(t,["baseModel"],n);const r=a(e,["createTime"]);r!=null&&c(t,["createTime"],r);const i=a(e,["updateTime"]);return i!=null&&c(t,["updateTime"],i),t}function bP(e,t){const n={},r=a(e,["displayName"]);t!==void 0&&r!=null&&c(t,["displayName"],r);const i=a(e,["description"]);t!==void 0&&i!=null&&c(t,["description"],i);const o=a(e,["defaultCheckpointId"]);return t!==void 0&&o!=null&&c(t,["defaultCheckpointId"],o),n}function QP(e,t){const n={},r=a(e,["displayName"]);t!==void 0&&r!=null&&c(t,["displayName"],r);const i=a(e,["description"]);t!==void 0&&i!=null&&c(t,["description"],i);const o=a(e,["defaultCheckpointId"]);return t!==void 0&&o!=null&&c(t,["defaultCheckpointId"],o),n}function ZP(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["_url","name"],Ce(e,r));const i=a(t,["config"]);return i!=null&&bP(i,n),n}function jP(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["_url","model"],Ce(e,r));const i=a(t,["config"]);return i!=null&&QP(i,n),n}function eF(e,t){const n={},r=a(e,["outputGcsUri"]);t!==void 0&&r!=null&&c(t,["parameters","storageUri"],r);const i=a(e,["safetyFilterLevel"]);t!==void 0&&i!=null&&c(t,["parameters","safetySetting"],i);const o=a(e,["personGeneration"]);t!==void 0&&o!=null&&c(t,["parameters","personGeneration"],o);const s=a(e,["includeRaiReason"]);t!==void 0&&s!=null&&c(t,["parameters","includeRaiReason"],s);const l=a(e,["outputMimeType"]);t!==void 0&&l!=null&&c(t,["parameters","outputOptions","mimeType"],l);const u=a(e,["outputCompressionQuality"]);t!==void 0&&u!=null&&c(t,["parameters","outputOptions","compressionQuality"],u);const f=a(e,["enhanceInputImage"]);t!==void 0&&f!=null&&c(t,["parameters","upscaleConfig","enhanceInputImage"],f);const d=a(e,["imagePreservationFactor"]);t!==void 0&&d!=null&&c(t,["parameters","upscaleConfig","imagePreservationFactor"],d);const h=a(e,["labels"]);t!==void 0&&h!=null&&c(t,["labels"],h);const p=a(e,["numberOfImages"]);t!==void 0&&p!=null&&c(t,["parameters","sampleCount"],p);const m=a(e,["mode"]);return t!==void 0&&m!=null&&c(t,["parameters","mode"],m),n}function tF(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["_url","model"],Ce(e,r));const i=a(t,["image"]);i!=null&&c(n,["instances[0]","image"],Rn(i));const o=a(t,["upscaleFactor"]);o!=null&&c(n,["parameters","upscaleConfig","upscaleFactor"],o);const s=a(t,["config"]);return s!=null&&eF(s,n),n}function nF(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Sa(o))),c(t,["generatedImages"],i)}return t}function rF(e){const t={},n=a(e,["uri"]);n!=null&&c(t,["uri"],n);const r=a(e,["encodedVideo"]);r!=null&&c(t,["videoBytes"],Mr(r));const i=a(e,["encoding"]);return i!=null&&c(t,["mimeType"],i),t}function iF(e){const t={},n=a(e,["gcsUri"]);n!=null&&c(t,["uri"],n);const r=a(e,["bytesBase64Encoded"]);r!=null&&c(t,["videoBytes"],Mr(r));const i=a(e,["mimeType"]);return i!=null&&c(t,["mimeType"],i),t}function oF(e){const t={},n=a(e,["image"]);n!=null&&c(t,["_self"],Rn(n));const r=a(e,["maskMode"]);return r!=null&&c(t,["maskMode"],r),t}function sF(e){const t={},n=a(e,["image"]);n!=null&&c(t,["image"],wa(n));const r=a(e,["referenceType"]);return r!=null&&c(t,["referenceType"],r),t}function lF(e){const t={},n=a(e,["image"]);n!=null&&c(t,["image"],Rn(n));const r=a(e,["referenceType"]);return r!=null&&c(t,["referenceType"],r),t}function Mv(e){const t={},n=a(e,["uri"]);n!=null&&c(t,["uri"],n);const r=a(e,["videoBytes"]);r!=null&&c(t,["encodedVideo"],Mr(r));const i=a(e,["mimeType"]);return i!=null&&c(t,["encoding"],i),t}function Dv(e){const t={},n=a(e,["uri"]);n!=null&&c(t,["gcsUri"],n);const r=a(e,["videoBytes"]);r!=null&&c(t,["bytesBase64Encoded"],Mr(r));const i=a(e,["mimeType"]);return i!=null&&c(t,["mimeType"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const aF="Content-Type",uF="X-Server-Timeout",fF="User-Agent",gf="x-goog-api-client",cF="1.30.0",dF=`google-genai-sdk/${cF}`,hF="v1beta1",pF="v1beta",cp=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class mF{constructor(t){var n,r;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:hF,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:pF,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&r.push(t.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),n=new URL(t);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),t!==""&&i.push(t),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,n,r);if(t.queryParams)for(const[s,l]of Object.entries(t.queryParams))i.searchParams.append(s,String(l));let o={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=t.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,n,i.toString(),t.abortSignal),this.unaryApiCall(i,o,t.httpMethod)}patchHttpOptions(t,n){const r=JSON.parse(JSON.stringify(t));for(const[i,o]of Object.entries(n))typeof o=="object"?r[i]=Object.assign(Object.assign({},r[i]),o):o!==void 0&&(r[i]=o);return r}async requestStream(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let o={};return o.body=t.body,o=await this.includeExtraHttpOptionsToRequestInit(o,n,i.toString(),t.abortSignal),this.streamApiCall(i,o,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,n,r,i){if(n&&n.timeout||i){const o=new AbortController,s=o.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const l=setTimeout(()=>o.abort(),n.timeout);l&&typeof l.unref=="function"&&l.unref()}i&&i.addEventListener("abort",()=>{o.abort()}),t.signal=s}return n&&n.extraBody!==null&&gF(t,n.extraBody),t.headers=await this.getHeadersInternal(n,r),t}async unaryApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await dp(i),new cf(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await dp(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(t){var n;return Vi(this,arguments,function*(){const i=(n=t==null?void 0:t.body)===null||n===void 0?void 0:n.getReader(),o=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let s="";for(;;){const{done:l,value:u}=yield Ve(i.read());if(l){if(s.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const f=o.decode(u,{stream:!0});try{const h=JSON.parse(f);if("error"in h){const p=JSON.parse(JSON.stringify(h.error)),m=p.status,v=p.code,g=`got status: ${m}. ${JSON.stringify(h)}`;if(v>=400&&v<600)throw new Ta({message:g,status:v})}}catch(h){if(h.name==="ApiError")throw h}s+=f;let d=s.match(cp);for(;d;){const h=d[1];try{const p=new Response(h,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield Ve(new cf(p)),s=s.slice(d[0].length),d=s.match(cp)}catch(p){throw new Error(`exception parsing stream chunk ${h}. ${p}`)}}}}finally{i.releaseLock()}})}async apiCall(t,n){return fetch(t,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const t={},n=dF+" "+this.clientOptions.userAgentExtra;return t[fF]=n,t[gf]=n,t[aF]="application/json",t}async getHeadersInternal(t,n){const r=new Headers;if(t&&t.headers){for(const[i,o]of Object.entries(t.headers))r.append(i,o);t.timeout&&t.timeout>0&&r.append(uF,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(r,n),r}getFileName(t){var n;let r="";return typeof t=="string"&&(r=t.replace(/[/\\]+$/,""),r=(n=r.split(/[/\\]/).pop())!==null&&n!==void 0?n:""),r}async uploadFile(t,n){var r;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const o=this.clientOptions.uploader,s=await o.stat(t);i.sizeBytes=String(s.size);const l=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:s.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=l;const u={file:i},f=this.getFileName(t),d=se("upload/v1beta/files",u._url),h=await this.fetchUploadUrl(d,i.sizeBytes,i.mimeType,f,u,n==null?void 0:n.httpOptions);return o.upload(t,h,this)}async uploadFileToFileSearchStore(t,n,r){var i;const o=this.clientOptions.uploader,s=await o.stat(n),l=String(s.size),u=(i=r==null?void 0:r.mimeType)!==null&&i!==void 0?i:s.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const f=`upload/v1beta/${t}:uploadToFileSearchStore`,d=this.getFileName(n),h={};r!=null&&r.customMetadata&&(h.customMetadata=r.customMetadata),r!=null&&r.chunkingConfig&&(h.chunkingConfig=r.chunkingConfig);const p=await this.fetchUploadUrl(f,l,u,d,h,r==null?void 0:r.httpOptions);return o.uploadToFileSearchStore(n,p,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,n,r,i,o,s){var l;let u={};s?u=s:u={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${n}`,"X-Goog-Upload-Header-Content-Type":`${r}`},i?{"X-Goog-Upload-File-Name":i}:{})};const f=await this.request({path:t,body:JSON.stringify(o),httpMethod:"POST",httpOptions:u});if(!f||!(f!=null&&f.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const d=(l=f==null?void 0:f.headers)===null||l===void 0?void 0:l["x-goog-upload-url"];if(d===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return d}}async function dp(e){var t;if(e===void 0)throw new Error("response is undefined");if(!e.ok){const n=e.status;let r;!((t=e.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?r=await e.json():r={error:{message:await e.text(),code:e.status,status:e.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new Ta({message:i,status:n}):new Error(i)}}function gF(e,t){if(!t||Object.keys(t).length===0)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof e.body=="string"&&e.body.length>0)try{const o=JSON.parse(e.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))n=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(o,s){const l=Object.assign({},o);for(const u in s)if(Object.prototype.hasOwnProperty.call(s,u)){const f=s[u],d=l[u];f&&typeof f=="object"&&!Array.isArray(f)&&d&&typeof d=="object"&&!Array.isArray(d)?l[u]=r(d,f):(d&&f&&typeof d!=typeof f&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${u}". Original type: ${typeof d}, New type: ${typeof f}. Overwriting.`),l[u]=f)}return l}const i=r(n,t);e.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const vF="mcp_used/unknown";let xF=!1;function Lv(e){for(const t of e)if(_F(t)||typeof t=="object"&&"inputSchema"in t)return!0;return xF}function Ov(e){var t;const n=(t=e[gf])!==null&&t!==void 0?t:"";e[gf]=(n+` ${vF}`).trimStart()}function _F(e){return e!==null&&typeof e=="object"&&e instanceof Gc}function yF(e,t=100){return Vi(this,arguments,function*(){let r,i=0;for(;i<t;){const o=yield Ve(e.listTools({cursor:r}));for(const s of o.tools)yield yield Ve(s),i++;if(!o.nextCursor)break;r=o.nextCursor}})}class Gc{constructor(t=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=n}static create(t,n){return new Gc(t,n)}async initialize(){var t,n,r,i;if(this.mcpTools.length>0)return;const o={},s=[];for(const d of this.mcpClients)try{for(var l=!0,u=(n=void 0,Vo(yF(d))),f;f=await u.next(),t=f.done,!t;l=!0){i=f.value,l=!1;const h=i;s.push(h);const p=h.name;if(o[p])throw new Error(`Duplicate function name ${p} found in MCP tools. Please ensure function names are unique.`);o[p]=d}}catch(h){n={error:h}}finally{try{!l&&!t&&(r=u.return)&&await r.call(u)}finally{if(n)throw n.error}}this.mcpTools=s,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),dR(this.mcpTools,this.config)}async callTool(t){await this.initialize();const n=[];for(const r of t)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const s=await i.callTool({name:r.name,arguments:r.args},void 0,o);n.push({functionResponse:{name:r.name,response:s.isError?{error:s}:s}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function TF(e,t,n){const r=new iR;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data),Object.assign(r,i),t(r)}class EF{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r}async connect(t){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),s=CF(this.apiClient.getDefaultHeaders()),l=this.apiClient.getApiKey(),u=`${i}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${l}`;let f=()=>{};const d=new Promise(y=>{f=y}),h=t.callbacks,p=function(){f({})},m=this.apiClient,v={onopen:p,onmessage:y=>{TF(m,h.onmessage,y)},onerror:(n=h==null?void 0:h.onerror)!==null&&n!==void 0?n:function(y){},onclose:(r=h==null?void 0:h.onclose)!==null&&r!==void 0?r:function(y){}},g=this.webSocketFactory.create(u,wF(s),v);g.connect(),await d;const x={setup:{model:Ce(this.apiClient,t.model)}};return g.send(JSON.stringify(x)),new SF(g,this.apiClient)}}class SF{constructor(t,n){this.conn=t,this.apiClient=n}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=u4(t);this.conn.send(JSON.stringify({clientContent:n}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const n=a4(t);this.conn.send(JSON.stringify(n))}sendPlaybackControl(t){const n={playbackControl:t};this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Ii.PLAY)}pause(){this.sendPlaybackControl(Ii.PAUSE)}stop(){this.sendPlaybackControl(Ii.STOP)}resetContext(){this.sendPlaybackControl(Ii.RESET_CONTEXT)}close(){this.conn.close()}}function wF(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function CF(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const AF="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function IF(e,t,n){const r=new rR;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const o=JSON.parse(i);if(e.isVertexAI()){const s=d4(o);Object.assign(r,s)}else Object.assign(r,o);t(r)}class RF{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r,this.music=new EF(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var n,r,i,o,s,l;if(t.config&&t.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const u=this.apiClient.getWebsocketBaseUrl(),f=this.apiClient.getApiVersion();let d;const h=this.apiClient.getHeaders();t.config&&t.config.tools&&Lv(t.config.tools)&&Ov(h);const p=kF(h);if(this.apiClient.isVertexAI())d=`${u}/ws/google.cloud.aiplatform.${f}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(p,d);else{const F=this.apiClient.getApiKey();let U="BidiGenerateContent",q="key";F!=null&&F.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),f!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),U="BidiGenerateContentConstrained",q="access_token"),d=`${u}/ws/google.ai.generativelanguage.${f}.GenerativeService.${U}?${q}=${F}`}let m=()=>{};const v=new Promise(F=>{m=F}),g=t.callbacks,T=function(){var F;(F=g==null?void 0:g.onopen)===null||F===void 0||F.call(g),m({})},_=this.apiClient,x={onopen:T,onmessage:F=>{IF(_,g.onmessage,F)},onerror:(n=g==null?void 0:g.onerror)!==null&&n!==void 0?n:function(F){},onclose:(r=g==null?void 0:g.onclose)!==null&&r!==void 0?r:function(F){}},y=this.webSocketFactory.create(d,FF(p),x);y.connect(),await v;let C=Ce(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&C.startsWith("publishers/")){const F=this.apiClient.getProject(),U=this.apiClient.getLocation();C=`projects/${F}/locations/${U}/`+C}let k={};this.apiClient.isVertexAI()&&((i=t.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[Yl.AUDIO]}:t.config.responseModalities=[Yl.AUDIO]),!((o=t.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const M=(l=(s=t.config)===null||s===void 0?void 0:s.tools)!==null&&l!==void 0?l:[],R=[];for(const F of M)if(this.isCallableTool(F)){const U=F;R.push(await U.tool())}else R.push(F);R.length>0&&(t.config.tools=R);const D={model:C,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?k=l4(this.apiClient,D):k=s4(this.apiClient,D),delete k.config,y.send(JSON.stringify(k)),new PF(y,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const NF={turnComplete:!0};class PF{constructor(t,n){this.conn=t,this.apiClient=n}tLiveClientContent(t,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=dn(n.turns),t.isVertexAI()||(r=r.map(i=>Ea(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(t,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const o of r){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!t.isVertexAI()&&!("id"in o))throw new Error(AF)}return{toolResponse:{functionResponses:r}}}sendClientContent(t){t=Object.assign(Object.assign({},NF),t);const n=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(n))}sendRealtimeInput(t){let n={};this.apiClient.isVertexAI()?n={realtimeInput:c4(t)}:n={realtimeInput:f4(t)},this.conn.send(JSON.stringify(n))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function FF(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function kF(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const hp=10;function pp(e){var t,n,r;if(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let i=!1;for(const s of(n=e==null?void 0:e.tools)!==null&&n!==void 0?n:[])if(Gi(s)){i=!0;break}if(!i)return!0;const o=(r=e==null?void 0:e.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function Gi(e){return"callTool"in e&&typeof e.callTool=="function"}function MF(e){var t,n,r;return(r=(n=(t=e.config)===null||t===void 0?void 0:t.tools)===null||n===void 0?void 0:n.some(i=>Gi(i)))!==null&&r!==void 0?r:!1}function mp(e){var t;const n=[];return!((t=e==null?void 0:e.config)===null||t===void 0)&&t.tools&&e.config.tools.forEach((r,i)=>{if(Gi(r))return;const o=r;o.functionDeclarations&&o.functionDeclarations.length>0&&n.push(i)}),n}function gp(e){var t;return!(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class DF extends ir{constructor(t){super(),this.apiClient=t,this.generateContent=async n=>{var r,i,o,s,l;const u=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!MF(n)||pp(n.config))return await this.generateContentInternal(u);const f=mp(n);if(f.length>0){const g=f.map(T=>`tools[${T}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${g}.`)}let d,h;const p=dn(u.contents),m=(o=(i=(r=u.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&o!==void 0?o:hp;let v=0;for(;v<m&&(d=await this.generateContentInternal(u),!(!d.functionCalls||d.functionCalls.length===0));){const g=d.candidates[0].content,T=[];for(const _ of(l=(s=n.config)===null||s===void 0?void 0:s.tools)!==null&&l!==void 0?l:[])if(Gi(_)){const y=await _.callTool(d.functionCalls);T.push(...y)}v++,h={role:"user",parts:T},u.contents=dn(u.contents),u.contents.push(g),u.contents.push(h),gp(u.config)&&(p.push(g),p.push(h))}return gp(u.config)&&(d.automaticFunctionCallingHistory=p),d},this.generateContentStream=async n=>{var r,i,o,s,l;if(this.maybeMoveToResponseJsonSchem(n),pp(n.config)){const h=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(h)}const u=mp(n);if(u.length>0){const h=u.map(p=>`tools[${p}]`).join(", ");throw new Error(`Incompatible tools found at ${h}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const f=(o=(i=(r=n==null?void 0:n.config)===null||r===void 0?void 0:r.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||o===void 0?void 0:o.streamFunctionCallArguments,d=(l=(s=n==null?void 0:n.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||l===void 0?void 0:l.disable;if(f&&!d)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let o;const s=[];if(r!=null&&r.generatedImages)for(const u of r.generatedImages)u&&(u!=null&&u.safetyAttributes)&&((i=u==null?void 0:u.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?o=u==null?void 0:u.safetyAttributes:s.push(u);let l;return o?l={generatedImages:s,positivePromptSafetyAttributes:o,sdkHttpResponse:r.sdkHttpResponse}:l={generatedImages:s,sdkHttpResponse:r.sdkHttpResponse},l}),this.list=async n=>{var r;const s={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!s.config.queryBase){if(!((r=s.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");s.config.filter="labels.tune-type:*"}return new li(tr.PAGED_ITEM_MODELS,l=>this.listInternal(l),await this.listInternal(s),s)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{var r,i,o,s,l,u;if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((r=n.video)===null||r===void 0)&&r.uri&&(!((i=n.video)===null||i===void 0)&&i.videoBytes)?n.video={uri:n.video.uri,mimeType:n.video.mimeType}:!((s=(o=n.source)===null||o===void 0?void 0:o.video)===null||s===void 0)&&s.uri&&(!((u=(l=n.source)===null||l===void 0?void 0:l.video)===null||u===void 0)&&u.videoBytes)&&(n.source.video={uri:n.source.video.uri,mimeType:n.source.video.mimeType})),await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(t){t.config&&t.config.responseSchema&&(t.config.responseJsonSchema||Object.keys(t.config.responseSchema).includes("$schema")&&(t.config.responseJsonSchema=t.config.responseSchema,delete t.config.responseSchema))}async processParamsMaybeAddMcpUsage(t){var n,r,i;const o=(n=t.config)===null||n===void 0?void 0:n.tools;if(!o)return t;const s=await Promise.all(o.map(async u=>Gi(u)?await u.tool():u)),l={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:s})};if(l.config.tools=s,t.config&&t.config.tools&&Lv(t.config.tools)){const u=(i=(r=t.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let f=Object.assign({},u);Object.keys(f).length===0&&(f=this.apiClient.getDefaultHeaders()),Ov(f),l.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:f})}return l}async initAfcToolsMap(t){var n,r,i;const o=new Map;for(const s of(r=(n=t.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(Gi(s)){const l=s,u=await l.tool();for(const f of(i=u.functionDeclarations)!==null&&i!==void 0?i:[]){if(!f.name)throw new Error("Function declaration name is required.");if(o.has(f.name))throw new Error(`Duplicate tool declaration name: ${f.name}`);o.set(f.name,l)}}return o}async processAfcStream(t){var n,r,i;const o=(i=(r=(n=t.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:hp;let s=!1,l=0;const u=await this.initAfcToolsMap(t);return function(f,d,h){var p,m;return Vi(this,arguments,function*(){for(var v,g,T,_;l<o;){s&&(l++,s=!1);const k=yield Ve(f.processParamsMaybeAddMcpUsage(h)),M=yield Ve(f.generateContentStreamInternal(k)),R=[],D=[];try{for(var x=!0,y=(g=void 0,Vo(M)),C;C=yield Ve(y.next()),v=C.done,!v;x=!0){_=C.value,x=!1;const F=_;if(yield yield Ve(F),F.candidates&&(!((p=F.candidates[0])===null||p===void 0)&&p.content)){D.push(F.candidates[0].content);for(const U of(m=F.candidates[0].content.parts)!==null&&m!==void 0?m:[])if(l<o&&U.functionCall){if(!U.functionCall.name)throw new Error("Function call name was not returned by the model.");if(d.has(U.functionCall.name)){const q=yield Ve(d.get(U.functionCall.name).callTool([U.functionCall]));R.push(...q)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${d.keys()}, mising tool: ${U.functionCall.name}`)}}}}catch(F){g={error:F}}finally{try{!x&&!v&&(T=y.return)&&(yield Ve(T.call(y)))}finally{if(g)throw g.error}}if(R.length>0){s=!0;const F=new xo;F.candidates=[{content:{role:"user",parts:R}}],yield yield Ve(F);const U=[];U.push(...D),U.push({role:"user",parts:R});const q=dn(h.contents).concat(U);h.contents=q}else break}})}(this,u,t)}async generateContentInternal(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=ap(this.apiClient,t);return l=se("{model}:generateContent",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=fp(d),p=new xo;return Object.assign(p,h),p})}else{const f=lp(this.apiClient,t);return l=se("{model}:generateContent",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=up(d),p=new xo;return Object.assign(p,h),p})}}async generateContentStreamInternal(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=ap(this.apiClient,t);return l=se("{model}:streamGenerateContent?alt=sse",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.requestStream({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}),s.then(function(h){return Vi(this,arguments,function*(){var p,m,v,g;try{for(var T=!0,_=Vo(h),x;x=yield Ve(_.next()),p=x.done,!p;T=!0){g=x.value,T=!1;const y=g,C=fp(yield Ve(y.json()));C.sdkHttpResponse={headers:y.headers};const k=new xo;Object.assign(k,C),yield yield Ve(k)}}catch(y){m={error:y}}finally{try{!T&&!p&&(v=_.return)&&(yield Ve(v.call(_)))}finally{if(m)throw m.error}}})})}else{const f=lp(this.apiClient,t);return l=se("{model}:streamGenerateContent?alt=sse",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.requestStream({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}),s.then(function(h){return Vi(this,arguments,function*(){var p,m,v,g;try{for(var T=!0,_=Vo(h),x;x=yield Ve(_.next()),p=x.done,!p;T=!0){g=x.value,T=!1;const y=g,C=up(yield Ve(y.json()));C.sdkHttpResponse={headers:y.headers};const k=new xo;Object.assign(k,C),yield yield Ve(k)}}catch(y){m={error:y}}finally{try{!T&&!p&&(v=_.return)&&(yield Ve(v.call(_)))}finally{if(m)throw m.error}}})})}}async embedContent(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=W4(this.apiClient,t);return l=se("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=q4(d),p=new $h;return Object.assign(p,h),p})}else{const f=H4(this.apiClient,t);return l=se("{model}:batchEmbedContents",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=z4(d),p=new $h;return Object.assign(p,h),p})}}async generateImagesInternal(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=tP(this.apiClient,t);return l=se("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=rP(d),p=new Jh;return Object.assign(p,h),p})}else{const f=eP(this.apiClient,t);return l=se("{model}:predict",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=nP(d),p=new Jh;return Object.assign(p,h),p})}}async editImageInternal(t){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const l=U4(this.apiClient,t);return o=se("{model}:predict",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),i.then(u=>{const f=B4(u),d=new JI;return Object.assign(d,f),d})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const l=tF(this.apiClient,t);return o=se("{model}:predict",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),i.then(u=>{const f=nF(u),d=new YI;return Object.assign(d,f),d})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(t){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const l=OP(this.apiClient,t);return o=se("{model}:predict",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const f=UP(u),d=new KI;return Object.assign(d,f),d})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(t){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const l=zP(this.apiClient,t);return o=se("{model}:predict",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const f=qP(u),d=new XI;return Object.assign(d,f),d})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=yP(this.apiClient,t);return l=se("{name}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),s.then(d=>mf(d))}else{const f=_P(this.apiClient,t);return l=se("{name}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),s.then(d=>pf(d))}}async listInternal(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=NP(this.apiClient,t);return l=se("{models_url}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=FP(d),p=new Yh;return Object.assign(p,h),p})}else{const f=RP(this.apiClient,t);return l=se("{models_url}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=PP(d),p=new Yh;return Object.assign(p,h),p})}}async update(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=jP(this.apiClient,t);return l=se("{model}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),s.then(d=>mf(d))}else{const f=ZP(this.apiClient,t);return l=se("{name}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),s.then(d=>pf(d))}}async delete(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=M4(this.apiClient,t);return l=se("{name}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=L4(d),p=new Kh;return Object.assign(p,h),p})}else{const f=k4(this.apiClient,t);return l=se("{name}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=D4(d),p=new Kh;return Object.assign(p,h),p})}}async countTokens(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=N4(this.apiClient,t);return l=se("{model}:countTokens",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=F4(d),p=new Xh;return Object.assign(p,h),p})}else{const f=R4(this.apiClient,t);return l=se("{model}:countTokens",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=P4(d),p=new Xh;return Object.assign(p,h),p})}}async computeTokens(t){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const l=T4(this.apiClient,t);return o=se("{model}:computeTokens",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),i.then(u=>{const f=E4(u),d=new bI;return Object.assign(d,f),d})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=uP(this.apiClient,t);return l=se("{model}:predictLongRunning",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),s.then(d=>{const h=lP(d),p=new Kl;return Object.assign(p,h),p})}else{const f=aP(this.apiClient,t);return l=se("{model}:predictLongRunning",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),s.then(d=>{const h=sP(d),p=new Kl;return Object.assign(p,h),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class LF extends ir{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const n=t.operation,r=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let o;r&&"httpOptions"in r&&(o=r.httpOptions);const s=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(t){const n=t.operation,r=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let o;r&&"httpOptions"in r&&(o=r.httpOptions);const s=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:s,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=GI(t);return l=se("{operationName}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),s}else{const f=VI(t);return l=se("{operationName}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),s}}async fetchPredictVideosOperationInternal(t){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const l=kI(t);return o=se("{resourceName}:fetchPredictOperation",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function OF(e){const t={},n=a(e,["data"]);if(n!=null&&c(t,["data"],n),a(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=a(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function UF(e){const t={},n=a(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>JF(o))),c(t,["parts"],i)}const r=a(e,["role"]);return r!=null&&c(t,["role"],r),t}function BF(e,t,n){const r={},i=a(t,["expireTime"]);n!==void 0&&i!=null&&c(n,["expireTime"],i);const o=a(t,["newSessionExpireTime"]);n!==void 0&&o!=null&&c(n,["newSessionExpireTime"],o);const s=a(t,["uses"]);n!==void 0&&s!=null&&c(n,["uses"],s);const l=a(t,["liveConnectConstraints"]);n!==void 0&&l!=null&&c(n,["bidiGenerateContentSetup"],$F(e,l));const u=a(t,["lockAdditionalFields"]);return n!==void 0&&u!=null&&c(n,["fieldMask"],u),r}function VF(e,t){const n={},r=a(t,["config"]);return r!=null&&c(n,["config"],BF(e,r,n)),n}function GF(e){const t={};if(a(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=a(e,["fileUri"]);n!=null&&c(t,["fileUri"],n);const r=a(e,["mimeType"]);return r!=null&&c(t,["mimeType"],r),t}function HF(e){const t={},n=a(e,["id"]);n!=null&&c(t,["id"],n);const r=a(e,["args"]);r!=null&&c(t,["args"],r);const i=a(e,["name"]);if(i!=null&&c(t,["name"],i),a(e,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(a(e,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function WF(e){const t={};if(a(e,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const n=a(e,["enableWidget"]);return n!=null&&c(t,["enableWidget"],n),t}function zF(e){const t={};if(a(e,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(a(e,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const n=a(e,["timeRangeFilter"]);return n!=null&&c(t,["timeRangeFilter"],n),t}function qF(e,t){const n={},r=a(e,["generationConfig"]);t!==void 0&&r!=null&&c(t,["setup","generationConfig"],r);const i=a(e,["responseModalities"]);t!==void 0&&i!=null&&c(t,["setup","generationConfig","responseModalities"],i);const o=a(e,["temperature"]);t!==void 0&&o!=null&&c(t,["setup","generationConfig","temperature"],o);const s=a(e,["topP"]);t!==void 0&&s!=null&&c(t,["setup","generationConfig","topP"],s);const l=a(e,["topK"]);t!==void 0&&l!=null&&c(t,["setup","generationConfig","topK"],l);const u=a(e,["maxOutputTokens"]);t!==void 0&&u!=null&&c(t,["setup","generationConfig","maxOutputTokens"],u);const f=a(e,["mediaResolution"]);t!==void 0&&f!=null&&c(t,["setup","generationConfig","mediaResolution"],f);const d=a(e,["seed"]);t!==void 0&&d!=null&&c(t,["setup","generationConfig","seed"],d);const h=a(e,["speechConfig"]);t!==void 0&&h!=null&&c(t,["setup","generationConfig","speechConfig"],Vc(h));const p=a(e,["thinkingConfig"]);t!==void 0&&p!=null&&c(t,["setup","generationConfig","thinkingConfig"],p);const m=a(e,["enableAffectiveDialog"]);t!==void 0&&m!=null&&c(t,["setup","generationConfig","enableAffectiveDialog"],m);const v=a(e,["systemInstruction"]);t!==void 0&&v!=null&&c(t,["setup","systemInstruction"],UF(At(v)));const g=a(e,["tools"]);if(t!==void 0&&g!=null){let M=ro(g);Array.isArray(M)&&(M=M.map(R=>KF(no(R)))),c(t,["setup","tools"],M)}const T=a(e,["sessionResumption"]);t!==void 0&&T!=null&&c(t,["setup","sessionResumption"],YF(T));const _=a(e,["inputAudioTranscription"]);t!==void 0&&_!=null&&c(t,["setup","inputAudioTranscription"],_);const x=a(e,["outputAudioTranscription"]);t!==void 0&&x!=null&&c(t,["setup","outputAudioTranscription"],x);const y=a(e,["realtimeInputConfig"]);t!==void 0&&y!=null&&c(t,["setup","realtimeInputConfig"],y);const C=a(e,["contextWindowCompression"]);t!==void 0&&C!=null&&c(t,["setup","contextWindowCompression"],C);const k=a(e,["proactivity"]);return t!==void 0&&k!=null&&c(t,["setup","proactivity"],k),n}function $F(e,t){const n={},r=a(t,["model"]);r!=null&&c(n,["setup","model"],Ce(e,r));const i=a(t,["config"]);return i!=null&&c(n,["config"],qF(i,n)),n}function JF(e){const t={},n=a(e,["mediaResolution"]);n!=null&&c(t,["mediaResolution"],n);const r=a(e,["codeExecutionResult"]);r!=null&&c(t,["codeExecutionResult"],r);const i=a(e,["executableCode"]);i!=null&&c(t,["executableCode"],i);const o=a(e,["fileData"]);o!=null&&c(t,["fileData"],GF(o));const s=a(e,["functionCall"]);s!=null&&c(t,["functionCall"],HF(s));const l=a(e,["functionResponse"]);l!=null&&c(t,["functionResponse"],l);const u=a(e,["inlineData"]);u!=null&&c(t,["inlineData"],OF(u));const f=a(e,["text"]);f!=null&&c(t,["text"],f);const d=a(e,["thought"]);d!=null&&c(t,["thought"],d);const h=a(e,["thoughtSignature"]);h!=null&&c(t,["thoughtSignature"],h);const p=a(e,["videoMetadata"]);return p!=null&&c(t,["videoMetadata"],p),t}function YF(e){const t={},n=a(e,["handle"]);if(n!=null&&c(t,["handle"],n),a(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function KF(e){const t={},n=a(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>h)),c(t,["functionDeclarations"],d)}if(a(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=a(e,["googleSearchRetrieval"]);r!=null&&c(t,["googleSearchRetrieval"],r);const i=a(e,["computerUse"]);i!=null&&c(t,["computerUse"],i);const o=a(e,["fileSearch"]);o!=null&&c(t,["fileSearch"],o);const s=a(e,["codeExecution"]);if(s!=null&&c(t,["codeExecution"],s),a(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=a(e,["googleMaps"]);l!=null&&c(t,["googleMaps"],WF(l));const u=a(e,["googleSearch"]);u!=null&&c(t,["googleSearch"],zF(u));const f=a(e,["urlContext"]);return f!=null&&c(t,["urlContext"],f),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function XF(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const r=e[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(o=>`${n}.${o}`);t.push(...i)}else t.push(n)}return t.join(",")}function bF(e,t){let n=null;const r=e.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const o=r.setup;typeof o=="object"&&o!==null?(e.bidiGenerateContentSetup=o,n=o):delete e.bidiGenerateContentSetup}else r!==void 0&&delete e.bidiGenerateContentSetup;const i=e.fieldMask;if(n){const o=XF(n);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)o?e.fieldMask=o:delete e.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const s=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let l=[];i.length>0&&(l=i.map(f=>s.includes(f)?`generationConfig.${f}`:f));const u=[];o&&u.push(o),l.length>0&&u.push(...l),u.length>0?e.fieldMask=u.join(","):delete e.fieldMask}else delete e.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?e.fieldMask=i.join(","):delete e.fieldMask;return e}class QF extends ir{constructor(t){super(),this.apiClient=t}async create(t){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const l=VF(this.apiClient,t);o=se("auth_tokens",l._url),s=l._query,delete l.config,delete l._url,delete l._query;const u=bF(l,t.config);return i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(f=>f.json()),i.then(f=>f)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ZF(e,t){const n={},r=a(e,["displayName"]);return t!==void 0&&r!=null&&c(t,["displayName"],r),n}function jF(e){const t={},n=a(e,["config"]);return n!=null&&ZF(n,t),t}function ek(e,t){const n={},r=a(e,["force"]);return t!==void 0&&r!=null&&c(t,["_query","force"],r),n}function tk(e){const t={},n=a(e,["name"]);n!=null&&c(t,["_url","name"],n);const r=a(e,["config"]);return r!=null&&ek(r,t),t}function nk(e){const t={},n=a(e,["name"]);return n!=null&&c(t,["_url","name"],n),t}function rk(e,t){const n={},r=a(e,["customMetadata"]);if(t!==void 0&&r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>s)),c(t,["customMetadata"],o)}const i=a(e,["chunkingConfig"]);return t!==void 0&&i!=null&&c(t,["chunkingConfig"],i),n}function ik(e){const t={},n=a(e,["name"]);n!=null&&c(t,["name"],n);const r=a(e,["metadata"]);r!=null&&c(t,["metadata"],r);const i=a(e,["done"]);i!=null&&c(t,["done"],i);const o=a(e,["error"]);o!=null&&c(t,["error"],o);const s=a(e,["response"]);return s!=null&&c(t,["response"],sk(s)),t}function ok(e){const t={},n=a(e,["fileSearchStoreName"]);n!=null&&c(t,["_url","file_search_store_name"],n);const r=a(e,["fileName"]);r!=null&&c(t,["fileName"],r);const i=a(e,["config"]);return i!=null&&rk(i,t),t}function sk(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["parent"]);r!=null&&c(t,["parent"],r);const i=a(e,["documentName"]);return i!=null&&c(t,["documentName"],i),t}function lk(e,t){const n={},r=a(e,["pageSize"]);t!==void 0&&r!=null&&c(t,["_query","pageSize"],r);const i=a(e,["pageToken"]);return t!==void 0&&i!=null&&c(t,["_query","pageToken"],i),n}function ak(e){const t={},n=a(e,["config"]);return n!=null&&lk(n,t),t}function uk(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=a(e,["fileSearchStores"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),c(t,["fileSearchStores"],o)}return t}function fk(e,t){const n={},r=a(e,["mimeType"]);t!==void 0&&r!=null&&c(t,["mimeType"],r);const i=a(e,["displayName"]);t!==void 0&&i!=null&&c(t,["displayName"],i);const o=a(e,["customMetadata"]);if(t!==void 0&&o!=null){let l=o;Array.isArray(l)&&(l=l.map(u=>u)),c(t,["customMetadata"],l)}const s=a(e,["chunkingConfig"]);return t!==void 0&&s!=null&&c(t,["chunkingConfig"],s),n}function ck(e){const t={},n=a(e,["fileSearchStoreName"]);n!=null&&c(t,["_url","file_search_store_name"],n);const r=a(e,["config"]);return r!=null&&fk(r,t),t}function dk(e){const t={},n=a(e,["sdkHttpResponse"]);return n!=null&&c(t,["sdkHttpResponse"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hk(e,t){const n={},r=a(e,["force"]);return t!==void 0&&r!=null&&c(t,["_query","force"],r),n}function pk(e){const t={},n=a(e,["name"]);n!=null&&c(t,["_url","name"],n);const r=a(e,["config"]);return r!=null&&hk(r,t),t}function mk(e){const t={},n=a(e,["name"]);return n!=null&&c(t,["_url","name"],n),t}function gk(e,t){const n={},r=a(e,["pageSize"]);t!==void 0&&r!=null&&c(t,["_query","pageSize"],r);const i=a(e,["pageToken"]);return t!==void 0&&i!=null&&c(t,["_query","pageToken"],i),n}function vk(e){const t={},n=a(e,["parent"]);n!=null&&c(t,["_url","parent"],n);const r=a(e,["config"]);return r!=null&&gk(r,t),t}function xk(e){const t={},n=a(e,["sdkHttpResponse"]);n!=null&&c(t,["sdkHttpResponse"],n);const r=a(e,["nextPageToken"]);r!=null&&c(t,["nextPageToken"],r);const i=a(e,["documents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>s)),c(t,["documents"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _k extends ir{constructor(t){super(),this.apiClient=t,this.list=async n=>new li(tr.PAGED_ITEM_DOCUMENTS,r=>this.listInternal({parent:n.parent,config:r.config}),await this.listInternal(n),n)}async get(t){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=mk(t);return o=se("{name}",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}async delete(t){var n,r;let i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const s=pk(t);i=se("{name}",s._url),o=s._query,delete s._url,delete s._query,await this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(t){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=vk(t);return o=se("{parent}/documents",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const f=xk(u),d=new QI;return Object.assign(d,f),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class yk extends ir{constructor(t,n=new _k(t)){super(),this.apiClient=t,this.documents=n,this.list=async(r={})=>new li(tr.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(r),r)}async uploadToFileSearchStore(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(t.fileSearchStoreName,t.file,t.config)}async create(t){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=jF(t);return o=se("fileSearchStores",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}async get(t){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=nk(t);return o=se("{name}",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>u)}}async delete(t){var n,r;let i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const s=tk(t);i=se("{name}",s._url),o=s._query,delete s._url,delete s._query,await this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(s),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(t){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=ak(t);return o=se("fileSearchStores",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const f=uk(u),d=new ZI;return Object.assign(d,f),d})}}async uploadToFileSearchStoreInternal(t){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=ck(t);return o=se("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const f=dk(u),d=new jI;return Object.assign(d,f),d})}}async importFile(t){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=ok(t);return o=se("{file_search_store_name}:importFile",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>{const f=ik(u),d=new Dc;return Object.assign(d,f),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Tk(e,t){const n={},r=a(e,["name"]);return r!=null&&c(n,["_url","name"],r),n}function Ek(e,t){const n={},r=a(e,["name"]);return r!=null&&c(n,["_url","name"],r),n}function Sk(e,t,n){const r={};if(a(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=a(e,["tunedModelDisplayName"]);if(t!==void 0&&i!=null&&c(t,["displayName"],i),a(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=a(e,["epochCount"]);t!==void 0&&o!=null&&c(t,["tuningTask","hyperparameters","epochCount"],o);const s=a(e,["learningRateMultiplier"]);if(s!=null&&c(r,["tuningTask","hyperparameters","learningRateMultiplier"],s),a(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(a(e,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(a(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=a(e,["batchSize"]);t!==void 0&&l!=null&&c(t,["tuningTask","hyperparameters","batchSize"],l);const u=a(e,["learningRate"]);if(t!==void 0&&u!=null&&c(t,["tuningTask","hyperparameters","learningRate"],u),a(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(a(e,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return r}function wk(e,t,n){const r={};let i=a(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const m=a(e,["validationDataset"]);t!==void 0&&m!=null&&c(t,["supervisedTuningSpec"],vp(m))}else if(i==="PREFERENCE_TUNING"){const m=a(e,["validationDataset"]);t!==void 0&&m!=null&&c(t,["preferenceOptimizationSpec"],vp(m))}const o=a(e,["tunedModelDisplayName"]);t!==void 0&&o!=null&&c(t,["tunedModelDisplayName"],o);const s=a(e,["description"]);t!==void 0&&s!=null&&c(t,["description"],s);let l=a(n,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const m=a(e,["epochCount"]);t!==void 0&&m!=null&&c(t,["supervisedTuningSpec","hyperParameters","epochCount"],m)}else if(l==="PREFERENCE_TUNING"){const m=a(e,["epochCount"]);t!==void 0&&m!=null&&c(t,["preferenceOptimizationSpec","hyperParameters","epochCount"],m)}let u=a(n,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const m=a(e,["learningRateMultiplier"]);t!==void 0&&m!=null&&c(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],m)}else if(u==="PREFERENCE_TUNING"){const m=a(e,["learningRateMultiplier"]);t!==void 0&&m!=null&&c(t,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],m)}let f=a(n,["config","method"]);if(f===void 0&&(f="SUPERVISED_FINE_TUNING"),f==="SUPERVISED_FINE_TUNING"){const m=a(e,["exportLastCheckpointOnly"]);t!==void 0&&m!=null&&c(t,["supervisedTuningSpec","exportLastCheckpointOnly"],m)}else if(f==="PREFERENCE_TUNING"){const m=a(e,["exportLastCheckpointOnly"]);t!==void 0&&m!=null&&c(t,["preferenceOptimizationSpec","exportLastCheckpointOnly"],m)}let d=a(n,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const m=a(e,["adapterSize"]);t!==void 0&&m!=null&&c(t,["supervisedTuningSpec","hyperParameters","adapterSize"],m)}else if(d==="PREFERENCE_TUNING"){const m=a(e,["adapterSize"]);t!==void 0&&m!=null&&c(t,["preferenceOptimizationSpec","hyperParameters","adapterSize"],m)}if(a(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(a(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const h=a(e,["labels"]);t!==void 0&&h!=null&&c(t,["labels"],h);const p=a(e,["beta"]);return t!==void 0&&p!=null&&c(t,["preferenceOptimizationSpec","hyperParameters","beta"],p),r}function Ck(e,t){const n={},r=a(e,["baseModel"]);r!=null&&c(n,["baseModel"],r);const i=a(e,["preTunedModel"]);i!=null&&c(n,["preTunedModel"],i);const o=a(e,["trainingDataset"]);o!=null&&Ok(o);const s=a(e,["config"]);return s!=null&&Sk(s,n),n}function Ak(e,t){const n={},r=a(e,["baseModel"]);r!=null&&c(n,["baseModel"],r);const i=a(e,["preTunedModel"]);i!=null&&c(n,["preTunedModel"],i);const o=a(e,["trainingDataset"]);o!=null&&Uk(o,n,t);const s=a(e,["config"]);return s!=null&&wk(s,n,t),n}function Ik(e,t){const n={},r=a(e,["name"]);return r!=null&&c(n,["_url","name"],r),n}function Rk(e,t){const n={},r=a(e,["name"]);return r!=null&&c(n,["_url","name"],r),n}function Nk(e,t,n){const r={},i=a(e,["pageSize"]);t!==void 0&&i!=null&&c(t,["_query","pageSize"],i);const o=a(e,["pageToken"]);t!==void 0&&o!=null&&c(t,["_query","pageToken"],o);const s=a(e,["filter"]);return t!==void 0&&s!=null&&c(t,["_query","filter"],s),r}function Pk(e,t,n){const r={},i=a(e,["pageSize"]);t!==void 0&&i!=null&&c(t,["_query","pageSize"],i);const o=a(e,["pageToken"]);t!==void 0&&o!=null&&c(t,["_query","pageToken"],o);const s=a(e,["filter"]);return t!==void 0&&s!=null&&c(t,["_query","filter"],s),r}function Fk(e,t){const n={},r=a(e,["config"]);return r!=null&&Nk(r,n),n}function kk(e,t){const n={},r=a(e,["config"]);return r!=null&&Pk(r,n),n}function Mk(e,t){const n={},r=a(e,["sdkHttpResponse"]);r!=null&&c(n,["sdkHttpResponse"],r);const i=a(e,["nextPageToken"]);i!=null&&c(n,["nextPageToken"],i);const o=a(e,["tunedModels"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(l=>Uv(l))),c(n,["tuningJobs"],s)}return n}function Dk(e,t){const n={},r=a(e,["sdkHttpResponse"]);r!=null&&c(n,["sdkHttpResponse"],r);const i=a(e,["nextPageToken"]);i!=null&&c(n,["nextPageToken"],i);const o=a(e,["tuningJobs"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(l=>vf(l))),c(n,["tuningJobs"],s)}return n}function Lk(e,t){const n={},r=a(e,["name"]);r!=null&&c(n,["model"],r);const i=a(e,["name"]);return i!=null&&c(n,["endpoint"],i),n}function Ok(e,t){const n={};if(a(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(a(e,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const r=a(e,["examples"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>o)),c(n,["examples","examples"],i)}return n}function Uk(e,t,n){const r={};let i=a(n,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const s=a(e,["gcsUri"]);t!==void 0&&s!=null&&c(t,["supervisedTuningSpec","trainingDatasetUri"],s)}else if(i==="PREFERENCE_TUNING"){const s=a(e,["gcsUri"]);t!==void 0&&s!=null&&c(t,["preferenceOptimizationSpec","trainingDatasetUri"],s)}let o=a(n,["config","method"]);if(o===void 0&&(o="SUPERVISED_FINE_TUNING"),o==="SUPERVISED_FINE_TUNING"){const s=a(e,["vertexDatasetResource"]);t!==void 0&&s!=null&&c(t,["supervisedTuningSpec","trainingDatasetUri"],s)}else if(o==="PREFERENCE_TUNING"){const s=a(e,["vertexDatasetResource"]);t!==void 0&&s!=null&&c(t,["preferenceOptimizationSpec","trainingDatasetUri"],s)}if(a(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function Uv(e,t){const n={},r=a(e,["sdkHttpResponse"]);r!=null&&c(n,["sdkHttpResponse"],r);const i=a(e,["name"]);i!=null&&c(n,["name"],i);const o=a(e,["state"]);o!=null&&c(n,["state"],xv(o));const s=a(e,["createTime"]);s!=null&&c(n,["createTime"],s);const l=a(e,["tuningTask","startTime"]);l!=null&&c(n,["startTime"],l);const u=a(e,["tuningTask","completeTime"]);u!=null&&c(n,["endTime"],u);const f=a(e,["updateTime"]);f!=null&&c(n,["updateTime"],f);const d=a(e,["description"]);d!=null&&c(n,["description"],d);const h=a(e,["baseModel"]);h!=null&&c(n,["baseModel"],h);const p=a(e,["_self"]);return p!=null&&c(n,["tunedModel"],Lk(p)),n}function vf(e,t){const n={},r=a(e,["sdkHttpResponse"]);r!=null&&c(n,["sdkHttpResponse"],r);const i=a(e,["name"]);i!=null&&c(n,["name"],i);const o=a(e,["state"]);o!=null&&c(n,["state"],xv(o));const s=a(e,["createTime"]);s!=null&&c(n,["createTime"],s);const l=a(e,["startTime"]);l!=null&&c(n,["startTime"],l);const u=a(e,["endTime"]);u!=null&&c(n,["endTime"],u);const f=a(e,["updateTime"]);f!=null&&c(n,["updateTime"],f);const d=a(e,["error"]);d!=null&&c(n,["error"],d);const h=a(e,["description"]);h!=null&&c(n,["description"],h);const p=a(e,["baseModel"]);p!=null&&c(n,["baseModel"],p);const m=a(e,["tunedModel"]);m!=null&&c(n,["tunedModel"],m);const v=a(e,["preTunedModel"]);v!=null&&c(n,["preTunedModel"],v);const g=a(e,["supervisedTuningSpec"]);g!=null&&c(n,["supervisedTuningSpec"],g);const T=a(e,["preferenceOptimizationSpec"]);T!=null&&c(n,["preferenceOptimizationSpec"],T);const _=a(e,["tuningDataStats"]);_!=null&&c(n,["tuningDataStats"],_);const x=a(e,["encryptionSpec"]);x!=null&&c(n,["encryptionSpec"],x);const y=a(e,["partnerModelTuningSpec"]);y!=null&&c(n,["partnerModelTuningSpec"],y);const C=a(e,["customBaseModel"]);C!=null&&c(n,["customBaseModel"],C);const k=a(e,["experiment"]);k!=null&&c(n,["experiment"],k);const M=a(e,["labels"]);M!=null&&c(n,["labels"],M);const R=a(e,["outputUri"]);R!=null&&c(n,["outputUri"],R);const D=a(e,["pipelineJob"]);D!=null&&c(n,["pipelineJob"],D);const F=a(e,["serviceAccount"]);F!=null&&c(n,["serviceAccount"],F);const U=a(e,["tunedModelDisplayName"]);U!=null&&c(n,["tunedModelDisplayName"],U);const q=a(e,["veoTuningSpec"]);return q!=null&&c(n,["veoTuningSpec"],q),n}function Bk(e,t){const n={},r=a(e,["sdkHttpResponse"]);r!=null&&c(n,["sdkHttpResponse"],r);const i=a(e,["name"]);i!=null&&c(n,["name"],i);const o=a(e,["metadata"]);o!=null&&c(n,["metadata"],o);const s=a(e,["done"]);s!=null&&c(n,["done"],s);const l=a(e,["error"]);return l!=null&&c(n,["error"],l),n}function vp(e,t){const n={},r=a(e,["gcsUri"]);r!=null&&c(n,["validationDatasetUri"],r);const i=a(e,["vertexDatasetResource"]);return i!=null&&c(n,["validationDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Vk extends ir{constructor(t){super(),this.apiClient=t,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new li(tr.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const o=Object.assign(Object.assign({},n),{preTunedModel:i});return o.baseModel=void 0,await this.tuneInternal(o)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),o=await this.tuneMldevInternal(i);let s="";return o.metadata!==void 0&&o.metadata.tunedModel!==void 0?s=o.metadata.tunedModel:o.name!==void 0&&o.name.includes("/operations/")&&(s=o.name.split("/operations/")[0]),{name:s,state:ff.JOB_STATE_QUEUED}}}}async getInternal(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=Rk(t);return l=se("{name}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>vf(d))}else{const f=Ik(t);return l=se("{name}",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>Uv(d))}}async listInternal(t){var n,r,i,o;let s,l="",u={};if(this.apiClient.isVertexAI()){const f=kk(t);return l=se("tuningJobs",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=Dk(d),p=new bh;return Object.assign(p,h),p})}else{const f=Fk(t);return l=se("tunedModels",f._url),u=f._query,delete f._url,delete f._query,s=this.apiClient.request({path:l,queryParams:u,body:JSON.stringify(f),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:d.headers},p})),s.then(d=>{const h=Mk(d),p=new bh;return Object.assign(p,h),p})}}async cancel(t){var n,r,i,o;let s="",l={};if(this.apiClient.isVertexAI()){const u=Ek(t);s=se("{name}:cancel",u._url),l=u._query,delete u._url,delete u._query,await this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}else{const u=Tk(t);s=se("{name}:cancel",u._url),l=u._query,delete u._url,delete u._query,await this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=t.config)===null||o===void 0?void 0:o.abortSignal})}}async tuneInternal(t){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const l=Ak(t,t);return o=se("tuningJobs",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),i.then(u=>vf(u))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=Ck(t);return o=se("tunedModels",l._url),s=l._query,delete l._url,delete l._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json().then(f=>{const d=f;return d.sdkHttpResponse={headers:u.headers},d})),i.then(u=>Bk(u))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Gk{async download(t,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Hk=1024*1024*8,Wk=3,zk=1e3,qk=2,bl="x-goog-upload-status";async function $k(e,t,n){var r;const i=await Bv(e,t,n),o=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[bl])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return o.file}async function Jk(e,t,n){var r;const i=await Bv(e,t,n),o=await(i==null?void 0:i.json());if(((r=i==null?void 0:i.headers)===null||r===void 0?void 0:r[bl])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const s=dv(o),l=new Lc;return Object.assign(l,s),l}async function Bv(e,t,n){var r,i;let o=0,s=0,l=new cf(new Response),u="upload";for(o=e.size;s<o;){const f=Math.min(Hk,o-s),d=e.slice(s,s+f);s+f>=o&&(u+=", finalize");let h=0,p=zk;for(;h<Wk&&(l=await n.request({path:"",body:d,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(s),"Content-Length":String(f)}}}),!(!((r=l==null?void 0:l.headers)===null||r===void 0)&&r[bl]));)h++,await Kk(p),p=p*qk;if(s+=f,((i=l==null?void 0:l.headers)===null||i===void 0?void 0:i[bl])!=="active")break;if(o<=s)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return l}async function Yk(e){return{size:e.size,type:e.type}}function Kk(e){return new Promise(t=>setTimeout(t,e))}class Xk{async upload(t,n,r){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await $k(t,n,r)}async uploadToFileSearchStore(t,n,r){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await Jk(t,n,r)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await Yk(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class bk{create(t,n,r){return new Qk(t,n,r)}}class Qk{constructor(t,n,r){this.url=t,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const xp="x-goog-api-key";class Zk{constructor(t){this.apiKey=t}async addAuthHeaders(t,n){if(t.get(xp)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(xp,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const jk="gl-node/";class e3{constructor(t){var n;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=t.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=t.apiKey;const r=PI(t.httpOptions,t.vertexai,void 0,void 0);r&&(t.httpOptions?t.httpOptions.baseUrl=r:t.httpOptions={baseUrl:r}),this.apiVersion=t.apiVersion;const i=new Zk(this.apiKey);this.apiClient=new mF({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:jk+"web",uploader:new Xk,downloader:new Gk}),this.models=new DF(this.apiClient),this.live=new RF(this.apiClient,i,new bk),this.batches=new oN(this.apiClient),this.chats=new GN(this.models,this.apiClient),this.caches=new UN(this.apiClient),this.files=new bN(this.apiClient),this.operations=new LF(this.apiClient),this.authTokens=new QF(this.apiClient),this.tunings=new Vk(this.apiClient),this.fileSearchStores=new yk(this.apiClient)}}const t3=new e3({apiKey:void 0}),n3=e=>new Promise((t,n)=>{const r=new FileReader;r.onloadend=()=>{const o=r.result.split(",")[1];t(o)},r.onerror=n,r.readAsDataURL(e)}),r3=async e=>{try{const t=await n3(e),n=await t3.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{inlineData:{mimeType:e.type,data:t}},{text:`Analiza esta factura. Extrae los siguientes datos con precisin.
            
            Si algn dato no es visible, intenta inferirlo o djalo vaco.
            
            Devuelve un JSON con la siguiente estructura:
            - date: Fecha de emisin de la factura (YYYY-MM-DD).
            - dueDate: Fecha de vencimiento de la factura (YYYY-MM-DD). Si no hay, usa la fecha de emisin.
            - vendor: Nombre de la empresa o proveedor.
            - invoiceNumber: Nmero de factura.
            - purchaseOrder: Nmero de Orden de Compra (OC / PO) si aparece.
            - totalAmount: El monto total numrico (sin smbolos).
            - currency: Cdigo de moneda ISO (USD, ARS, EUR, etc). Si es pesos argentinos, usa 'ARS'.
            - exchangeRate: Tipo de Cambio (T.C.) si aparece explcitamente en la factura.
            - description: Breve descripcin del tem o servicio.
            - isCreditNote: BOOLEAN. 'true' si el documento dice explcitamente "Nota de Crdito" o "Credit Note", de lo contrario 'false'.`}]},config:{responseMimeType:"application/json",responseSchema:{type:it.OBJECT,properties:{date:{type:it.STRING},dueDate:{type:it.STRING},vendor:{type:it.STRING},invoiceNumber:{type:it.STRING},purchaseOrder:{type:it.STRING},totalAmount:{type:it.NUMBER},currency:{type:it.STRING},exchangeRate:{type:it.NUMBER},description:{type:it.STRING},isCreditNote:{type:it.BOOLEAN}},required:["vendor","totalAmount","currency"]}}});if(n.text)return JSON.parse(n.text);throw new Error("No se pudo extraer informacin del modelo.")}catch(t){throw console.error("Error procesando factura con Gemini:",t),t}},i3=()=>{const[e,t]=mt.useState([]),[n,r]=mt.useState("UPLOAD"),[i,o]=mt.useState(!1),s=()=>{t([]),r("UPLOAD"),o(!1)},l=async v=>{o(!0);const g=new Date().toISOString().split("T")[0],T=v.map(x=>({fileName:x.name,status:Dt.PENDING,classification:"ALAU",receivedDate:g,exchangeRate:void 0,purchaseOrder:""})),_=e.length;t(x=>[...x,...T]);for(let x=0;x<v.length;x++){const y=v[x],C=_+x;t(k=>k.map((M,R)=>R===C?{...M,status:Dt.PROCESSING}:M));try{const k=await r3(y),M=k.isCreditNote?"NOTA DE CREDITO":"ALAU";t(R=>R.map((D,F)=>F===C?{...D,status:Dt.COMPLETED,...k,classification:M}:D))}catch{t(M=>M.map((R,D)=>D===C?{...R,status:Dt.ERROR,errorMessage:"Fallo al procesar"}:R))}}o(!1)},u=v=>{l(v)},f=()=>{r("PREVIEW")},d=()=>{r("DOWNLOAD")},h=(v,g)=>{t(T=>T.map((_,x)=>x===v?{..._,...g}:_))},p=()=>{const v=e.filter(x=>x.status===Dt.COMPLETED).map(x=>{const y=x.currency==="ARS";return{"Nombre del item":x.vendor||"Factura",Clasificacion:x.classification,"Fecha de FC":x.date||"","Fecha de vencimiento":x.dueDate||"",Recibido:x.receivedDate||"","N de factura":x.invoiceNumber||"",OC:x.purchaseOrder||"","TC FC":x.exchangeRate||"","Importe en ARS":y?x.totalAmount:0,"Importe en USD":y?0:x.totalAmount,PDF:x.fileName}});if(v.length===0){alert("No hay datos vlidos para exportar.");return}const g=fu.json_to_sheet(v),T=fu.book_new();fu.book_append_sheet(T,g,"Monday Import");const _=new Date().toISOString().split("T")[0];sI(T,`Reporte_Gastos_${_}.xlsx`),setTimeout(()=>{s()},1e3)},m=e.filter(v=>v.status===Dt.COMPLETED).length;return B.jsxs("div",{className:"min-h-screen bg-slate-900 pb-20 font-sans text-slate-100",children:[B.jsx("header",{className:"bg-slate-800 shadow-lg border-b border-slate-700 sticky top-0 z-10",children:B.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between",children:[B.jsxs("div",{className:"flex items-center gap-2",children:[B.jsx("div",{className:"bg-blue-600 p-2 rounded-lg shadow-blue-900/50 shadow-lg",children:B.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-5 h-5 text-white",children:B.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})})}),B.jsx("h1",{className:"text-xl font-bold tracking-tight text-white",children:"Factura a Monday"})]}),B.jsxs("div",{className:"text-sm text-slate-400 font-medium",children:[n==="UPLOAD"&&"Paso 1: Carga y Procesamiento",n==="PREVIEW"&&"Paso 2: Revisin de Excel",n==="DOWNLOAD"&&"Paso 3: Descarga"]})]})}),B.jsxs("main",{className:"max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 py-10",children:[n==="UPLOAD"&&B.jsxs("div",{className:"space-y-8 max-w-3xl mx-auto",children:[B.jsx(wI,{onFilesSelected:u}),e.length>0&&B.jsxs("div",{className:"bg-slate-800 rounded-xl shadow-lg border border-slate-700 overflow-hidden",children:[B.jsxs("div",{className:"px-6 py-4 border-b border-slate-700 flex justify-between items-center bg-slate-800/50",children:[B.jsx("h2",{className:"font-semibold text-slate-200",children:"Estado del Procesamiento"}),B.jsxs("span",{className:"text-sm text-slate-400",children:[m," / ",e.length," completados"]})]}),B.jsx(AI,{invoices:e}),B.jsx("div",{className:"p-6 bg-slate-800/50 border-t border-slate-700 flex justify-end",children:B.jsxs("button",{onClick:f,disabled:i||m===0,className:`
                      inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white transition-all
                      ${!i&&m>0?"bg-blue-600 hover:bg-blue-500 focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transform hover:-translate-y-0.5":"bg-slate-700 text-slate-500 cursor-not-allowed"}
                    `,children:[i?"Procesando...":"Continuar a Vista Previa",!i&&B.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"ml-2 w-4 h-4",children:B.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"})})]})})]})]}),n==="PREVIEW"&&B.jsxs("div",{className:"space-y-6",children:[B.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[B.jsxs("div",{children:[B.jsx("h2",{className:"text-2xl font-bold text-white",children:"Vista Previa del Excel"}),B.jsx("p",{className:"text-slate-400 mt-1",children:"Edita los campos directamente en la tabla antes de exportar."})]}),B.jsxs("button",{onClick:d,className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-all transform hover:-translate-y-0.5",children:[B.jsx(cv,{}),B.jsx("span",{className:"ml-2",children:"OK - Confirmar Excel"})]})]}),B.jsx(CI,{invoices:e,onUpdate:h,onRemove:v=>t(g=>g.filter((T,_)=>_!==v))}),B.jsx("div",{className:"flex justify-start",children:B.jsx("button",{onClick:()=>r("UPLOAD"),className:"text-slate-400 hover:text-slate-200 text-sm underline",children:" Volver a cargar ms archivos"})})]}),n==="DOWNLOAD"&&B.jsxs("div",{className:"flex flex-col items-center justify-center py-16 space-y-8 animate-in fade-in duration-500",children:[B.jsx("div",{className:"bg-green-900/20 p-6 rounded-full border border-green-900/50",children:B.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor",className:"w-16 h-16 text-green-500",children:B.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})})}),B.jsxs("div",{className:"text-center max-w-md",children:[B.jsx("h2",{className:"text-3xl font-bold text-white",children:"Todo listo!"}),B.jsxs("p",{className:"mt-4 text-slate-400 text-lg",children:["Tu archivo Excel ha sido generado con ",m," facturas. Al descargarlo, la aplicacin se reiniciar para una nueva carga."]})]}),B.jsxs("div",{className:"flex flex-col gap-4 w-full max-w-xs",children:[B.jsxs("button",{onClick:p,className:"w-full inline-flex items-center justify-center px-8 py-4 border border-transparent text-lg font-medium rounded-lg shadow-lg text-white bg-blue-600 hover:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all transform hover:scale-105",children:[B.jsx("svg",{className:"-ml-1 mr-3 h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",children:B.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})}),"Descargar Excel"]}),B.jsx("button",{onClick:s,className:"w-full text-center text-slate-500 hover:text-slate-300 text-sm font-medium",children:"Cancelar y volver al inicio"})]})]})]})]})},Vv=document.getElementById("root");if(!Vv)throw new Error("Could not find root element to mount to");const o3=cu.createRoot(Vv);o3.render(B.jsx(xx.StrictMode,{children:B.jsx(i3,{})}));
